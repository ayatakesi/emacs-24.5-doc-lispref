<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pure Storage</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Pure-Storage"/>Pure Storage</h1></div></div></div><a id="idm84316880" class="indexterm"/><p>Emacs Lispはユーザー作成Lispオブジェクトにたいして、<em class="firstterm">通常ストレージ(normal
storage)</em>と<em class="firstterm">純粋ストレージ(pure
storage)</em>という、2種のストレージをもちます。通常ストレージは、Emacsセッションが維持される間に、新たにデータが作成される場所です。純粋ストレージは、事前ロードされた標準Lispファイル内の、特定のデータのために使用されます。このデータは実際のEmacs使用中に決して変更されるべきではないデータです。
</p><p>純粋ストレージは、<span class="command"><strong>temacs</strong></span>が標準的な事前ローLispライブラリーのロード中だけ割り当てられます。ファイル<code class="filename">emacs</code>では、このメモリースペースは読み取り専用とマークされるので、そのマシン上で実行中のすべてのEmacsジョブで共有できます。純粋ストレージは拡張できません。Emacsのコンパイル時に固定された量が割り当てられ、それが事前ロードされるライブラリーにたいして不足なら、<code class="filename">temacs</code>はそれに収まらない部分を動的メモリーに割り当てます。結果イメージは動作するでしょうが、この状況ではメモリーリークとなるので、ガーベージコレクション(<a class="link" href="apes03.html" title="Garbage Collection">Garbage
Collection</a>を参照)は無効です。そのような通常なら発生しないオーバーフローは、あなたが事前ロードライブラリの追加や、標準的な事前ロードライブラリに追加を試みないかぎり発生しません。Emacsはオーバーロードの開始時に、オーバーロードに関する警告を表示するでしょう。これが発生したら、ファイル<code class="filename">src/puresize.h</code>内のコンパイルパラメーターを<code class="literal">SYSTEM_PURESIZE_EXTRA</code>を増やして、Emacsをリビルドする必要があります。
</p><pre class="synopsis"><a id="idm84298960" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">purecopy</code> <em class="replaceable"><code>object</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は純粋ストレージに<em class="replaceable"><code>object</code></em>のコピーを作成して、それをリターンする。これは同じ文字で新たに文字列を作成することにより文字列をコピーするが、純粋ストレージではテキストプロパティはない。これはベクターとコンスセルのコンテンツを、再帰的にコピーする。シンボルのような他のオブジェクトのコピーは作成しないが、それらを未変更でリターンする。マーカーのコピーを試みると、エラーをシグナルする。
</p><p>この関数は、Emacsのビルド中とダンプ中を除き、何もしない。通常は事前ロードされるLispファイル内でのみ呼び出される。
</p></blockquote></div><pre class="synopsis"><a id="idm84294992" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">pure-bytes-used</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、これまでに割り当てられた純粋ストレージのバイト数である。ダンプされたEmacsでは、通常は利用可能な純粋ストレージの総量とほとんど同じであり、もしそうでないならわたしたちは事前割り当てをもっと少なくするだろう。
</p></blockquote></div><pre class="synopsis"><a id="idm84292304" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">purify-flag</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、<code class="literal">defun</code>が純粋ストレージにその関数定義のコピーを作成するべきか否かを判断する。これが非<code class="literal">nil</code>なら、その関数の定義は純粋ストレージにコピーされる。
</p><p>このフラグは、Emacsのビルド用の基本的な関数の初回ロード中は<code class="literal">t</code>となる。実行可能形式としてEmacsをダンプすることにより、ダンプ前後の実際の値とは無関係に、常にこの変数に<code class="literal">nil</code>が書き込まれる。
</p><p>実行中のEmacsで、このフラグを変更しないこと。
</p></blockquote></div></div></body></html>