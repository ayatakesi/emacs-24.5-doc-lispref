<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Read Syntax for Circular Objects</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Circular-Objects"/>Read Syntax for Circular Objects</h1></div></div></div><a id="idm46915024" class="indexterm"/><a id="idm46914256" class="indexterm"/><a id="idm46913488" class="indexterm"/><a id="idm46911824" class="indexterm"/><p>複雑なLispオブジェクトにおける共有された構造、または循環する構造を表すために、リーダー構成‘<code class="literal">#<em class="replaceable"><code>n</code></em>=</code>’と‘<code class="literal">#<em class="replaceable"><code>n</code></em>#</code>’を使用することができます。
</p><p>後でオブジェクトを参照するには、オブジェクトの前で<code class="literal">#<em class="replaceable"><code>n</code></em>=</code>を使用します。その後で、他の場所にある同じオブジェクトを参照するために、<code class="literal">#<em class="replaceable"><code>n</code></em>#</code>を使用することができます。ここで<em class="replaceable"><code>n</code></em>は任意の整数です。たとえば以下は、1番目の要素が3番目の要素にも繰り替えされるリストを作成する方法です:
</p><pre class="screen">(#1=(a) b #1#)
</pre><p>これは、以下のような通常の構文とは異なります
</p><pre class="screen">((a) b (a))
</pre><p>これは1番目の要素と3番目の要素がそっくりなリストですが、これらは同じLispオブジェクトではありません。以下で違いを見ることができます:
</p><pre class="screen">(prog1 nil
  (setq x '(#1=(a) b #1#)))
(eq (nth 0 x) (nth 2 x))
     ⇒ t
(setq x '((a) b (a)))
(eq (nth 0 x) (nth 2 x))
     ⇒ nil
</pre><p>“要素”として自身を含むような、循環する構造を作成するために、同じ構文を使用できます。以下は例です:
</p><pre class="screen">#1=(a #1#)
</pre><p>これは、2番目の要素がそのリスト自身であるリストを作成します。これが実際にうまくいくのか、以下で確認できます:
</p><pre class="screen">(prog1 nil
  (setq x '#1=(a #1#)))
(eq x (cadr x))
     ⇒ t
</pre><p>変数<code class="literal">print-circle</code>を非<code class="literal">nil</code>値にバインドした場合、Lispプリンターは、循環および共有されるLispオブジェクトを記録するこの構文を、生成することができます。<a class="link" href="ch19s06.html" title="Variables Affecting Output">Output
Variables</a>を参照してください。
</p></div></body></html>