<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Managing a Fixed-Size Ring of Objects</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Rings"/>Managing a Fixed-Size Ring of Objects</h1></div></div></div><a id="idm48594000" class="indexterm"/><p><em class="firstterm">リング(ring)</em>は、挿入、削除、ローテーション、剰余(modulo)でインデックスづけされた参照と走査(traversal)をサポートする、固定長のデータ構造です。<code class="literal">ring</code>パッケージにより、効率的なリングデータ構造が実装されています。このパッケージは、このセクションにリストされた関数を提供します。
</p><p>killリングやマークリングのような、Emacsにあるいくつかの“リング”は、実際には単なるリストとして実装されていることに注意してください。したがって、これらのリングにたいしては、以下の関数は機能しないでしょう。
</p><pre class="synopsis"><a id="idm48591440" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">make-ring</code> <em class="replaceable"><code>size</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>size</code></em>オブジェクトを保持できる、新しいリングをreturnします。<em class="replaceable"><code>size</code></em>は整数です。
</p></blockquote></div><pre class="synopsis"><a id="idm48587472" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-p</code> <em class="replaceable"><code>object</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>object</code></em>がリングの場合は<code class="literal">t</code>、それ以外は<code class="literal">nil</code>をreturnします。
</p></blockquote></div><pre class="synopsis"><a id="idm48582864" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-size</code> <em class="replaceable"><code>ring</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>ring</code></em>の最大の要素数をreturnします。
</p></blockquote></div><pre class="synopsis"><a id="idm48579280" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-length</code> <em class="replaceable"><code>ring</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>ring</code></em>に現在含まれている、オブジェクトの数をreturnします。値は、<code class="literal">ring-size</code>でreturnされる値を超えることはありません。
</p></blockquote></div><pre class="synopsis"><a id="idm48575184" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-elements</code> <em class="replaceable"><code>ring</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>ring</code></em>内のオブジェクトのリストをreturnします。リストの順序は、新しいオブジェクトが先頭になります。
</p></blockquote></div><pre class="synopsis"><a id="idm48571600" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-copy</code> <em class="replaceable"><code>ring</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>個の関数は、<em class="replaceable"><code>ring</code></em>のコピーを新しいリングとしてreturnします。新しいリングは、<em class="replaceable"><code>ring</code></em>と同じ(<code class="literal">eq</code>な)オブジェクトを含みます。
</p></blockquote></div><pre class="synopsis"><a id="idm48567120" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-empty-p</code> <em class="replaceable"><code>ring</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>ring</code></em>が空の場合は<code class="literal">t</code>、それ以外は<code class="literal">nil</code>をreturnします。
</p></blockquote></div><p>リング内の1番新しい要素は、常にインデックス0をもちます。より大きいインデックスは、より古い要素に対応します。インデックスは、リング長のmoduloにより計算されます。インデックス−1は1番古い要素、−2は次に古い要素、...となります。
</p><pre class="synopsis"><a id="idm48562128" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-ref</code> <em class="replaceable"><code>ring</code></em> <em class="replaceable"><code>index</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数はインデックス<em class="replaceable"><code>index</code></em>にある<em class="replaceable"><code>ring</code></em>内のオブジェクトをreturnします。<em class="replaceable"><code>index</code></em>には負、またはリング長より大きい数を指定できます。<em class="replaceable"><code>ring</code></em>がからの場合、<code class="literal">ring-ref</code>はエラーをシグナルします。
</p></blockquote></div><pre class="synopsis"><a id="idm48556496" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-insert</code> <em class="replaceable"><code>ring</code></em> <em class="replaceable"><code>object</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、1番新しい要素として<em class="replaceable"><code>object</code></em>を<em class="replaceable"><code>ring</code></em>に挿入し、<em class="replaceable"><code>object</code></em>をreturnします。
</p><p>リングが一杯の場合、新しい要素のための空きを作るため、挿入により1番古い要素が削除されます。
</p></blockquote></div><pre class="synopsis"><a id="idm48551376" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-remove</code> <em class="replaceable"><code>ring</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>index</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p><em class="replaceable"><code>ring</code></em>からオブジェクトを削除して、そのオブジェクトをreturnします。引数<em class="replaceable"><code>index</code></em>は、どのアイテムを削除するかを指定します。これが<code class="literal">nil</code>の場合、それは1番古いアイテムを削除することを意味します。<em class="replaceable"><code>ring</code></em>が空の場合、<code class="literal">ring-remove</code>はエラーをシグナルします。
</p></blockquote></div><pre class="synopsis"><a id="idm48545360" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">ring-insert-at-beginning</code> <em class="replaceable"><code>ring</code></em> <em class="replaceable"><code>object</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、1番古い要素として、<em class="replaceable"><code>object</code></em>を<em class="replaceable"><code>ring</code></em>に挿入します。return値は、意味をもちません。
</p><p>リングが一杯の場合、この関数は挿入される要素のための空きを作るために、1番新しい要素を削除します。
</p></blockquote></div><a id="idm48540880" class="indexterm"/><p>リングサイズを超えることを気にしない場合、そのリングをFIFO(first-in-first-out:
先入れ先出し)のキューとして使用することができます。たとえば:
</p><pre class="programlisting">(let ((fifo (make-ring 5)))
  (mapc (lambda (obj) (ring-insert fifo obj))
        '(0 one "two"))
  (list (ring-remove fifo) t
        (ring-remove fifo) t
        (ring-remove fifo)))
     ⇒ (0 t one t "two")
</pre></div></body></html>