<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Iteration</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Iteration"/>Iteration</h1></div></div></div><a id="idm51511376" class="indexterm"/><a id="idm51510608" class="indexterm"/><p>繰り返し(iteration)とは、プログラムの一部を繰り返し実行することを意味します。たとえば、リストの各要素、または0から<em class="replaceable"><code>n</code></em>の整数にたいして、1度ずつ繰り返し何らかの計算をおこないたいとしましょうEmacs
Lispでは、スペシャルフォーム<code class="literal">while</code>でこれを行なうことができます:
</p><pre class="synopsis"><a id="idm51508304" class="indexterm"/><span class="category"><span class="bold"><strong>Special Form</strong></span>:</span> <code class="function">while</code> <em class="replaceable"><code>condition</code></em> <em class="replaceable"><code>forms</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p><code class="literal">while</code>は、最初に<em class="replaceable"><code>condition</code></em>を評価します。結果が非<code class="literal">nil</code>の場合は、<em class="replaceable"><code>forms</code></em>をテキスト順に評価します。その後<em class="replaceable"><code>condition</code></em>を再評価して、結果が非<code class="literal">nil</code>の場合、再度<em class="replaceable"><code>forms</code></em>を評価します。この処理は、<em class="replaceable"><code>condition</code></em>が<code class="literal">nil</code>に評価されるまで繰り返されます。
</p><p>繰り返し回数に制限はありません。このループは、<em class="replaceable"><code>condition</code></em>が<code class="literal">nil</code>に評価されるか、エラーとなるか、<code class="literal">throw</code>で抜け出す(<a class="link" href="ch11s05.html" title="Nonlocal Exits">Nonlocal
Exits</a>を参照してください)まで計測されるでしょう
</p><p><code class="literal">while</code>フォームの値は、常に<code class="literal">nil</code>です。
</p><pre class="screen">(setq num 0)
     ⇒ 0
</pre><pre class="screen">(while (&lt; num 4)
  (princ (format "Iteration %d." num))
  (setq num (1+ num)))
     ⊣ Iteration 0.
     ⊣ Iteration 1.
     ⊣ Iteration 2.
     ⊣ Iteration 3.
     ⇒ nil
</pre><p>各繰り返しごとに何かを実行して、その後も終了テストを行なう“repeat...until”ループを記述するには、以下のように<code class="literal">while</code>の1番目の引数として、bodyの後に終了テストを記述して、それを<code class="literal">progn</code>の中に配します:
</p><pre class="screen">(while (progn
         (forward-line 1)
         (not (looking-at "^$"))))
</pre><p>これは1行前方に移動して、空行に達するまで行単位の移動を継続します。独特なのは、<code class="literal">while</code>がbodyをもたず、終了テスト(これはポイント移動の実処理も行ないます)だけという点です。
</p></blockquote></div><p>マクロ<code class="literal">dolist</code>および<code class="literal">dotimes</code>は、2つの一般的な種類のループを記述する、便利な方法を提供します。
</p><pre class="synopsis"><a id="idm51491664" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">dolist</code> (<em class="replaceable"><code>var</code></em> <em class="replaceable"><code>list</code></em> [<em class="replaceable"><code>result</code></em>]) <em class="replaceable"><code>body</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この構成は、<em class="replaceable"><code>list</code></em>の各要素にたいして1度<em class="replaceable"><code>body</code></em>を実行し、カレント要素をローカルに保持するように、変数<em class="replaceable"><code>var</code></em>にバインドします。その後、<em class="replaceable"><code>result</code></em>を評価した値、または<em class="replaceable"><code>result</code></em>が省略された場合は<code class="literal">nil</code>をreturnします。たとえば、以下は<code class="literal">reverse</code>関数を定義するために、<code class="literal">dolist</code>を使用する方法の例です:
</p><pre class="screen">(defun reverse (list)
  (let (value)
    (dolist (elt list value)
      (setq value (cons elt value)))))
</pre></blockquote></div><pre class="synopsis"><a id="idm51483088" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">dotimes</code> (<em class="replaceable"><code>var</code></em> <em class="replaceable"><code>count</code></em> [<em class="replaceable"><code>result</code></em>]) <em class="replaceable"><code>body</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この構成は、0以上<em class="replaceable"><code>count</code></em>未満の各整数にたいして1度<em class="replaceable"><code>body</code></em>を実行し、その繰り返しでの整数を、変数<em class="replaceable"><code>var</code></em>にバインドします。その後、<em class="replaceable"><code>result</code></em>の値、または<em class="replaceable"><code>result</code></em>が省略された場合は<code class="literal">nil</code>をreturnします。以下は、<code class="literal">dotimes</code>を使用して、何らかの処理を100回行なう例です:
</p><pre class="screen">(dotimes (i 100)
  (insert "I will not obey absurd orders\n"))
</pre></blockquote></div></div></body></html>