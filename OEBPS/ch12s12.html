<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Directory Local Variables</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Directory-Local-Variables"/>Directory Local Variables</h1></div></div></div><a id="idm54457936" class="indexterm"/><p>ディレクトリーは、そのディレクトリー内のすべてのファイルに共通なローカル変数値を指定することができます。Emacsは、そのディレクトリー内の任意のファイルをvisitしているバッファー内で、それらの変数にたいするバッファーローカルなバインディングを作成するために、これを使用します。これは、そのディレクトリー内のファイルが何らかの<em class="firstterm">プロジェクト</em>に属していて、同じローカル変数を共有するときなどに有用です。
</p><p>ディレクトリーローカル変数を指定するために、2つの異なる方法があります:
1つは特別なファイルにそれを記述する方法、もう1つはそのディレクトリーに<em class="firstterm">プロジェクトクラス(project class)</em>を定義する方法です。
</p><pre class="synopsis"><a id="idm54455376" class="indexterm"/><span class="category"><span class="bold"><strong>Constant</strong></span>:</span> <code class="varname">dir-locals-file</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この定数は、Emacsがディレクトリーローカル変数が見つけることができる期待する、ファイルの名前です。ファイル名は、<code class="filename">.dir-locals.el</code><a href="#ftn.idm54452688" class="footnote" id="idm54452688"><sup class="footnote">[8]</sup></a>です。ディレクトリー内でその名前をもつファイルにより、Emacsはディレクトリー内の任意のファイル、または任意のサブディレクトリー(オプションでサブディレクトリーを除外できます。以下を参照してください)にセッティングを適用します。独自に<code class="filename">.dir-locals.el</code>をもつサブディレクトリーがある場合、Emacsはサブディレクトリーで見つかった1番深いファイルのディレクトリーからディレクトリーツリーを上方に移動しながら、1番深いファイルのセッティングを使用します。このファイルは、ローカル変数をフォーマットされたリストとして指定します。詳細は、section “Per-directory Local Variables” in <em class="citetitle">The GNU Emacs
Manual</em>を参照してください。
</p></blockquote></div><pre class="synopsis"><a id="idm54450384" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">hack-dir-local-variables</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<code class="literal">.dir-locals.el</code>ファイルを読み込み、そのディレクトリー内の任意のファイルをvisitしているバッファーにたいしてローカルな<code class="literal">file-local-variables-alist</code>内に、それらを適用することなくディレクトリーローカル変数を格納します。この関数はディレクトリーローカルなセッティングも<code class="literal">dir-locals-class-alist</code>(<code class="filename">.dir-locals.el</code>ファイルが見つかったディレクトリーにたいする特別なクラスを定義する)内に格納します。この関数は、以下で説明するように、<code class="literal">dir-locals-set-class-variables</code>および<code class="literal">dir-locals-set-directory-class</code>を呼び出すことにより機能します。
</p></blockquote></div><pre class="synopsis"><a id="idm54432208" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">hack-dir-local-variables-non-file-buffer</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数はディレクトリーローカル変数を探して、即座にそれらをカレントバッファーに適用します。これはDiredバッファーのような、非ファイルバッファーをディレクトリーローカル変数のセッティングにしたがわせるために、モードコマンド呼び出しの中から呼び出されることを意図したものです。非ファイルバッファーにたいしては、Emacsは<code class="literal">default-directory</code>と、その親ディレクトリーの中から、ディレクトリーローカル変数を探します。
</p></blockquote></div><pre class="synopsis"><a id="idm54428880" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">dir-locals-set-class-variables</code> <em class="replaceable"><code>class</code></em> <em class="replaceable"><code>variables</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>class</code></em>という名前がつけられたシンボルにたいして、一連の変数セッティングを定義します。その後このクラスを1つ以上のディレクトリーに割り当てることができ、するとEmacsはこれらの変数セッティングを、それらのディレクトリー内のすべてのファイルに適用します。<em class="replaceable"><code>variables</code></em>内のリストは、2つの形式
— <code class="literal">(<em class="replaceable"><code>major-mode</code></em> . <em class="replaceable"><code>alist</code></em>)</code>または<code class="literal">(<em class="replaceable"><code>directory</code></em>
. <em class="replaceable"><code>list</code></em>)</code> —
のうち1つをもつことができます。1番目の形式では、そのファイルのバッファーが<em class="replaceable"><code>major-mode</code></em>を継承するモードに切り替わるときに、連想リスト<em class="replaceable"><code>alist</code></em>内のすべての変数が適用されます。<em class="replaceable"><code>alist</code></em>は、<code class="literal">(<em class="replaceable"><code>name</code></em>
.
<em class="replaceable"><code>value</code></em>)</code>という形式です。<em class="replaceable"><code>major-mode</code></em>にたいする特別な値<code class="literal">nil</code>は、そのセッティングが任意のモードに適用できることを意味します。<em class="replaceable"><code>alist</code></em>内では、特別な<em class="replaceable"><code>name</code></em>として、<code class="literal">subdirs</code>を使用することができます。連想値が<code class="literal">nil</code>の場合、alistは関連するディレクトリー内のファイルだけに適用され、それらのサブディレクトリーには適用されません。
</p><p><em class="replaceable"><code>variables</code></em>の2番目の形式では、<em class="replaceable"><code>directory</code></em>がそのファイルのディレクトリーの最初のサブディレクトリーの場合、上記のルールにしたがって、<em class="replaceable"><code>list</code></em>が再帰的に適用されます。<em class="replaceable"><code>list</code></em>は、この関数の<em class="replaceable"><code>variables</code></em>で指定できる2つの形式のうち、1つを指定します。
</p></blockquote></div><pre class="synopsis"><a id="idm54414672" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">dir-locals-set-directory-class</code> <em class="replaceable"><code>directory</code></em> <em class="replaceable"><code>class</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>mtime</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<code class="literal">directory</code>およびサブディレクトリー内のすべてのファイルに<em class="replaceable"><code>class</code></em>を割り当てます。その後、<em class="replaceable"><code>class</code></em>にたいして指定されたすべての変数セッティングは、<em class="replaceable"><code>directory</code></em>およびその子ディレクトリー内でvisitされた任意のファイルに適用されます。<em class="replaceable"><code>class</code></em>は事前に<code class="literal">dir-locals-set-class-variables</code>で定義されていなければなりません。
</p><p>Emacsは、<code class="literal">.dir-locals.el</code>ファイルからディレクトリー変数をロードするとき、内部的にこの関数を使用します。その場合、オプションの引数<em class="replaceable"><code>mtime</code></em>は、ファイルの修正日時(modification
time。<code class="literal">file-attributes</code>によりreturnされる)を保持します。Emacsは、記憶されたローカル変数がまだ有効化チェックするために、この日時を使用します。ファイルを通じ手ではなく直接クラスを割り当てる場合、この引数は<code class="literal">nil</code>になります。
</p></blockquote></div><pre class="synopsis"><a id="idm54405456" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">dir-locals-class-alist</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このalistはクラスシンボル(class symbol)と連想変数セッティング(associated variable
settings)を保持します。これは<code class="literal">dir-locals-set-class-variables</code>により更新されます。
</p></blockquote></div><pre class="synopsis"><a id="idm54402256" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">dir-locals-directory-cache</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このalistはディレクトリー名、それらに割り当てられたクラス名、およびこのエントリーに関連するディレクトリーローカル変数ファイルの修正日時を保持します。関数<code class="literal">dir-locals-set-directory-class</code>は、このlistを更新します。
</p></blockquote></div><pre class="synopsis"><a id="idm54386768" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">enable-dir-local-variables</code></pre><div class="blockquote"><blockquote class="blockquote"><p><code class="literal">nil</code>の場合、ディレクトリーローカル変数は無視されます。この変数は、ファイルローカル変数(<a class="link" href="ch12s11.html" title="File Local Variables">File Local
Variables</a>を参照してください)にしたがい、ディレクトリーローカル変数は無視したいモードにたいして有用かもしれません。
</p></blockquote></div><div class="footnotes"><br/><hr/><div id="ftn.idm54452688" class="footnote"><p><a href="#idm54452688" class="para"><sup class="para">[8] </sup></a>MS-DOS版のEmacsは、DOSファイルシステムの制限により、かわりに<code class="filename">_dir-locals.el</code>という名前を使用します。</p></div></div></div></body></html>