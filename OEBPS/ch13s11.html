<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Declaring Functions Obsolete</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Obsolete-Functions"/>Declaring Functions Obsolete</h1></div></div></div><a id="idm53514192" class="indexterm"/><p>名前つき関数を<em class="firstterm">陳腐化している(obsolete)</em>とマークすることができます。これは、その関数が将来のある時点で削除されるかもしれないことを意味します。陳腐化しているとマークされた関数を含むコードをバイトコンパイルしたとき、Ｅｍａｃｓは警告を発します。また、その関数のヘルプドキュメントは表示されなくなります。他の点においては、陳腐化した関数は他の任意の関数と同様に振る舞います。
</p><p>関数を陳腐化しているとマークするもっとも簡単な方法は、その関数の<code class="literal">defun</code>定義に<code class="literal">(declare (obsolete
…))</code>を配置することです。<a class="link" href="ch13s13.html" title="The declare Form">Declare
Form</a>を参照してください。かわりに、以下で説明している<code class="literal">make-obsolete</code>関数を使うこともできます。
</p><p><code class="literal">make-obsolete</code>を使用して、マクロ(<a class="link" href="ch14.html" title="Chapter 13. Macros">Macros</a>を参照してください)を陳腐化しているとマークすることもできます。これは関数のときと同じ効果をもちます。関数またはマクロにたいするエイリアスも、陳腐化しているとマークできます。これはエイリアス自身をマークし、名前解決される関数またはマクロにたいしてではありません。
</p><pre class="synopsis"><a id="idm53488208" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">make-obsolete</code> <em class="replaceable"><code>obsolete-name</code></em> <em class="replaceable"><code>current-name</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>when</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>obsolete-name</code></em>を陳腐化しているとマークします。<em class="replaceable"><code>obsolete-name</code></em>には関数またはマクロを名前づけるシンボル、、または関数やマクロにたいするエイリアスを指定します。
</p><p><em class="replaceable"><code>current-name</code></em>がシンボルの場合は、<em class="replaceable"><code>obsolete-name</code></em>のかわりに<em class="replaceable"><code>current-name</code></em>の使用を促す警告メッセージになります。<em class="replaceable"><code>current-name</code></em>は、<em class="replaceable"><code>obsolete-name</code></em>にたいするエイリアスである必要はありません。似たような機能をもつ、別の関数かもしれません。<em class="replaceable"><code>current-name</code></em>には、警告メッセージとなる文字列も指定できます。メッセージは小文字で始まりピリオドで終えるべきです。<code class="literal">nil</code>も指定でき、この場合には警告メッセージに追加の詳細は提供されません。
</p><p><em class="replaceable"><code>when</code></em>が与えられた場合、それは最初にその関数が陳腐化する時期を示す文字列 — たとえば火付けやリリース番号を指定します。
</p></blockquote></div><pre class="synopsis"><a id="idm53479376" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">define-obsolete-function-alias</code> <em class="replaceable"><code>obsolete-name</code></em> <em class="replaceable"><code>current-name</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>when</code></em> <em class="replaceable"><code>doc</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この便利なマクロは関数<em class="replaceable"><code>obsolete-name</code></em>を陳腐化しているとマークするとともに、それを関数<em class="replaceable"><code>current-name</code></em>のエイリアスにします。これは以下と等価です:
</p><pre class="screen">(defalias <em class="replaceable"><code>obsolete-name</code></em> <em class="replaceable"><code>current-name</code></em> <em class="replaceable"><code>doc</code></em>)
(make-obsolete <em class="replaceable"><code>obsolete-name</code></em> <em class="replaceable"><code>current-name</code></em> <em class="replaceable"><code>when</code></em>)
</pre></blockquote></div><p>加えて、陳腐化した関数にたいする特定の呼び出し規約をマークできます。
</p><pre class="synopsis"><a id="idm53470672" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">set-advertised-calling-convention</code> <em class="replaceable"><code>function</code></em> <em class="replaceable"><code>signature</code></em> <em class="replaceable"><code>when</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>function</code></em>を呼び出す正しい方法として、引数リスト<em class="replaceable"><code>signature</code></em>を指定します。これにより、Emacs
Lispプログラムが他の方法で<em class="replaceable"><code>function</code></em>を呼び出している場合には、Emacsのバイトコンパイラーが警告を発します(それでもコードはバイトコンパイルされます)。<em class="replaceable"><code>when</code></em>には、その変数が最初に陳腐化するときを示す文字列(通常はバージョン番号)を指定します。
</p><p>たとえば、古いバージョンのEmacsでは、<code class="literal">sit-for</code>には以下のように3つの引数を指定していました
</p><pre class="screen">  (sit-for seconds milliseconds nodisp)
</pre><p>しかしこの方法による<code class="literal">sit-for</code>の呼び出しは陳腐化していると判断されます(<a class="link" href="ch21s10.html" title="Waiting for Elapsed Time or Input">Waiting</a>を参照してください)。以下のように、古い呼び出し規約は推奨されません:
</p><pre class="screen">(set-advertised-calling-convention
  'sit-for '(seconds &amp;optional nodisp) "22.1")
</pre></blockquote></div></div></body></html>