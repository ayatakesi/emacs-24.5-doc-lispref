<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>The declare Form</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Declare-Form"/>The <code class="literal">declare</code> Form</h1></div></div></div><a id="idm53436240" class="indexterm"/><p><code class="literal">declare</code>(宣言)は特別なマクロで、関数やマクロに“メタ”プロパティーを追加するために使用できます。たとえば陳腐化しているとマークしたり、Emacs
Lispモード内の特別な<span class="keycap"><strong>TAB</strong></span>インデント規則を与えることができます。
</p><a id="Definition-of-declare"/><pre class="synopsis"><a id="idm53433680" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">declare</code> <em class="replaceable"><code>specs</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このマクロは引数を無視して、<code class="literal">nil</code>として評価され、実行時の効果はありません。しかし<code class="literal">defun</code>または<code class="literal">defsubst</code>(<a class="link" href="ch13s04.html" title="Defining Functions">Defining
Functions</a>を参照してください)、または<code class="literal">defmacro</code>マクロ(<a class="link" href="ch14s04.html" title="Defining Macros">Defining
Macros</a>を参照してください)の定義の<em class="replaceable"><code>declare</code></em>引数に<code class="literal">declare</code>フォームがある場合は、<em class="replaceable"><code>specs</code></em>で指定されたプロパティーを関数またはマクロに追加します。これは<code class="literal">defun</code>、<code class="literal">defsubst</code>、<code class="literal">defmacro</code>により特別に処理されます。
</p><p><em class="replaceable"><code>specs</code></em>内の各要素は<code class="literal">(<em class="replaceable"><code>property</code></em>
<em class="replaceable"><code>args</code></em>…)</code>というフォームをもつべきです。また、クォートするべきではありません。これらは、以下の効果をもちます:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">(advertised-calling-convention <em class="replaceable"><code>signature</code></em> <em class="replaceable"><code>when</code></em>)</code>
</span></dt><dd><p>これは<code class="literal">set-advertised-calling-convention</code>(<a class="link" href="ch13s11.html" title="Declaring Functions Obsolete">Obsolete
Functions</a>を参照してください)の呼び出しと同じように振る舞います。<em class="replaceable"><code>signature</code></em>はその関数(またはマクロにたいする正しい引数リスト)で、<em class="replaceable"><code>when</code></em>は古い引数リストが最初に陳腐化する時期を示す文字列を指定します。
</p></dd><dt><span class="term"><code class="literal">(debug <em class="replaceable"><code>edebug-form-spec</code></em>)</code>
</span></dt><dd><p>これはマクロだけに有効です。Edebugでそのマクロ入ったときに、<em class="replaceable"><code>edebug-form-spec</code></em>を使用します。<a class="link" href="ch18s02.html#Instrumenting-Macro-Calls" title="Instrumenting Macro Calls">Instrumenting
Macro Calls</a>を参照してください。
</p></dd><dt><span class="term"><code class="literal">(doc-string <em class="replaceable"><code>n</code></em>)</code>
</span></dt><dd><p>それ自身が関数、マクロ、または変数のようなエンティティーを定義するために使用される関数やマクロを定義するときに使用されます。これは<em class="replaceable"><code>n</code></em>番目の引数を示し、もしあれば、それはドキュメント文字列です。
</p></dd><dt><span class="term"><code class="literal">(indent <em class="replaceable"><code>indent-spec</code></em>)</code>
</span></dt><dd><p>この関数(またはマクロ)にたいするインデント呼び出しは、<em class="replaceable"><code>indent-spec</code></em>にしたがいます。これは関数でも機能しますが、通常はマクロで使用されます。<a class="link" href="ch14s06.html" title="Indenting Macros">Indenting
Macros</a>を参照してください。
</p></dd><dt><span class="term"><code class="literal">(obsolete <em class="replaceable"><code>current-name</code></em> <em class="replaceable"><code>when</code></em>)</code>
</span></dt><dd><p><code class="literal">make-obsolete</code>(<a class="link" href="ch13s11.html" title="Declaring Functions Obsolete">Obsolete
Functions</a>を参照してください)と同様に、関数(またはマクロ)を陳腐化しているとマークします。<em class="replaceable"><code>current-name</code></em>にはシンボル(かわりにこのシンボルを使うことをすすめる警告メッセージになります)、文字列(警告メッセージを指定します)、または<code class="literal">nil</code>(警告メッセージには追加の詳細が含まれません)を指定します。<em class="replaceable"><code>when</code></em>には、その関数(またはマクロ)が最初に陳腐化する時期を示す文字列を指定します。
</p></dd><dt><span class="term"><code class="literal">(compiler-macro <em class="replaceable"><code>expander</code></em>)</code>
</span></dt><dd><p>これは関数だけに使用でき、最適化関数(optimization
function)として<em class="replaceable"><code>expander</code></em>を使用するようコンパイラーに告げます。<code class="literal">(<em class="replaceable"><code>function</code></em>
<em class="replaceable"><code>args</code></em>…)</code>のようなその関数への呼び出しフォームに出会うと、マクロ展開機能(macro
expander)は<em class="replaceable"><code>args</code></em>…と同様のフォームで<em class="replaceable"><code>expander</code></em>を呼び出します。<em class="replaceable"><code>expander</code></em>はその関数呼び出しのかわりに使用するための新しい式、または変更されていないフォーム(その関数呼び出しを変更しないことを示す)のどちらかをreturnすることができます。<em class="replaceable"><code>expander</code></em>にはシンボル、またはフォーム<code class="literal">(lambda
(<em class="replaceable"><code>arg</code></em>)
<em class="replaceable"><code>body</code></em>)</code>を指定できます。フォームの場合、<em class="replaceable"><code>arg</code></em>は元の関数呼び出し式を保持して、その関数の形式に適う引数を使用することにより、その関数にたいする(評価されていない)引数にアクセスできます。
</p></dd><dt><span class="term"><code class="literal">(gv-expander <em class="replaceable"><code>expander</code></em>)</code>
</span></dt><dd><p><em class="replaceable"><code>expander</code></em>が<code class="literal">gv-define-expander</code>と同様、汎変数としてマクロ(または関数)にたいする呼び出しを処理する関数であることを宣言します。<em class="replaceable"><code>expander</code></em>はシンボル、またはフォーム<code class="literal">(lambda
(<em class="replaceable"><code>arg</code></em>) <em class="replaceable"><code>body</code></em>)</code>を指定できます。フォームの場合、その関数は追加でそのマクロ(または関数)にアクセスできます。
</p></dd><dt><span class="term"><code class="literal">(gv-setter <em class="replaceable"><code>setter</code></em>)</code>
</span></dt><dd><p><em class="replaceable"><code>setter</code></em>が、汎変数としてマクロ(または関数)にたいする呼び出しを処理する関数であることを宣言します。<em class="replaceable"><code>setter</code></em>はシンボル、またはフォームを指定できます。シンボルの場合、そのシンボルは<code class="literal">gv-define-simple-setter</code>に渡されます。フォームの場合は<code class="literal">(lambda
(<em class="replaceable"><code>arg</code></em>)
<em class="replaceable"><code>body</code></em>)</code>という形式で、その関数は追加でマクロ(または関数)にアクセスでき、<code class="literal">gv-define-setter</code>に渡されます。
</p></dd></dl></div></blockquote></div></div></body></html>