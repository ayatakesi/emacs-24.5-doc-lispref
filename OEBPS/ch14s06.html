<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Indenting Macros</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Indenting-Macros"/>Indenting Macros</h1></div></div></div><p>マクロ定義では、マクロ呼び出しを<span class="keycap"><strong>TAB</strong></span>がどのようにインデントすべきか指定するために、<code class="literal">declare</code>フォーム(<a class="link" href="ch14s04.html" title="Defining Macros">Defining
Macros</a>を参照してください)を使うことができます。インデント指定は以下のように記述します:
</p><pre class="screen">(declare (indent <em class="replaceable"><code>indent-spec</code></em>))
</pre><p>以下は利用できる<em class="replaceable"><code>indent-spec</code></em>です:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nil</code>
</span></dt><dd><p>これはプロパティーを指定しない場合と同じ — 標準的なインデントパターンを使用します。
</p></dd><dt><span class="term"><code class="literal">defun</code>
</span></dt><dd><p>この関数を‘<code class="literal">def</code>’構造 — 2番目の行が<em class="firstterm">body</em>の開始 — と同様に扱います。
</p></dd><dt><span class="term">整数: <em class="replaceable"><code>number</code></em>
</span></dt><dd><p>関数の最初の<em class="replaceable"><code>number</code></em>個の引数は<em class="firstterm">区別</em>され、残りは式のbodyと判断されます。その式の中の行は、最初の引数が区別されているかどうかにしたがってインデントされます。引数がbodyの一部である場合、その行はこの式の先頭の
開きカッコ(open-parenthesis)よりも<code class="literal">lisp-body-indent</code>だけ多い列にインデントされます。引数が
区別されていて、1つ目または2つ目の引数である場合は、<span class="emphasis"><em>2倍</em></span>余分にインデントされます。引数が区別されていて1つ目あるいは2つ目の引数でない場合、その行は標準パターンによってインデントされます。
</p></dd><dt><span class="term">シンボル: <em class="replaceable"><code>symbol</code></em>
</span></dt><dd><p><em class="replaceable"><code>symbol</code></em>は関数名です。その関数はこの式のインデントを計算するために呼び出される関数です。この関数は2つの引数をとります:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>pos</code></em>
</span></dt><dd><p>その行のインデントが開始される位置です。
</p></dd><dt><span class="term"><em class="replaceable"><code>state</code></em>
</span></dt><dd><p>その行の開始まで解析されたとき、<code class="literal">parse-partial-sexp</code>(インデントとネスト深さの計算のためのLispプリミティブ)によりreturnされる値です。
</p></dd></dl></div><p>これは、数(その行のインデントの列数)、またはそのような数がcarであるようなリストをreturnすべきです。数とリストの違いは、数の場合、同じネスト深さの後続のすべての行はこの数と同じインデントとなります。リストの場合、後続の行は異なるインデントを呼び出すかもしれません。これは、<strong class="userinput"><code>C-M-q</code></strong>によりインデントが計算されるときに違いがでます。値が数の場合、<strong class="userinput"><code>C-M-q</code></strong>はリストの終わりまでの後続の行のインデントを、再計算する必要はありません。
</p></dd></dl></div></div></body></html>