<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Library Search</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Library-Search"/>Library Search</h1></div></div></div><a id="idm56307024" class="indexterm"/><a id="idm56306256" class="indexterm"/><p>EmacsがLispライブラリーをロードするときは、変数<code class="literal">load-path</code>.&lt;により指定されるディレクトリー内のライブラリーを検索します。
</p><pre class="synopsis"><a id="idm56304336" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">load-path</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、<code class="literal">load</code>でファイルをロードするとき検索するディレクトリーのリストです。リストの各要素は文字列(ディレクトリー名でなければなりません)、または<code class="literal">nil</code>(カレントワーキングディレクトリーを意味します)です。
</p></blockquote></div><p>Emacsは起動時にいくつかのステップにより<code class="literal">load-path</code>の値をセットアップします。最初に、Emacsがコンパイルされたときのデフォルトロケーションセット(default
locations set)を使用して、<code class="literal">load-path</code>を初期化します。通常これは以下のようなディレクトリーです
</p><pre class="screen">"/usr/local/share/emacs/<em class="replaceable"><code>version</code></em>/lisp"
</pre><p>(以下の例では、あなたがインストールしたEmacsのインストールプレフィクスに合うように<code class="filename">/usr/local</code>を置き換えてください。)これらのディレクトリーには、Emacsとともにインストールされた、標準的なLispファイルが含まれます。Emacsがこれらを見つけられない場合は、正常に起動しないでしょう。
</p><p>Emacsをビルドしたディレクトリーから起動した場合 −−− つまり正式にインストールされた実行形式ではないEmacsを起動した場合
—　、Emacsはビルドされたディレクトリーのソースの<code class="filename">lisp</code>ディレクトリーを使用して<code class="literal">load-path</code>を初期化します。ソースとは別のディレクトリーでEmacsをビルドした場合は、ビルドしたディレクトリーの<code class="filename">lisp</code>ディレクトリーも追加します。(どちらの場合も、要素は絶対ファイル名になります。)
</p><a id="idm56287056" class="indexterm"/><p><code class="option">--no-site-lisp</code>オプションでEmacsを起動した場合を除き、<code class="literal">load-path</code>の先頭に2つのさらに<code class="filename">site-lisp</code>を追加します。これらはローカルにインストールされたLispファイで、通常は:
</p><pre class="screen">"/usr/local/share/emacs/<em class="replaceable"><code>version</code></em>/site-lisp"
</pre><p>と
</p><pre class="screen">"/usr/local/share/emacs/site-lisp"
</pre><p>の形式です。1つ目は特定のバージョンのEmacsにたいしてローカルにインストールされたものです。2つ目はインストールされたすべてのバージョンのEmacsが使用することを意図してローカルにインストールされたものです。(インストールされたものでないEmacsが実行された場合は、もし存在すればソースディレクトリーとビルドディレクトリーの<code class="filename">site-lisp</code>ディレクトリーも追加します。これらのディレクトリーは通常、<code class="filename">site-lisp</code>ディレクトリーを含みません。)
</p><a id="idm56281424" class="indexterm"/><p>環境変数<code class="envar">EMACSLOADPATH</code>がセットされている場合は、上述の初期化プロセスが変更されます。Emacsは、この環境変数の値にもとづいて<code class="literal">load-path</code>を初期化します。
</p><p><code class="envar">EMACSLOADPATH</code>の構文は、<code class="literal">PATH</code>で使用される構文と同様です。ディレクトリー名は‘<code class="literal">:</code>’(オペレーティングシステムによっては‘<code class="literal">;</code>’)で区切られます。
以下は、(<span class="command"><strong>sh</strong></span>スタイルのシェルから)<code class="envar">EMACSLOADPATH</code>変数をセットする例です:
</p><pre class="screen">export EMACSLOADPATH=/home/foo/.emacs.d/lisp:
</pre><p>環境変数の値内の空の要素は、(上記例のような)末尾、先頭、中間にあるかに関わらず、標準の初期化処理により決定される<code class="literal">load-path</code>のデフォルト値に置き換えられます。そのような空要素が存在しない場合には、<code class="envar">EMACSLOADPATH</code>により<code class="literal">load-path</code>全体が指定されます。空要素、または標準のLispファイルを含むディレクトリーへの明示的なパスのどちらかを含めなければなりません。さもないとEmacsが関数を見つけられなくなります。(<code class="literal">load-path</code>を変更する他の方法は、Emacs起動時にコマンドラインオプション<code class="option">-L</code>を使用する方法です。以下参照。)
</p><p><code class="literal">load-path</code>内の各ディレクトリーにたいし、Emacsはそのディレクトリーがファイル<code class="filename">subdirs.el</code>を含むか確認し、もしあればそれをロードします。<code class="filename">subdirs.el</code>ファイルは、<code class="literal">load-path</code>のディレクトリーみたいして任意のサブディレクトリーを追加するためのコードが含まれており、Emacsがビルド/インストールされたとき作成されます。サブディレクトリーと複数階層下のレベルのサブディレクトリーの両方が、直接追加されます。ただし、名前の最初が英数字でないディレクトリー、名前が<code class="filename">RCS</code>または<code class="filename">CVS</code>のディレクトリー、名前が<code class="filename">.nosearch</code>というファイルを含むディレクトリーは除外されます。
</p><p>Emacsは次に、コマンドラインオプション<code class="option">-L</code>(section “Action Arguments” in <em class="citetitle">The GNU
Emacs Manual</em>を参照)で指定したロードディレクトリーを追加します。もしあれば、オプションパッケージ(<a class="link" href="ch40.html#Packaging-Basics" title="Packaging Basics">Packaging
Basics</a>を参照)がインストールされた場所も追加します。
</p><p>initファイル(<a class="link" href="ch39.html#Init-File" title="The Init File">Init
File</a>を参照)で、<code class="literal">load-path</code>に1つ以上のディレクトリーを追加するコードを記述するのは一般的に行なわれています。たとえば:
</p><pre class="screen">(push "~/.emacs.d/lisp" load-path)
</pre><p>Emacsのダンプには、<code class="literal">load-path</code>の特別な値を使用します。ダンプされたEmacsをカスタマイズするために<code class="filename">site-load.el</code>または<code class="filename">site-init.el</code>を使用する場合、これらのファイルが行った<code class="literal">load-path</code>にたいする変更はすべて、ダンプ後失われます。
</p><pre class="synopsis"><a id="idm56262480" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">locate-library</code> <em class="replaceable"><code>library</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>nosuffix</code></em> <em class="replaceable"><code>path</code></em> <em class="replaceable"><code>interactive-call</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、ライブラリー<em class="replaceable"><code>library</code></em>の正確なファイル名を探します。<code class="literal">load</code>と同じ方法でライブラリーを検索し、引数<em class="replaceable"><code>nosuffix</code></em>も<code class="literal">load</code>の場合と同じ意味です。<em class="replaceable"><code>library</code></em>に指定する名前には、サフィックス‘<code class="literal">.elc</code>’または‘<code class="literal">.el</code>’を追加しないでください。
</p><p><em class="replaceable"><code>path</code></em>が非<code class="literal">nil</code>の場合は、<code class="literal">load-path</code>のかわりにディレクトリーのリストが使用されます。
</p><p><code class="literal">locate-library</code>がプログラムから呼び出されたときは、ファイル名を文字列としてリターンします。ユーザーがインタラクティブに<code class="literal">locate-library</code>を実行したときは、引数<em class="replaceable"><code>interactive-call</code></em>が<code class="literal">t</code>となり、これは<code class="literal">locate-library</code>にたいしてファイル名をエコーエリアに表示するよう指示します。
</p></blockquote></div><a id="idm56250448" class="indexterm"/><pre class="synopsis"><a id="idm56249424" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">list-load-path-shadows</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>stringp</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、<em class="firstterm">シャドー(shadowed)</em>されたEmacs
Lispファイルを表示します。シャドーされたファイルとは、<code class="literal">load-path</code>のディレクトリーに存在するにも関わらず、<code class="literal">load-path</code>のディレクトリーリスト内で前の位置にある他のディレクトリーに同じ名前のファイルが存在するため、通常はロードされないファイルのことです。
</p><p>たとえば、以下のように<code class="literal">load-path</code>がセットされていたとします
</p><pre class="screen">  ("/opt/emacs/site-lisp" "/usr/share/emacs/23.3/lisp")
</pre><p>そして、両方のディレクトリーに<code class="filename">foo.el</code>という名前のファイルがあるとします。この場合、<code class="literal">(require
'foo)</code>は決して2つ目のディレクトリーのファイルをロードしません。このような状況は、Emacsがインストールされた方法に問題があることを示唆します。
</p><p>Lispから呼び出された場合、この関数はバッファー内に表示するかわりに、シャドーされたファイルリストのメッセージをプリントします。オプション引数<code class="literal">stringp</code>が非<code class="literal">nil</code>の場合は、かわりにシャドーされたファイルを文字列としてリターンします。
</p></blockquote></div></div></body></html>