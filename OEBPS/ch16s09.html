<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Unloading</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Unloading"/>Unloading</h1></div></div></div><a id="idm55920208" class="indexterm"/><p>他のLispオブジェクト用にメモリーを回収するために、ライブラリーによりロードされた関数や変数を破棄することができます。これを行うには、関数<code class="literal">unload-feature</code>を使用します:
</p><pre class="synopsis"><a id="idm55918032" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">unload-feature</code> <em class="replaceable"><code>feature</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>force</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドはフィーチャ<em class="replaceable"><code>feature</code></em>をプロバイドしていたライブラリーをアンロードします。そのライブラリー内の<code class="literal">defun</code>、<code class="literal">defalias</code>、<code class="literal">defsubst</code>、<code class="literal">defmacro</code>、<code class="literal">defconst</code>、<code class="literal">defvar</code>、<code class="literal">defcustom</code>により定義されたすべての関数、マクロ、変数は未定義になります。その後、それらのシンボルにたいして事前に関連付けられていたオートロードをリストアします。(ロードはシンボルの<code class="literal">autoload</code>プロパティにこれらを保存しています。)
</p><p>以前の定義をリストアする前に、特定のフックからそのライブラリー内の関数を取り除くために、<code class="literal">unload-feature</code>は<code class="literal">remove-hook</code>を実行します。これらのフックには、名前が‘<code class="literal">-hook</code>’(または廃止されたサフィックス‘<code class="literal">-hooks</code>’)で終わる変数、加えて<code class="literal">unload-feature-special-hooks</code>、同様に<code class="literal">auto-mode-alist</code>にリストされた変数も含まれます。これは、重要なフックがすでに定義されていない関数を参照をすることにより、Emacsの機能が停止することを防ぐためです。
</p><p>標準的なアンロードアクティビティは、そのライブラリー内の関数のELPプロファイリングを取り消し、そのライブラリーによりプロバイドされたフィーチャを取り消し、そのライブラリーで定義された変数に保持されたタイマーも取り消します。
</p><a id="idm55905872" class="indexterm"/><p>これらの基準が機能不全を防ぐのに十分でない場合、ライブラリーは<code class="literal"><em class="replaceable"><code>feature</code></em>-unload-function</code>という名前の明示的なアンローダーを定義できます。そのシンボルが関数として定義された場合、<code class="literal">unload-feature</code>は何かを行う前にまず引数なしでそれを呼び出します。これはライブラリーをアンロードしるために適切なすべてのことを行うことができます。これが<code class="literal">nil</code>をリターンした場合、<code class="literal">unload-feature</code>は通常のアンロードアクションを処理します。それ以外は、アンロード処理は完了したとみなします。
</p><p><code class="literal">unload-feature</code>は通常、他のライブラリーが依存するライブラリーのアンロードを拒絶します。(ライブラリー<em class="replaceable"><code>b</code></em>にたいする<code class="literal">require</code>がライブラリー<em class="replaceable"><code>a</code></em>に含まれる場合、<em class="replaceable"><code>a</code></em>は<em class="replaceable"><code>b</code></em>に依存します。)オプション引数<em class="replaceable"><code>force</code></em>が非<code class="literal">nil</code>の場合、依存関係は無視され、どのようなライブラリーもアンロードできます。
</p></blockquote></div><p><code class="literal">unload-feature</code>関数はLispで記述されており、その動作は変数<code class="literal">load-history</code>にもとづきます。
</p><pre class="synopsis"><a id="idm55896784" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">unload-feature-special-hooks</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数には、ライブラリー内で定義された関数を取り除くために、ライブラリーをアンロードする前にスキャンされるフックのリストが保持されています。
</p></blockquote></div></div></body></html>