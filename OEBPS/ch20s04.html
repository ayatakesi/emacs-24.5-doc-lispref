<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Minibuffer History</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Minibuffer-History"/>Minibuffer History</h1></div></div></div><a id="idm58037072" class="indexterm"/><a id="idm58036304" class="indexterm"/><p><em class="firstterm">ミニバッファーヒストリーリスト(minibuffer history
list)</em>は以前のミニバッファー入力を記録するので、それらを手軽に再利用できます。ミニバッファーヒストリーリストは、(以前に入力された)文字列のリストで、もっとも最近の文字列が先頭になります。
</p><p>多数のミニバッファーが個別に存在し、異なる入力の種類に使用されます。それぞれのミニバッファー使用にたいして正しいヒストリーリストを指定するのは、Lispプログラマーの役目です。
</p><p>ミニバッファーヒストリーリストは、<code class="literal">read-from-minibuffer</code>および<code class="literal">completing-read</code>のオプション引数<em class="replaceable"><code>history</code></em>に指定します。以下が利用できる値です:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>variable</code></em>
</span></dt><dd><p>ヒストリーリストとして<em class="replaceable"><code>variable</code></em>(シンボル)を使用する。
</p></dd><dt><span class="term">(<em class="replaceable"><code>variable</code></em> . <em class="replaceable"><code>startpos</code></em>)
</span></dt><dd><p>ヒストリーリストとして<em class="replaceable"><code>variable</code></em>(シンボル)を使用し、ヒストリー位置の初期値を<em class="replaceable"><code>startpos</code></em>(負の整数)とみなす。
</p><p><em class="replaceable"><code>startpos</code></em>に0を指定するのは、単にシンボル<em class="replaceable"><code>variable</code></em>だけを指定するのと等価である。<code class="literal">previous-history-element</code>はミニバッファー内のヒストリーリストの最新の要素を表示するだろう。
正の<em class="replaceable"><code>startpos</code></em>を指定した場合、ミニバッファーヒストリー関数は<code class="literal">(elt <em class="replaceable"><code>variable</code></em>(1-
<em class="replaceable"><code>startpos</code></em>))</code>がミニバッファー内でカレントで表示されているヒストリー要素であるかのように振る舞う。
</p><p>一貫性を保つため、ミニバッファー入力関数の<em class="replaceable"><code>initial</code></em>引数(<a class="link" href="ch20s05.html" title="Initial Input">Initial
Input</a>を参照)使用して、ミニバッファーの初期内容となるヒストリー要素も指定すべきである。
</p></dd></dl></div><p><em class="replaceable"><code>history</code></em>を指定しない場合は、デフォルトのヒストリーリスト<code class="literal">minibuffer-history</code>が使用されます。他の標準的なヒストリーリストについては、以下を参照してください。最初に使用する前に<code class="literal">nil</code>に初期化するだけで、独自のヒストリーリストを作成することもできます。
</p><p><code class="literal">read-from-minibuffer</code>と<code class="literal">completing-read</code>は、どちらも新たな要素を自動的にヒストリーリストに追加して、ユーザーがそのリストのアイテムを再使用するためのコマンドを提供します。ヒストリーリストを使用するためにプログラムが行う必要があるのは、リストの初期化と、使用するときに入力関数にリストの名前を渡すだけです。しかし、ミニバッファー入力関数がリストを使用していないときに、手動でリストを変更しても問題はありません。
</p><p>新たな要素をヒストリーリストに追加するEmacs関数は、リストが長くなりすぎたときに古い要素の削除も行うことができます。変数<code class="literal">history-length</code>は、ほとんどのヒストリーリストの最大長を指定する変数です。特定のヒストリーリストにたいして異なる最大長を指定するには、そのヒストリーリストシンボルの<code class="literal">history-length</code>プロパティにその最大長をセットします。変数<code class="literal">history-delete-duplicates</code>には、ヒストリー内の重複を削除するかどうかを指定します。
</p><pre class="synopsis"><a id="idm58010576" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">add-to-history</code> <em class="replaceable"><code>history-var</code></em> <em class="replaceable"><code>newelt</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>maxelt</code></em> <em class="replaceable"><code>keep-all</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<em class="replaceable"><code>newelt</code></em>が空文字列でなければ、それを新たな要素として変数<em class="replaceable"><code>history-var</code></em>に格納されたヒストリーリストに追加して、更新されたヒストリーリストをリターンする。これは<em class="replaceable"><code>maxelt</code></em>または<code class="literal">history-length</code>がが非<code class="literal">nil</code>の場合は、リストの長さをその変数の値に制限する(以下参照)。<em class="replaceable"><code>maxelt</code></em>に指定できる値の意味は、<code class="literal">history-length</code>の値と同様。
</p><p><code class="literal">add-to-history</code>は通常、<code class="literal">history-delete-duplicates</code>が非<code class="literal">nil</code>ならば、ヒストリーリスト内の重複メンバーを削除する。しかし、<em class="replaceable"><code>keep-all</code></em>が非<code class="literal">nil</code>の場合、それは重複を削除しないことを意味し、たとえ<em class="replaceable"><code>newelt</code></em>が空でもリストに追加する。
</p></blockquote></div><pre class="synopsis"><a id="idm57987408" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">history-add-new-input</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値が<code class="literal">nil</code>の場合、ミニバッファーから読み取りを行う標準的な関数は、ヒストリーリストに新たな要素を追加しない。これにより、Lispプログラムが<code class="literal">add-to-history</code>を使用して明示的に入力ヒストリーを管理することになる。デフォルト値は<code class="literal">t</code>。
</p></blockquote></div><pre class="synopsis"><a id="idm57983184" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">history-length</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、最大長を独自に指定しないすべてのヒストリーリストの最大長を指定する。値が<code class="literal">t</code>の場合は、最大長がない(古い要素を削除しない)ことを意味する。ヒストリーリスト変数のシンボルの<code class="literal">history-length</code>プロパティが非<code class="literal">nil</code>の場合には、その特定のヒストリーリストにたいする最大長として、そのプロパティ値がこの変数をオーバーライドする。
</p></blockquote></div><pre class="synopsis"><a id="idm57978960" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">history-delete-duplicates</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値が<code class="literal">t</code>の場合、それは新たなヒストリー要素の追加時に、以前からある等しい要素が削除されることを意味する。
</p></blockquote></div><p>以下は、標準的なミニバッファーヒストリーリスト変数です:
</p><pre class="synopsis"><a id="idm57975376" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">minibuffer-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>ミニバッファーヒストリー入力にたいするデフォルトのヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57972688" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">query-replace-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p><code class="literal">query-replace</code>の引数(および他のコマンドの同様の引数)にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57969616" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">file-name-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>ファイル名引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57966928" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">buffer-name-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>バッファー名引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57964240" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">regexp-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>正規表現引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57961552" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">extended-command-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>拡張コマンド名引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57958864" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">shell-command-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>シェルコマンド引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57956176" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">read-expression-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>評価されるためのLisp式引数にたいするヒストリーリスト。
</p></blockquote></div><pre class="synopsis"><a id="idm57953488" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">face-name-history</code></pre><div class="blockquote"><blockquote class="blockquote"><p>フェイス引数にたいするヒストリーリスト。
</p></blockquote></div></div></body></html>