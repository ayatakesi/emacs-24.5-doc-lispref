<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Asking Multiple Y-or-N Questions</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Multiple-Queries"/>Asking Multiple Y-or-N Questions</h1></div></div></div><a id="idm57205200" class="indexterm"/><p>同じような連続する質問と答えがある場合、たとえば各バッファーにたいして順に“Do you want to save this
buffer”と確認を求めるような場合は、個別に質問するより<code class="literal">map-y-or-n-p</code>を使用して質問のコレクションを尋ねるべきです。これはユーザーにたいして、質問全体にたいして1回で答えられるような便利な機能を提供します。
</p><pre class="synopsis"><a id="idm57203280" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">map-y-or-n-p</code> <em class="replaceable"><code>prompter</code></em> <em class="replaceable"><code>actor</code></em> <em class="replaceable"><code>list</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>help</code></em> <em class="replaceable"><code>action-alist</code></em> <em class="replaceable"><code>no-cursor-in-echo-area</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数はユーザーに一連の質問をし、それぞれの質問にたいしてエコーエリア内の1文字の答えを読み取る。
</p><p>値<em class="replaceable"><code>list</code></em>は質問をするオブジェクトを指定する。これはリスト、オブジェクト、または生成関数(generator
function)のいずれかである。関数の場合は引数なしで、次に質問するオブジェクト、または質問の中止を意味する<code class="literal">nil</code>のいずれかをリターンする。
</p><p>引数<em class="replaceable"><code>prompter</code></em>は各質問について問い合わせ方法を指定する。<em class="replaceable"><code>prompter</code></em>が文字列の場合、質問テキストは以下のようになる:
</p><pre class="screen">(format <em class="replaceable"><code>prompter</code></em> <em class="replaceable"><code>object</code></em>)
</pre><p>ここで<em class="replaceable"><code>object</code></em>は、(<em class="replaceable"><code>list</code></em>から得られる)質問する次のオブジェクトである。
</p><p>文字列でない場合、<em class="replaceable"><code>prompter</code></em>は1つの引数(質問する次のオブジェクト)をとる関数で、質問テキストをリターンする。値が文字列の場合は、ユーザー問うための質問。関数は<code class="literal">t</code>(ユーザーに尋ねずこのオブジェクトを処理する)、または<code class="literal">nil</code>(ユーザーに尋ねずこのオブジェクトを無視する)をリターンすることもできる。
</p><p>引数<em class="replaceable"><code>actor</code></em>は、ユーザーが与えた答えにたいし、どのように処理するかを指定する。これは引数が1つの関数で、ユーザーがyesと答えたオブジェクトを引数に呼び出される。引数は常に<em class="replaceable"><code>list</code></em>から取得したオブジェクトである。
</p><p>引数<em class="replaceable"><code>help</code></em>が与えられた場合は、以下の形式のリストである:
</p><pre class="screen">(<em class="replaceable"><code>singular</code></em> <em class="replaceable"><code>plural</code></em> <em class="replaceable"><code>action</code></em>)
</pre><p><em class="replaceable"><code>singular</code></em>はそのオブジェクトが概念的に何に作用するかを説明する単数形の名詞を含む文字列、<em class="replaceable"><code>plural</code></em>はそれに対応する複数形の名詞、<em class="replaceable"><code>action</code></em>は<em class="replaceable"><code>actor</code></em>が何を行うかを説明する他動詞である。
</p><p><em class="replaceable"><code>help</code></em>を指定しない場合のデフォルトは、<code class="literal">("object" "objects" "act on")</code>。
</p><p>質問のたびに、ユーザーはそのオブジェクトを処理するには<strong class="userinput"><code>y</code></strong>、<strong class="userinput"><code>Y</code></strong>または<span class="keycap"><strong>SPC</strong></span>を、そのオブジェクトをスキップするには<strong class="userinput"><code>n</code></strong>、<strong class="userinput"><code>N</code></strong>、または<span class="keycap"><strong>DEL</strong></span>を、以降のすべてのオブジェクトを処理するには<strong class="userinput"><code>!</code></strong>を、exit(以降のすべてのオブジェクトをスキップ)するには<span class="keycap"><strong>ESC</strong></span>か<strong class="userinput"><code>q</code></strong>を、カレントオブジェクトを処理した後にexitするには<strong class="userinput"><code>.</code></strong>(ピリオド)を、ヘルプを入手するには<strong class="userinput"><code>C-h</code></strong>をエンターする。これらは<code class="literal">query-replace</code>が受け入れるのと同じ答えである。キーマップ<code class="literal">query-replace-map</code>は<code class="literal">map-y-or-n-p</code>にたいするそれらの意味を定義し、<code class="literal">query-replace</code>にたいしても同様に定義する。<a class="link" href="ch34s07.html" title="Search and Replace">Search
and Replace</a>を参照のこと。
</p><p><em class="replaceable"><code>action-alist</code></em>を使用して、利用できる追加の答えとそれらが何を意味するかを指定できる。これは要素が<code class="literal">(<em class="replaceable"><code>char</code></em>
<em class="replaceable"><code>function</code></em>
<em class="replaceable"><code>help</code></em>)</code>という形式のalistで、それぞれの要素が追加の答えを1つ定義する。要素の内容は<em class="replaceable"><code>char</code></em>が文字(答え)、<em class="replaceable"><code>function</code></em>が引数が1つ(<em class="replaceable"><code>list</code></em>から取得するオブジェクト)の関数、<em class="replaceable"><code>help</code></em>が文字列である。
</p><p>ユーザーの応答が<em class="replaceable"><code>char</code></em>の場合、<code class="literal">map-y-or-n-p</code>は<em class="replaceable"><code>function</code></em>を呼び出す。これが非<code class="literal">nil</code>をリターンした場合には、そのオブジェクトが“処理された”と判断して、<code class="literal">map-y-or-n-p</code>は<em class="replaceable"><code>list</code></em>内の次のオブジェクトに進む。<code class="literal">nil</code>をリターンした場合は、同じオブジェクトにたいして質問を繰り返す。
</p><p>確認を求める間は通常、<code class="literal">map-y-or-n-p</code>は<code class="literal">cursor-in-echo-area</code>をバインドする。しかし<em class="replaceable"><code>no-cursor-in-echo-area</code></em>が非<code class="literal">nil</code>の場合はバインドしない。
</p><p>マウスを使用して呼び出されたコマンドから<code class="literal">map-y-or-n-p</code>が呼び出された場合(より正確には<code class="literal">last-nonmenu-event</code>は非<code class="literal">nil</code>かリストの場合。<a class="link" href="ch21s05.html" title="Information from the Command Loop">Command
Loop
Info</a>を参照)は、確認を求めるためにダイアログボックスかポップアップメニューが使用される。この場合、キーボード入力やエコーエリアは使用されない。呼び出しの前後で<code class="literal">last-nonmenu-event</code>を適切な値にバインドして、入力マウスあるいはキーボードの入力を強制できる。
</p><p><code class="literal">map-y-or-n-p</code>のリターン値は、処理したオブジェクトの数である。
</p></blockquote></div></div></body></html>