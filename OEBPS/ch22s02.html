<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Keymap Basics</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Keymap-Basics"/>Keymap Basics</h1></div></div></div><a id="idm59245392" class="indexterm"/><a id="idm59244624" class="indexterm"/><a id="idm59243856" class="indexterm"/><a id="idm59243088" class="indexterm"/><p>キーマップは、さまざまなキーシーケンスにたいして<em class="firstterm">キーバインディング(key binding)</em>を指定するLispデータ構造です。
</p><p>1つのキーマップが、個々のイベントにたいする定義を直接指定します。
A single keymap directly specifies definitions for individual events.
単一のイベントでキーシーケンスが構成されるとき、そのキーシーケンスのキーマップ内でのバインディングは、そのイベントにたいするそのキーマップの定義です。それより長いキーシーケンスのバインディングは対話的プロセスにより見つけ出されます。まず、最初のイベント(これ自身がキーマップでなければならない)の定義を探します。次にそのキーマップ内で2つ目のイベントを探すといったように、そのキーシーケンス内のすべてのイベントが処理されるまで、これを続けます。
</p><p>あるキーシーケンスのバインディングがキーマップであるような場合、わたしたちはそのキーシーケンスを<em class="firstterm">プレフィクスキー(prefix
key)</em>と呼び、それ以外の場合は(それ以上イベントを追加できないので)<em class="firstterm">コンプリートキー(complete
keyl</em>と呼んでいます。バインディングが<code class="literal">nil</code>の場合、わたしたちはそのキーを<em class="firstterm">未定義(undefined)</em>と呼びます。<strong class="userinput"><code>C-c</code></strong>、<strong class="userinput"><code>C-x</code></strong>、<strong class="userinput"><code>C-x
4</code></strong>などはプレフィクスキーの例です。<strong class="userinput"><code>X</code></strong>、<span class="keycap"><strong>RET</strong></span>、<strong class="userinput"><code>C-x 4
C-f</code></strong>などは定義されたコンプリートキーの例です。<strong class="userinput"><code>C-x C-g</code></strong>や<strong class="userinput"><code>C-c
3</code></strong>などは未定義なコンプリートキーの例です。詳細は<a class="link" href="ch22s06.html" title="Prefix Keys">Prefix Keys</a>を参照してください。
</p><p>キーシーケンスのバインディングを見つけ出すルールは、(最後のイベントの前までに見つかる)中間的なバインディングがすべてキーマップであると仮定します。もしそうでなければ、そのイベントシーケンスは単位を形成せず、実際の単一キーシーケンスではありません。他の言い方をすると、任意の有効なキーシーケンスから1つ以上のイベントを取り除くと、常にプレフィクスキーにならなければなりません。たとえば<strong class="userinput"><code>C-f
C-n</code></strong>はキーシーケンスではありません。<strong class="userinput"><code>C-f</code></strong>はプレフィクスキーではないので、<strong class="userinput"><code>C-f</code></strong>で始まるこれより長いシーケンスは、キーシーケンスであり得ないのです。
</p><p>利用可能な複数イベントキーシーケンスのセットは、プレフィクスキーにたいするバインディングに依存します。したがって、これはキーマップが異なれば異なるかもしれず、バインディングが変更されたとき変更されるかもしれません。しかし、単一イベントキーシーケンスは適格性において任意のプレフィクスキーに依存しないので、常に単一のキーシーケンスです。
</p><p>常に複数のプライマリーキーマップ(primary keymap:
主キーマップ)がアクティブであり、これらはキーバインディングを見つけるために使用されます。すべてのバッファーで共有される<em class="firstterm">グローバルキーマップ(global
map)</em>というキーマップが存在します。<em class="firstterm">ローカルキーマップ(local
keymap)</em>は通常、特定のメジャーモードに関連します。そして0個以上の<em class="firstterm">マイナーモードキーマップ(minor mode
keymap)</em>はカレントで有効なマイナーモードに属します(すべてのマイナーモードがキーマップをもつわけでなない)。ローカルキーマップは、対応するグローバルバインディングをshadow(優先される)します。マイナーモードキーマップは、ローカルキーマップとグローバルキーマップの両方をshadowします。詳細は、<a class="link" href="ch22s07.html" title="Active Keymaps">Active
Keymaps</a>を参照してください。
</p></div></body></html>