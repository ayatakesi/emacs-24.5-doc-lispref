<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Controlling the Active Keymaps</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Controlling-Active-Maps"/>Controlling the Active Keymaps</h1></div></div></div><a id="idm63029072" class="indexterm"/><pre class="synopsis"><a id="idm63028048" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">global-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、Emacsキーボード入力をコマンドにマップするデフォルトのグローバルキーマップを含む。通常は、このキーマップがグローバルキーマップである。デフォルトグローバルキーマップは、<code class="literal">self-insert-command</code>をすべてのプリント文字にバインドするfullキーマップである。
</p><p>これはグローバルキーマップ内のバインディングを変更する通常の手段だが、この変数に開始時のキーマップ以外の値を割り当てるべきではない。
</p></blockquote></div><pre class="synopsis"><a id="idm63024464" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-global-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、カレントのグローバルキーマップをリターンする。デフォルトグローバルキーマップとカレントグローバルキーマップのいずれも変更していない場合は、<code class="literal">global-map</code>と同じ値になる。リターン値はコピーではなく参照である。これに<code class="literal">define-key</code>などの関数を使用すると、グローバルバインディングが変更されるだろう。
</p><pre class="screen">(current-global-map)
⇒ (keymap [set-mark-command beginning-of-line …
            delete-backward-char])
</pre></blockquote></div><pre class="synopsis"><a id="idm63020112" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-local-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数はカレントバッファーのローカルキーマップをリターンする。ローカルキーマップがない場合は<code class="literal">nil</code>をリターンする。以下の例では、(Lisp
Interactionモードを使用する)<code class="filename">*scratch*</code>バッファーにたいするキーマップは、<span class="keycap"><strong>ESC</strong></span>(<acronym class="acronym">ASCII</acronym>コード27)にたいするエントリーが別のsparseキーマップであるようなsparseキーマップである。
</p><pre class="screen">(current-local-map)
⇒ (keymap
    (10 . eval-print-last-sexp)
    (9 . lisp-indent-line)
    (127 . backward-delete-char-untabify)
</pre><pre class="screen">    (27 keymap
        (24 . eval-defun)
        (17 . indent-sexp)))
</pre></blockquote></div><p><code class="literal">current-local-map</code>はローカルキーマップのコピーではなく参照をリターンする。これに<code class="literal">define-key</code>などの関数を使用すると、ローカルバインディングが変更されるだろう。
</p><pre class="synopsis"><a id="idm63000784" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-minor-mode-maps</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、カレントで有効なメジャーモードのキーマップリストをリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm62997840" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">use-global-map</code> <em class="replaceable"><code>keymap</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>keymap</code></em>を新たなカレントグローバルキーマップにする。これは<code class="literal">nil</code>をリターンする。
</p><p>グローバルキーマップの変更は、異例である。
</p></blockquote></div><pre class="synopsis"><a id="idm62993360" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">use-local-map</code> <em class="replaceable"><code>keymap</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>keymap</code></em>をカレントバッファーの新たなローカルキーマップにする。<em class="replaceable"><code>keymap</code></em>が<code class="literal">nil</code>の場合、そのバッファーはローカルキーマップをもたない。<code class="literal">use-local-map</code>は<code class="literal">nil</code>をリターンする。ほとんどのメジャーモードコマンドは、この関数を使用する。
</p></blockquote></div><pre class="synopsis"><a id="idm62987856" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">minor-mode-map-alist</code></pre><div class="blockquote"><blockquote class="blockquote"><a id="Definition-of-minor_002dmode_002dmap_002dalist"/><p>この変数は、アクティブかどうかに関わらず、特定の変数の値にたいするキーマップを示すalistである。要素は、以下のようになる:
</p><pre class="screen">(<em class="replaceable"><code>variable</code></em> . <em class="replaceable"><code>keymap</code></em>)
</pre><p>キーマップ<em class="replaceable"><code>keymap</code></em>は、
<em class="replaceable"><code>variable</code></em>が非<code class="literal">nil</code>値をもつときはアクティブである。通常、<em class="replaceable"><code>variable</code></em>はメジャーモードを有効、または無効にする変数である。<a class="link" href="ch23s03.html#Keymaps-and-Minor-Modes" title="Keymaps and Minor Modes">Keymaps
and Minor Modes</a>を参照のこと。
</p><p><code class="literal">minor-mode-map-alist</code>の要素が、<code class="literal">minor-mode-alist</code>の要素と異なる構造をもつことに注意されたい。マップは要素のCDRでなければならず、そうでなければ2つ目の要素にマップリストは用いられないだろう。CDRはキーマップ(リスト)、または関数定義がキーマップであるようなシンボルである。
</p><p>1つ以上のマイナーモードキーマップがアクティブなとき、<code class="literal">minor-mode-map-alist</code>内で前のキーマップが優先される。しかし、互いが干渉しないようにマイナーモードをデザインすべきである。これを正しく行えば、順序は問題にならない。
</p><p>マイナーモードについての詳細な情報は、<a class="link" href="ch23s03.html#Keymaps-and-Minor-Modes" title="Keymaps and Minor Modes">Keymaps and Minor
Modes</a>を参照のこと。<code class="literal">minor-mode-key-binding</code>(see <a class="link" href="ch22s11.html" title="Functions for Key Lookup">Functions for Key
Lookup</a>を参照)も確認されたい。
</p></blockquote></div><pre class="synopsis"><a id="idm62976976" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">minor-mode-overriding-map-alist</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、メジャーモードによる特定のマイナーモードにたいするキーバインディングのオーバーライドを可能にする。このalistの要素は、<code class="literal">minor-mode-map-alist</code>の要素のように、<code class="literal">(<em class="replaceable"><code>variable</code></em>
. <em class="replaceable"><code>keymap</code></em>)</code>のような形式である。
</p><p>ある変数が<code class="literal">minor-mode-overriding-map-alist</code>の要素として出現する場合、その要素により指定されるマップは、<code class="literal">minor-mode-map-alist</code>内の同じ変数にたいして指定される任意のマップを完全に置き換える。
</p><p>すべてのバッファーにおいて、<code class="literal">minor-mode-overriding-map-alist</code>は自動的にバッファーローカルである。
</p></blockquote></div><pre class="synopsis"><a id="idm62957904" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">overriding-local-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>の場合は、バッファーのローカルキーマップ、テキストプロパティまたはoverlayによるキーマップ、マイナーモードキーマップのかわりに使用されるするキーマップを保持する。このキーマップが指定された場合、カレントグローバルキーマップ以外のアクティブだった他のすべてのマップがオーバーライドされる。
</p></blockquote></div><pre class="synopsis"><a id="idm62954704" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">overriding-terminal-local-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>の場合は、<code class="literal">overriding-local-map</code>、バッファーのローカルキーマップ、テキストプロパティまたはoverlayによるキーマップ、およびすべてのマイナーモードキーマップのかわりに使用されるキーマップを保持する。
</p><p>この変数は、カレント端末にたいして常にローカルであり、バッファーローカルにできない。<a class="link" href="ch29s02.html" title="Multiple Terminals">Multiple
Terminals</a>を参照のこと。これはインクリメンタル検索モードの実装に使用される。
</p></blockquote></div><pre class="synopsis"><a id="idm62945872" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">overriding-local-map-menu-flag</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>の場合は、<code class="literal">overriding-local-map</code>または<code class="literal">overriding-terminal-local-map</code>の値がメニューバーの表示に影響し得る。デフォルト値は<code class="literal">nil</code>なので、これらのマップ変数なメニューバーに影響をもたない。
</p><p>これら2つのマップ変数は、たとえこれらの変数がメニューバー表示に影響し得るを与えない場合でも、メニューバーを使用してエンターされたキーシーケンスの実行には影響を与えることに注意されたい。したがって、もしメニューバーキーシーケンスが到着したら、そのキーシーケンスをルックアップ・実行する前に変数をクリアーすべきである。この変数を使用するモードは通常、何らかの方法でこれを行っている。これらのモードは通常“読み戻し(unread)”とexitにより処理されないイベントに応答する。
</p></blockquote></div><pre class="synopsis"><a id="idm62936656" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">special-event-map</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、スペシャルイベントにたいするキーマップを保持する。あるイベント型がこのキーマップ内でバインディングをもつ場合、それはスペシャルであり、そのイベントにたいするバインディングは<code class="literal">read-event</code>により直接実行される。<a class="link" href="ch21s09.html" title="Special Events">Special
Events</a>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm62932944" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">emulation-mode-map-alists</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、エミュレーションモードにたいして使用するキーマップalistのリストを保持する。この変数は、複数マイナーモードキーマップを使用するモードとパッケージを意図している。リストの各要素は<code class="literal">minor-mode-map-alist</code>と同じフォーマットと意味をもつキーマップalistか、そのようなalist形式の変数バインディングをもつシンボルである。それぞれのalist内の“アクティブ”なキーマップは、<code class="literal">minor-mode-map-alist</code>と<code class="literal">minor-mode-overriding-map-alist</code>の前に使用される。
</p></blockquote></div><a id="idm62928976" class="indexterm"/><pre class="synopsis"><a id="idm62927952" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">set-transient-map</code> <em class="replaceable"><code>keymap</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>keep</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<em class="firstterm">一時的(transient)</em>なキーマップとして<em class="replaceable"><code>keymap</code></em>を追加する。一時的なキーマップは1つ以上の後続するキーにたいして、他のキーマップより優先される。
</p><p>通常、<em class="replaceable"><code>keymap</code></em>は直後のキーをルックアップするために、1回だけ使用される。しかし、オプション引数<em class="replaceable"><code>pred</code></em>が<code class="literal">t</code>の場合、そのマップはユーザーが<em class="replaceable"><code>keymap</code></em>内で定義されたキーをタイプするまでアクのままとなる。<em class="replaceable"><code>keymap</code></em>内にないキーをユーザーがタイプしたとき、一時的キーマップは非アクティブとなり、そのキーにたいして通常のキールックアップが継続される。
</p><p><em class="replaceable"><code>pred</code></em>には関数も指定できる。。この場合、<em class="replaceable"><code>keymap</code></em>がアクティブの間は、各コマンドの実行に優先して、その関数が引数なしで呼び出される。<em class="replaceable"><code>keymap</code></em>がアクティブの間、関数は非<code class="literal">nil</code>をリターンすべきである。
</p><p>この関数は、他のすべてのアクティブなキーマップに優先される変数<code class="literal">overriding-terminal-local-map</code>にたいして、<code class="literal">keymap</code>を追加、または削除することにより機能する(<a class="link" href="ch22s08.html" title="Searching the Active Keymaps">Searching
Keymaps</a>を参照)。
</p></blockquote></div></div></body></html>