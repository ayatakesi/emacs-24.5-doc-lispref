<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Reading from Files</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Reading-from-Files"/>Reading from Files</h1></div></div></div><a id="idm63514832" class="indexterm"/><p>ファイルのコンテンツをバッファーにコピーするためには、関数<code class="literal">insert-file-contents</code>を使用しします(マークをセットするので、Lispプログラム内でコマンド<code class="literal">insert-file</code>は使用してはならない)。
</p><pre class="synopsis"><a id="idm63512400" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">insert-file-contents</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>visit</code></em> <em class="replaceable"><code>beg</code></em> <em class="replaceable"><code>end</code></em> <em class="replaceable"><code>replace</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>のコンテンツを、カレントバッファーのポイントの後に挿入する。これは絶対ファイル名と、挿入だれたデータの長さからなるリストをリターンする。<em class="replaceable"><code>filename</code></em>が読み取り可能なファイルの名前でない場合は、エラーがシグナルされる。
</p><p>この関数は、定義されたファイルフォーマットに照らしてファイルのコンテンツをチェックして、適切ならそのコンテンツの変換、およびリスト<code class="literal">after-insert-file-functions</code>内の関数の呼び出しも行う。<a class="link" href="ch25s12.html" title="File Format Conversion">Format
Conversion</a>を参照のこと。通常は、リスト<code class="literal">after-insert-file-functions</code>内のいずれかの関数が、EOL変換を含むファイルコンテンツのデコードに使用される、コーディングシステム(<a class="link" href="ch33s10.html" title="Coding Systems">Coding
Systems</a>を参照)を判断する。しかし、ファイルにnullバイトが含まれる場合、デフォルトではコード変換なしでvisitされる。<a class="link" href="ch33s10.html#Lisp-and-Coding-Systems" title="Coding Systems in Lisp">inhibit-null-byte-detection</a>を参照のこと。
</p><p><em class="replaceable"><code>visit</code></em>が非<code class="literal">nil</code>の場合、この関数は追加でそのバッファーを未変更とマークして、そのバッファーのさまざまなフィールドをセットアップして、バッファーがファイル<em class="replaceable"><code>filename</code></em>をvisitしているようにする。これらのフィールドにはバッファーがvisitしたファイルの名前、最終保存したファイルのmodtimeが含まれる。これらの機能は<code class="literal">find-file-noselect</code>により使用され、恐らくあなた自身が使用するべきではない。
</p><p><em class="replaceable"><code>beg</code></em>および<em class="replaceable"><code>end</code></em>が非<code class="literal">nil</code>の場合、それらはファイル挿入範囲を指定する、バイトオフセット数値であること。この場合、<em class="replaceable"><code>visit</code></em>は<code class="literal">nil</code>でなければならない。たとえば、
</p><pre class="screen">(insert-file-contents filename nil 0 500)
</pre><p>これはファイルの先頭500文字(バイト)を挿入する。
</p><p>引数<em class="replaceable"><code>replace</code></em>が非<code class="literal">nil</code>の場合、それはバッファーのコンテンツ(実際にはアクセス可能な範囲)を、ファイルのコンテンツで置き換えることを意味する。これは単にバッファーのコンテンツを削除してファイル全体を挿入するより優る。なぜなら、(1)マーカー位置を維持し、(2)undoリストに配すデータも少ないからである。
</p><p><em class="replaceable"><code>replace</code></em>と<em class="replaceable"><code>visit</code></em>が<code class="literal">nil</code>であれば、<code class="literal">insert-file-contents</code>で(FIFOやI/Oデバイスのような)スペシャルファイルの読み取りが可能である。
</p></blockquote></div><pre class="synopsis"><a id="idm63494864" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">insert-file-contents-literally</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>visit</code></em> <em class="replaceable"><code>beg</code></em> <em class="replaceable"><code>end</code></em> <em class="replaceable"><code>replace</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<code class="literal">insert-file-contents</code>のように機能するが、<code class="literal">find-file-hook</code>を実行せず、フォーマットのデコード、文字コード変換、自動解凍、...などを行わない点が異なる。
</p></blockquote></div><p>他のプログラムがファイルを読めるように、他のプロセスにファイル名を渡したい場合は、関数<code class="literal">file-local-copy</code>を使用します。<a class="link" href="ch25s11.html" title="Making Certain File Names “Magic”">Magic
File Names</a>を参照してください。
</p></div></body></html>