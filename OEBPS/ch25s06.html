<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Information about Files</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Information-about-Files"/>Information about Files</h1></div></div></div><a id="idm63387856" class="indexterm"/><p>このセクションでは、ファイル(またはディレクトリーやシンボリックリンク)に関して、ファイルが読み込み可能か、書き込み可能か、あるいはファイルのサイズなｍのような、さまざまなタイプの情報を取得する関数を説明します。これらの関数はすべて、引数にファイルの名前を取ります。注記した場合を除き、これらの引数には既存のファイルを指定する必要があり、ファイルが存在しない場合はエラーをシグナルします。
</p><a id="idm63386704" class="indexterm"/><a id="idm63385936" class="indexterm"/><p>スペースで終わるファイル名には気をつけてください。いくつかのファイルシステム(特にMS-Windows)では、ファイル名の末尾の空白文字は、暗黙かつ自動的に無視されます。
</p><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Testing-Accessibility"/>Testing Accessibility</h2></div></div></div><a id="idm63383888" class="indexterm"/><a id="idm63383120" class="indexterm"/><p>以下の関数は、あるファイルを読み取り、書き込み、実行するためのパーミッションをテストします。明示しない限り、これらの関数はファイル名引数にたいするシンボリックリンクを、すべてのレベル(ファイル自身のレベルおよび親ディレクトリーのレベル)において再帰的にフォローします。
</p><p>いくつかのオペレーティングシステムでは、ACL(Access Control Lists:
アクセス制御リスト)のような機構を通じて、より複雑なアクセスパーミッションセットが指定できます。それらのパーミッションにたいする問い合わせやセットの方法については、<a class="link" href="ch25s06.html#Extended-Attributes" title="Extended File Attributes">Extended
Attributes</a>を参照してください。
</p><pre class="synopsis"><a id="idm63376720" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-exists-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル名<em class="replaceable"><code>filename</code></em>が存在しているようなら<code class="literal">t</code>をリターンする。これは、そのファイルが読み取り可能である必要はなく、ファイルの属性を調べることが可能なこと意味する(UnixおよびGNU/Linuではなく、そのファイルが存在し、かつそのファイルを含むディレクトリーの実行パーミッションをもつ場合に<code class="literal">t</code>となり、そのファイル自体のパーミッションは無関係である)。
</p><p>ファイルが存在しない、またはACLポリシーがファイル属性を調べることを禁止する場合、この関数は<code class="literal">nil</code>をリターンする。
</p><p>ディレクトリーはファイルなので、ディレクトリー名が与えられた場合、<code class="literal">file-exists-p</code>は<code class="literal">t</code>をリターンする。しかし、シンボリックリンクは特別に扱われる。<code class="literal">file-exists-p</code>はターゲットファイルが存在する場合のみ、シンボリックリンクにたいして<code class="literal">t</code>をリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm63368784" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-readable-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>filename</code></em>という名前のファイルが存在し、それを読み取ることが可能な場合は<code class="literal">t</code>をリターンする。それ以外は<code class="literal">nil</code>をリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm63364176" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-executable-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>filename</code></em>という名前のファイルが存在し、それを実行することが可能な場合は<code class="literal">t</code>をリターンする。それ以外は<code class="literal">nil</code>をリターンする。UnixおよびGNU/Linuxシステムでは、そのファイルがディレクトリーの場合、実行パーミッションはディレクトリー内のファイルの存在と属性をチェックでき、ファイルのモードが許せばオープンできることを意味する。
</p></blockquote></div><pre class="synopsis"><a id="idm63355472" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-writable-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>filename</code></em>という名前のファイルに書き込み可能、または作成可能可能な場合は<code class="literal">t</code>をリターンする。それ以外は<code class="literal">nil</code>をリターンする。ファイルが存在し、それに書き込むことができるなら、ファイルは書き込み可能である。ファイルが存在せず、指定されたディレクトリーが存在して、そのディレクトリーに書き込むことができるなら、書き込み可能である。
</p><p>以下の例では、<code class="filename">foo</code>は親ディレクトリーが存在しないので、たとえユーザーがそのディレクトリーを作成可能であっても、ファイルは書き込み可能ではない。
</p><pre class="screen">(file-writable-p "~/no-such-dir/foo")
     ⇒ nil
</pre></blockquote></div><pre class="synopsis"><a id="idm63349456" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-accessible-directory-p</code> <em class="replaceable"><code>dirname</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイルとしての名前が<em class="replaceable"><code>dirname</code></em>であるようなディレクトリー内にある既存のファイルをオープンするパーミッションをもつ場合は、<code class="literal">t</code>をリターンする。それ以外(またはそのようなディレクトリーが存在しない場合)は<code class="literal">nil</code>をリターンする。<em class="replaceable"><code>dirname</code></em>の値はディレクトリー名(<code class="filename">/foo/</code>など)、または名前がディレクトリー(最後のスラッシュがない<code class="filename">/foo</code>など)であるようなファイルである。
</p><p>たとえば、以下では<code class="filename">/foo/</code>内の任意のファイルを読み取る試みは、エラーになると推測される:
</p><pre class="screen">(file-accessible-directory-p "/foo")
     ⇒ nil
</pre></blockquote></div><pre class="synopsis"><a id="idm63329744" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">access-file</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>string</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、読み取り用にファイル<em class="replaceable"><code>filename</code></em>をオープンして、クローズした後に<code class="literal">nil</code>をリターンする。しかし、オープンに失敗した場合は、<em class="replaceable"><code>string</code></em>をエラーメッセージのテキストに使用して、エラーをシグナルする。
</p></blockquote></div><pre class="synopsis"><a id="idm63324880" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-ownership-preserved-p</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>group</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>を削除して、それを新たに作成しても、そのファイルの所有者が変更されずに維持される場合は、<code class="literal">t</code>をリターンする。これは、存在しないファイルにたいしても<code class="literal">t</code>をリターンする。
</p><p>オプション引数<em class="replaceable"><code>group</code></em>が非<code class="literal">nil</code>の場合、この関数はファイルのグループが変更されないこともチェックする。
</p><p><em class="replaceable"><code>filename</code></em>がシンボリックリンクの場合は、ここで述べる他の関数と異なり、<code class="literal">file-ownership-preserved-p</code>は<em class="replaceable"><code>filename</code></em>をターゲットで<span class="emphasis"><em>置き換えない</em></span>。しかし、この関数は親ディレクトリーのすべての階層において、シンボリックリンクを再帰的にフォローする(follow:
辿る)。
</p></blockquote></div><pre class="synopsis"><a id="idm63316304" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-modes</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="idm63313744" class="indexterm"/><a id="idm63312976" class="indexterm"/><a id="idm63312208" class="indexterm"/><a id="idm63311440" class="indexterm"/><p>この関数は、<em class="replaceable"><code>filename</code></em>の<em class="firstterm">モードビット(mode
bits)</em>をリターンする。これは読み取り、書き込み、実行パーミッションを要約する整数である。<em class="replaceable"><code>filename</code></em>でのシンボリックリンクは、すべての階層において再帰的にフォローされる。ファイルが存在しない場合のリターン値は<code class="literal">nil</code>である。
</p><p>モードビットの説明は、See section “File permissions” in <em class="citetitle">The GNU
<code class="literal">Coreutils</code>
Manual</em>を参照のこと。たとえば最下位ビットが1なら、そのファイルは実行可能、2ビット目が1なら書き込み可能、...となる。設定できる最大の値は4095(8進の7777)であり、これはすべてのユーザーが読み取り、書き込み、実行のパーミッションをもち、他のユーザーとグループにたいして<acronym class="acronym">SUID</acronym>ビット、およびstickyビットがセットされる。
</p><p>これらのパーミッションのセットに使用される<code class="literal">set-file-modes</code>関数については、<a class="link" href="ch25s07.html" title="Changing File Names and Attributes">Changing
Files</a>を参照のこと。
</p><pre class="screen">(file-modes "~/junk/diffs")
     ⇒ 492               ; 10進整数
</pre><pre class="screen">(format "%o" 492)
     ⇒ "754"             ; 8進に変換した値
</pre><pre class="screen">
</pre><pre class="screen">(set-file-modes "~/junk/diffs" #o666)
     ⇒ nil
</pre><pre class="screen">
</pre><pre class="screen">$ ls -l diffs
-rw-rw-rw- 1 lewis lewis 3063 Oct 30 16:00 diffs
</pre><a id="idm63302992" class="indexterm"/><a id="idm63302224" class="indexterm"/><p><span class="bold"><strong>MS-DOSにたいする注意:</strong></span>
MS-DOSでは、“実行可能”を表すようなファイルのモードビットは存在しない。そのため、<code class="literal">file-modes</code>はファイル名が<code class="filename">.com</code>、<code class="filename">.bat</code>、<code class="filename">.exe</code>などのような標準的な実行可能な拡張子のいずれかで終わる場合は、ファイルを実行可能であると判断する。Unix標準の‘<code class="literal">#!</code>’署名で始まるshellスクリプトやPerlスクリプトも、実行可能と判断される。Unixとの互換性のために、ディレクトリーも実行可能と報告される。<code class="literal">file-attributes</code>(<a class="link" href="ch25s06.html#File-Attributes" title="File Attributes">File
Attributes</a>を参照)も、これらの慣習にしたがう。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Kinds-of-Files"/>Distinguishing Kinds of Files</h2></div></div></div><a id="idm63279696" class="indexterm"/><a id="idm63278928" class="indexterm"/><p>このセクションでは、ディレクトリー、シンボリックリンク、および通常ファイルのような、さまざまな種類のファイルを区別する方法を説明します。
</p><pre class="synopsis"><a id="idm63277520" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-symlink-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="idm63274960" class="indexterm"/><p>ファイル<em class="replaceable"><code>filename</code></em>がシンボリックリンクの場合、<code class="literal">file-symlink-p</code>関数は(非再帰的な)リンクターゲットを文字列としてリターンする(リンクターゲット文字列は、そのターゲットの完全な絶対ファイル名である必要はない。リンクが指すのが完全なファイル名か判断するのは、簡単な処理ではない。以下を参照されたい)。<em class="replaceable"><code>filename</code></em>のディレクトリー部分(leading
directory)にシンボリックリンクが含まれる場合、この関数はそれらを再帰的にフォローする。
</p><p>ファイル<em class="replaceable"><code>filename</code></em>がシンボリックリンクではない、または存在しない場合、<code class="literal">file-symlink-p</code>は<code class="literal">nil</code>をリターンする。
</p><p>この関数の使用例をいくつか示す:
</p><pre class="screen">(file-symlink-p "not-a-symlink")
     ⇒ nil
</pre><pre class="screen">(file-symlink-p "sym-link")
     ⇒ "not-a-symlink"
</pre><pre class="screen">(file-symlink-p "sym-link2")
     ⇒ "sym-link"
</pre><pre class="screen">(file-symlink-p "/bin")
     ⇒ "/pub/bin"
</pre><p>3つ目の例では、関数は<code class="filename">sym-link</code>をリターンするものの、たとえそれ自体がシンボリックリンクであっても、リンク先の解決を行わないことに注意されたい。これが上述した“非再帰的(non-recursive)”の意味するところであり、シンボリックリンクをフォローする処理は、そのリンクターゲット自体がリンクの場合、再帰的には行われない。
</p><p>この関数がリターンするのは、そのシンボリックリンクに何が記録されているかを示す文字列であり、それにはディレクトリー部分が含まれていても、いなくても構わない。この関数は完全修飾されたファイル名を生成するためにリンクターゲットを<span class="emphasis"><em>展開しない</em></span>し、リンクターゲットが絶対ファイル名でなければ、(もしあっても)<em class="replaceable"><code>filename</code></em>引数のディレクトリー部分は使用しない。以下に例を示す:
</p><pre class="screen">(file-symlink-p "/foo/bar/baz")
     ⇒ "some-file"
</pre><p>ここでは、たとえ与えられた<code class="filename">/foo/bar/baz</code>が完全修飾されたファイル名であるにも関わらず、その結果は異なり、実際には何のディレクトリー部分ももたない。<code class="filename">some-file</code>自体がシンボリックリンクかもしれないので、単にその前に先行ディレクトリーを追加することはできず、絶対ファイル名を生成するために、単に<code class="literal">expand-file-name</code>(<a class="link" href="ch25s08.html#File-Name-Expansion" title="Functions that Expand Filenames">File
Name Expansion</a>を参照)を使用することもできないからである。
</p><p>この理由により、あるファイルがシンボリックリンクか否かという単一の事実よりも多くを判定する必要がある場合に、この関数が有用であることは稀である。実際にリンクターゲットのファイル名が必要な場合は、<a class="link" href="ch25s06.html#Truenames" title="Truenames">Truenames</a>で説明する<code class="literal">file-chase-links</code>または<code class="literal">file-truename</code>を使用すること。
</p></blockquote></div><p>以下の2つの関数は、<em class="replaceable"><code>filename</code></em>にたいして、シンボリックリンクを全階層において再帰的にフォローする。
</p><pre class="synopsis"><a id="idm63260752" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-directory-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>filename</code></em>が既存のディレクトリー名なら<code class="literal">t</code>、それ以外は<code class="literal">nil</code>をリターンする。
</p><pre class="screen">(file-directory-p "~rms")
     ⇒ t
</pre><pre class="screen">(file-directory-p "~rms/lewis/files.texi")
     ⇒ nil
</pre><pre class="screen">(file-directory-p "~rms/lewis/no-such-file")
     ⇒ nil
</pre><pre class="screen">(file-directory-p "$HOME")
     ⇒ nil
</pre><pre class="screen">(file-directory-p
 (substitute-in-file-name "$HOME"))
     ⇒ t
</pre></blockquote></div><pre class="synopsis"><a id="idm63253840" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-regular-p</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>が存在し、かつそれが通常ファイル(ディレクトリー、名前付きパイプ、端末、その他I/Oデバイス以外)の場合は<code class="literal">t</code>をリターンする。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Truenames"/>Truenames</h2></div></div></div><a id="idm63248976" class="indexterm"/><p>ファイルの<em class="firstterm">実名(truename)</em>とは、全階層においてシンボリックリンクを残らずフォローした後、名前コンポーネントに出現する‘<code class="literal">.</code>’と‘<code class="literal">..</code>’を除いて簡略化した名前のことです。これは、そのファイルにたいする正規名(canonical
name)の一種です。ファイルが常に一意な実名をもつ訳ではありません。あるファイルにたいする異なる実名の個数は、そのファイルにたいするハードリンクの個数と同じです。しかし、実名はシンボリックリンクによる名前の変動を解消するのに有用です。
</p><pre class="synopsis"><a id="idm63233872" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-truename</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>の実名をリターンする。引数が絶対ファイル名でない場合、この関数は最初に<code class="literal">default-directory</code>にたいしてこれを展開する。
</p><p>この関数は、環境変数を展開しない。これを行うのは<code class="literal">substitute-in-file-name</code>だけである。<a class="link" href="ch25s08.html#Definition-of-substitute_002din_002dfile_002dname">Definition
of substitute-in-file-name</a>を参照のこと。
</p><p>名前コンポーネントに出現する‘<code class="literal">..</code>’に先行するシンボリックリンクリンクをフォローする必要がある場合は、直接間接を問わず<code class="literal">expand-file-name</code>を呼び出す前に、<code class="literal">file-truename</code>を呼び出すこと。そうしないと、‘<code class="literal">..</code>’の直前にある名前コンポーネントは、<code class="literal">file-truename</code>が呼び出される前に“簡略化”により取り除かれてしまう。<code class="literal">expand-file-name</code>呼び出しの必要を無くすため、<code class="literal">file-truename</code>は<code class="literal">expand-file-name</code>が行うのと同じ方法で‘<code class="literal">~</code>’を扱う。<a class="link" href="ch25s08.html#File-Name-Expansion" title="Functions that Expand Filenames">Functions that Expand Filenames</a>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm63214672" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-chase-links</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>limit</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>filename</code></em>で始まるシンボリックリンクを、シンボリックリンクではない名前のファイル名までフォローして、そのファイル名をリターンする。この関数は、親ディレクトリーの階層にあるシンボリックリンクをフォロー<span class="emphasis"><em>しない</em></span>。
</p><p><em class="replaceable"><code>limit</code></em>に数を指定した場合は、その数のリンクを追跡した後、この関数はたとえそれが依然としてシンボリックリンクであっても、それをリターンする。
</p></blockquote></div><p><code class="literal">file-chase-links</code>と<code class="literal">file-truename</code>の違いを説明するために、<code class="filename">/usr/foo</code>がディレクトリー<code class="filename">/home/foo</code>へのシンボリックリンクであり、<code class="filename">/home/foo/hello</code>が(少なくともシンボリックリンクではない)通常ファイル、または存在しないファイルであるとします。この場合は以下のようになります:
</p><pre class="screen">(file-chase-links "/usr/foo/hello")
     ;; 親ディレクトリーのリンクはフォローしない
     ⇒ "/usr/foo/hello"
(file-truename "/usr/foo/hello")
     ;; <code class="filename">/home</code>はシンボリックリンクではないと仮定
     ⇒ "/home/foo/hello"
</pre><pre class="synopsis"><a id="idm63205328" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-equal-p</code> <em class="replaceable"><code>file1</code></em> <em class="replaceable"><code>file2</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>file1</code></em>と<em class="replaceable"><code>file2</code></em>の名前が同じファイルの場合は<code class="literal">t</code>をリターンする。これは、リモートファイル名も適切な方法で処理することを除き、実名の比較と似ている。<em class="replaceable"><code>file1</code></em>または<em class="replaceable"><code>file2</code></em>が存在しない場合、リターン値は不定である。
</p></blockquote></div><pre class="synopsis"><a id="idm63199696" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-in-directory-p</code> <em class="replaceable"><code>file</code></em> <em class="replaceable"><code>dir</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>file</code></em>がディレクトリー<em class="replaceable"><code>dir</code></em>内のファイル、またはサブディレクトリーの場合は、<code class="literal">t</code>をリターンする。また、<em class="replaceable"><code>file</code></em>と<em class="replaceable"><code>dir</code></em>が同じディレクトリーの場合も、<code class="literal">t</code>をリターンする。この関数は、2つのディレクトリーの実名を比較する。<em class="replaceable"><code>dir</code></em>が既存のディレクトリーの名前でない場合、リターン値は<code class="literal">nil</code>である。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="File-Attributes"/>File Attributes</h2></div></div></div><a id="idm63191888" class="indexterm"/><p>このセクションでは、ファイルの詳細な情報を取得する関数について説明します。それらの情報にはファイルの所有者やグループの番号、ファイル名の個数、inode番号、サイズやアクセス日時、変更日時が含まれます。
</p><pre class="synopsis"><a id="idm63190480" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-newer-than-file-p</code> <em class="replaceable"><code>filename1</code></em> <em class="replaceable"><code>filename2</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="idm63187536" class="indexterm"/><a id="idm63186768" class="indexterm"/><p>この関数は、ファイル<em class="replaceable"><code>filename1</code></em>がファイル<em class="replaceable"><code>filename2</code></em>より新しい場合は、<code class="literal">t</code>をリターンする。<em class="replaceable"><code>filename1</code></em>が存在しない場合は<code class="literal">nil</code>、<em class="replaceable"><code>filename1</code></em>は存在するが<em class="replaceable"><code>filename2</code></em>が存在しない場合は<code class="literal">t</code>をリターンする。
</p><p>以下の例では、<code class="filename">aug-19</code>が19日、<code class="filename">aug-20</code>が20日に書き込まれ、ファイル<code class="filename">no-file</code>は存在しないものとする。
</p><pre class="screen">(file-newer-than-file-p "aug-19" "aug-20")
     ⇒ nil
</pre><pre class="screen">(file-newer-than-file-p "aug-20" "aug-19")
     ⇒ t
</pre><pre class="screen">(file-newer-than-file-p "aug-19" "no-file")
     ⇒ t
</pre><pre class="screen">(file-newer-than-file-p "no-file" "aug-19")
     ⇒ nil
</pre></blockquote></div><p>以下の2つの関数の<em class="replaceable"><code>filename</code></em>引数がシンボリックリンクの場合、これらの関数はそれをリンクターゲットで<span class="emphasis"><em>置き換えません</em></span>。しかしどちらの関数も、親ディレクトリーのすべての階層において、シンボリックリンクを再帰的にフォローします。
</p><pre class="synopsis"><a id="idm63177040" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-attributes</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>id-format</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="Definition-of-file_002dattributes"/><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>の属性(attributes)のリストをリターンする。オープンできないファイルが指定された場合は、<code class="literal">nil</code>をリターンする。オプション引数<em class="replaceable"><code>id-format</code></em>は、属性<acronym class="acronym">UID</acronym>および<acronym class="acronym">GID</acronym>(以下参照)にたいして望ましいフォーマットを指定し、有効な値は<code class="literal">'string</code>および<code class="literal">'integer</code>である。デフォルトは<code class="literal">'integer</code>だが、わたしたちはこれの変更を計画しているので、リターンされる<acronym class="acronym">UID</acronym>または<acronym class="acronym">GID</acronym>を使用する場合は、<em class="replaceable"><code>id-format</code></em>にたいして非<code class="literal">nil</code>値を指定するべきである。
</p><p>リストの要素は順に:
</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>ディレクトリーにたいしては<code class="literal">t</code>、シンボリックリンクにたいしては文字列(リンクされる名前)、テキストファイルにたいしては<code class="literal">nil</code>。
</p></li><li class="listitem"><p>そのファイルがもつ名前の個数。ハードリンクとして知られる代替え名は、関数<code class="literal">add-name-to-file</code>を使用して作成できる(<a class="link" href="ch25s07.html" title="Changing File Names and Attributes">Changing
Files</a>を参照)。
</p></li><li class="listitem"><p>ファイルの<acronym class="acronym">UID</acronym>で、通常は文字列。しかし、名前をもつユーザーに対応しない場合、値は整数。
</p></li><li class="listitem"><p>同様に、ファイルの<acronym class="acronym">GID</acronym>。
</p></li><li class="listitem"><p>最終アクセス時刻を表す、4つの整数<code class="literal">(<em class="replaceable"><code>sec-high</code></em> <em class="replaceable"><code>sec-low</code></em> <em class="replaceable"><code>microsec</code></em>
<em class="replaceable"><code>picosec</code></em>)</code>からなるリスト(これは<code class="literal">current-time</code>の値と似ている。<a class="link" href="ch39s05.html" title="Time of Day">Time of
Day</a>を参照されたい)。いくつかのFATベースのファイルシステムでは、最終アクセスの日付だけが記録されるので、この時刻には常に最終アクセス日の真夜中が保持されることに注意。
</p></li><li class="listitem"><a id="idm63157968" class="indexterm"/><p>最終変更時刻を表す4つの整数からなるリスト(上記参照)。これは、ファイルのコンテンツが変更された最終時刻である。
</p></li><li class="listitem"><p>ステータスの最終変更時刻を表す4つの整数からなるリスト(上記参照)。これはファイルのアクセスモードビット、所有者とグループ、およびファイルにたいしてファイルのコンテンツ以外にファイルシステムが記録するその他の情報にたいする最終変更時刻である。
</p></li><li class="listitem"><p>ファイルのサイズ(バイト)。Lisp整数の範囲を超える大きさのサイズでは浮動小数点数。
</p></li><li class="listitem"><p>‘<code class="literal">ls -l</code>’で表示されるような、10個の文字、またはダッシュからなる文字列で表されるファイルのモード。
</p></li><li class="listitem"><p>後方互換のために提供される不定値。
</p></li><li class="listitem"><p>ファイルのinode番号。可能な場合は整数。Emacs
Lispの整数として表せる範囲より大きいinode番号は、整数で表現可能な値を得るために<span class="mathphrase">2^{16}</span>で除され<code class="literal">(<em class="replaceable"><code>high</code></em>
.
<em class="replaceable"><code>low</code></em>)</code>という形式の値になる。ここで<em class="replaceable"><code>low</code></em>は下位16ビットである。それにたいしてさえinode番号が大きい場合、値は<code class="literal">(<em class="replaceable"><code>high</code></em>
<em class="replaceable"><code>middle</code></em>
.
<em class="replaceable"><code>low</code></em>)</code>という形式になる。ここで<code class="literal">high</code>は上位ビット、<em class="replaceable"><code>middle</code></em>は中位24ビット、<em class="replaceable"><code>low</code></em>は下位16ビットを保持する。
</p></li><li class="listitem"><p>そのファイルがあるデバイスのファイルシステム番号。その大きさにより、値は整数、またはinode番号と同じ様式のコンスセルとなる。この要素とファイルのinode番号を併せれば、システム上の2つを区別するに足る情報が得られる(2つのファイルがこれら両方の番号で同じ値をもつことはできない)。
</p></li></ol></div><p>たとえば、以下は<code class="filename">files.texi</code>のファイル属性である:
</p><pre class="screen">(file-attributes "files.texi" 'string)
     ⇒  (nil 1 "lh" "users"
          (20614 64019 50040 152000)
          (20000 23 0 0)
          (20614 64555 902289 872000)
          122295 "-rw-rw-rw-"
          t (5888 2 . 43978)
          (15479 . 46724))
</pre><p>この結果を解釈すると:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nil</code>
</span></dt><dd><p>ディレクトリーでもシンボリックリンクでもない。
</p></dd><dt><span class="term"><code class="literal">1</code>
</span></dt><dd><p>(カレントデフォルトディレクトリー内で名前<code class="filename">files.texi</code>は)単一の名前をもつ。
</p></dd><dt><span class="term"><code class="literal">"lh"</code>
</span></dt><dd><p>名前"lh"のユーザーにより所有される。
</p></dd><dt><span class="term"><code class="literal">"users"</code>
</span></dt><dd><p>名前"users"のグループ。
</p></dd><dt><span class="term"><code class="literal">(20614 64019 50040 152000)</code>
</span></dt><dd><p>最終アクセスがOctober 23, 2012, at 20:12:03.050040152 UTC。
</p></dd><dt><span class="term"><code class="literal">(20000 23 0 0)</code>
</span></dt><dd><p>最終更新がJuly 15, 2001, at 08:53:43 UTC。
</p></dd><dt><span class="term"><code class="literal">(20614 64555 902289 872000)</code>
</span></dt><dd><p>最終ステータス変更がOctober 23, 2012, at 20:20:59.902289872 UTC。
</p></dd><dt><span class="term"><code class="literal">122295</code>
</span></dt><dd><p>バイト長は122295バイト(しかしマルチバイトシーケンスが含まれていたり、EOLフォーマットがCRLFの場合は122295文字が含まれないだろう)。
</p></dd><dt><span class="term"><code class="literal">"-rw-rw-rw-"</code>
</span></dt><dd><p>所有者、グループ、その他にたいして読み取り、書き込みアクセスのモードをもつ。
</p></dd><dt><span class="term"><code class="literal">t</code>
</span></dt><dd><p>単なるプレースホルダーであり、何の情報ももたない。
</p></dd><dt><span class="term"><code class="literal">(5888 2 . 43978)</code>
</span></dt><dd><p>inode番号は6473924464520138。
</p></dd><dt><span class="term"><code class="literal">(15479 . 46724)</code>
</span></dt><dd><p>ファイルシステムのデバイス番号は1014478468。
</p></dd></dl></div></blockquote></div><pre class="synopsis"><a id="idm67246032" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-nlinks</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>がもつ名前(ハードリンク)の個数をリターンする。ファイルが存在しない場合、この関数は<code class="literal">nil</code>をリターンする。シンボリックリンクは、リンク先のファイルの名前とは判断されないので、この関数に影響しないことに注意。
</p><pre class="screen">$ ls -l foo*
-rw-rw-rw- 2 rms rms 4 Aug 19 01:27 foo
-rw-rw-rw- 2 rms rms 4 Aug 19 01:27 foo1
</pre><pre class="screen">
</pre><pre class="screen">(file-nlinks "foo")
     ⇒ 2
</pre><pre class="screen">(file-nlinks "doesnt-exist")
     ⇒ nil
</pre></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Extended-Attributes"/>Extended File Attributes</h2></div></div></div><a id="idm67227088" class="indexterm"/><p>いくつかのオペレーティングシステムでは、それぞれのファイルを任意の<em class="firstterm">拡張ファイル属性(extended file
attributes)</em>に関連付けることができます。現在のところ、Emacsは拡張ファイル属性のうち2つの特定セット(ACL: Access
Control
List、およびSELinuxコンテキスト)にたいする問い合わせと設定をサポートします。これらの拡張ファイル属性は、前のセクションで議論した“Unixスタイル”の基本的なパーミッションより洗練されたファイルアクセス制御を強いるために、いくつかのシステムで利用されます。
</p><a id="idm67225552" class="indexterm"/><a id="idm67224784" class="indexterm"/><a id="idm67224016" class="indexterm"/><p>ACLとSELinuxについての詳細な解説は、このマニュアルの範囲を超えます。わたしたちの目的のためには、それぞれのファイルは<em class="firstterm">ACL</em>(ACLベースのファイル制御システムの元でACLのプロパティを指定)および/または<em class="firstterm">SELinuxコンテキスト</em>(SELinuxシステムの元でSELinuxのプロパティを指定)に割り当てることができる、という理解でよいでしょう。
</p><pre class="synopsis"><a id="idm67221840" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-acl</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>にたいするACLをリターンする。ACLにたいする正確なLisp表現は不確定(かつ将来のEmacsバージョンで変更され得る)だが、これは<code class="literal">set-file-acl</code>が引数<em class="replaceable"><code>acl</code></em>にとる値と同じである(<a class="link" href="ch25s07.html" title="Changing File Names and Attributes">Changing
Files</a>を参照)。
</p><p>根底にあるACL実装はプラットフォーム固有である。EmacsはGNU/LinuxおよびBSDではPOSIX
ACLインターフェイスを使用し、MS-WindowsではネイティブのファイルセキュリティAPIをPOSIX ACLインターフェイスでエミュレートする。
</p><p>ACLサポートなしでEmacsがコンパイルされた場合、ファイルが存在しないかアクセス不能な場合、またはその他の理由によりEmacsがACLエントリーを判断できない場合、リターン値は<code class="literal">nil</code>である。
</p></blockquote></div><pre class="synopsis"><a id="idm67215568" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-selinux-context</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ファイル<em class="replaceable"><code>filename</code></em>のSELinuxコンテキストを、<code class="literal">(<em class="replaceable"><code>user</code></em> <em class="replaceable"><code>role</code></em>
<em class="replaceable"><code>type</code></em>
<em class="replaceable"><code>range</code></em>)</code>という形式のリストでリターンする。リストの要素は、そのコンテキストのユーザー、ロール、タイプ、レンジを文字列として表す値である。これらの実際の意味についての詳細は、SELinuxのドキュメントを参照のこと。リターン値は、<code class="literal">set-file-selinux-context</code>が<em class="replaceable"><code>context</code></em>引数でとるのと同じ形式である(<a class="link" href="ch25s07.html" title="Changing File Names and Attributes">Changing
Files</a>を参照)。
</p><p>SELinuxサポートなしでEmacsがコンパイルされた場合、ファイルが存在しないかアクセス不能な場合、またはシステムがSELinuxをサポートしない場合、リターン値は<code class="literal">(nil
nil nil nil)</code>である。
</p></blockquote></div><pre class="synopsis"><a id="idm67207632" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">file-extended-attributes</code> <em class="replaceable"><code>filename</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、Emacsが認識するファイル<em class="replaceable"><code>filename</code></em>の拡張属性をalistでリターンする。現在のところ、この関数はACLとSELinuxの両方を取得するための便利な方法としての役目を果たす。他のファイルに同じファイルアクセス属性を適用するために、リターンされたalistを2つ目の引数として<code class="literal">set-file-extended-attributes</code>を呼び出すことができる(<a class="link" href="ch25s07.html" title="Changing File Names and Attributes">Changing
Files</a>を参照)。
</p><p>要素のうちの1つは<code class="literal">(acl
. <em class="replaceable"><code>acl</code></em>)</code>で、<em class="replaceable"><code>acl</code></em>は<code class="literal">file-acl</code>がリターンするのと同じ形式である。
</p><p>他の要素は<code class="literal">(selinux-context
.
<em class="replaceable"><code>context</code></em>)</code>で、<em class="replaceable"><code>context</code></em>は<code class="literal">file-selinux-context</code>がリターンするのと同じ形式である。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Locating-Files"/>Locating Files in Standard Places</h2></div></div></div><a id="idm67177424" class="indexterm"/><a id="idm67176656" class="indexterm"/><p>このセクションでは、ディレクトリーのリスト(<em class="firstterm">パス(path)</em>)からファイルを検索したり、標準の実行可能ファイル用ディレクトリーから実行可能ファイルを検索する方法を説明します。
</p><p>ユーザー固有の設定ファイル(configuration file)の検索については、<a class="link" href="ch25s08.html#Standard-File-Names" title="Standard File Names">Standard File
Names</a>の関数<code class="literal">locate-user-emacs-file</code>を参照してください。
</p><pre class="synopsis"><a id="idm67173456" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">locate-file</code> <em class="replaceable"><code>filename</code></em> <em class="replaceable"><code>path</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>suffixes</code></em> <em class="replaceable"><code>predicate</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>path</code></em>で与えられるディレクトリーリスト内で、<em class="replaceable"><code>filename</code></em>という名前のファイルを検索して、<em class="replaceable"><code>suffixes</code></em>内のサフィックスの検索を試みる。そのようなファイルが見つかった場合はファイルの絶対ファイル名(<a class="link" href="ch25s08.html#Relative-File-Names" title="Absolute and Relative File Names">Relative
File Names</a>を参照)をリターンし、それ以外は<code class="literal">nil</code>をリターンする。
</p><p>オプション引数<em class="replaceable"><code>suffixes</code></em>は、検索時に<em class="replaceable"><code>filename</code></em>に追加するファイル名サフィックスのリストを与える。<code class="literal">locate-file</code>は、検索するディレクトリーごとに、それらのサフィックスを試みる。<em class="replaceable"><code>suffixes</code></em>が<code class="literal">nil</code>、または<code class="literal">("")</code>の場合は、サフィックスなしで、<em class="replaceable"><code>filename</code></em>だけがそのまま使用される。<em class="replaceable"><code>suffixes</code></em>の典型的な値は<code class="literal">exec-suffixes</code>(<a class="link" href="ch37.html#Subprocess-Creation" title="Functions that Create Subprocesses">Subprocess
Creation</a>を参照)、<code class="literal">load-suffixes</code>、<code class="literal">load-file-rep-suffixes</code>、および関数<code class="literal">get-load-suffixes</code>(<a class="link" href="ch16s02.html" title="Load Suffixes">Load
Suffixes</a>を参照)である。
</p><p>実行可能プログラムを探すときは<code class="literal">exec-path</code>(<a class="link" href="ch37.html#Subprocess-Creation" title="Functions that Create Subprocesses">Subprocess
Creation</a>を参照)、Lispファイルを探すときは<code class="literal">load-path</code>(<a class="link" href="ch16s03.html" title="Library Search">Library
Search</a>を参照)が<em class="replaceable"><code>path</code></em>の典型的な値である。<em class="replaceable"><code>filename</code></em>が絶対ファイル名の場合、<em class="replaceable"><code>path</code></em>は効果がないが、サフィックスにたいする<em class="replaceable"><code>suffixes</code></em>は依然として試行される。
</p><p>オプション引数<em class="replaceable"><code>predicate</code></em>が非<code class="literal">nil</code>の場合、それは候補ファイルが適切かどうかテストする述語関数を指定する。述語関数には、単一の引数として候補ファイル名が渡される。<em class="replaceable"><code>predicate</code></em>が<code class="literal">nil</code>、または省略された場合は、述語として<code class="literal">file-readable-p</code>を使用する。<code class="literal">file-executable-p</code>や<code class="literal">file-directory-p</code>など、その他の有用な述語については、<a class="link" href="ch25s06.html#Kinds-of-Files" title="Distinguishing Kinds of Files">Kinds
of Files</a>を参照のこと。
</p><p>互換性のために、<em class="replaceable"><code>predicate</code></em>には<code class="literal">executable</code>、<code class="literal">readable</code>、<code class="literal">writable</code>、<code class="literal">exists</code>、またはこれらシンボルの1つ以上のリストも指定できる。
</p></blockquote></div><pre class="synopsis"><a id="idm67140432" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">executable-find</code> <em class="replaceable"><code>program</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>program</code></em>という名前の実行可能ファイルを検索して、その実行可能ファイルの絶対ファイル名と、もしあればファイル名の拡張子も含めてリターンする。ファイルが見つからない場合は、<code class="literal">nil</code>をリターンする。この関数は、<code class="literal">exec-path</code>内のすべてのディレクトリーを検索し、<code class="literal">exec-suffixes</code>内のすべてのファイル名拡張子の検索も試みる(<a class="link" href="ch37.html#Subprocess-Creation" title="Functions that Create Subprocesses">Subprocess
Creation</a>を参照)。
</p></blockquote></div></div></div></body></html>