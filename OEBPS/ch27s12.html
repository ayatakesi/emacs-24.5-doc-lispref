<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Swapping Text Between Two Buffers</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Swapping-Text"/>Swapping Text Between Two Buffers</h1></div></div></div><a id="idm69345744" class="indexterm"/><a id="idm69344976" class="indexterm"/><p>特別なモードでは、ユーザーが同一のバッファーから複数の非常に異なったテキストにアクセスできるようにしなければならない場合があります。たとえば、バッファーのテキストのサマリーを表示して、ユーザーがそのテキストにアクセスできるようにする場合です。
</p><p>これは、(ユーザーがテキストを編集した際には同期を保つ)複数バッファーや、ナローイング(<a class="link" href="ch30s04.html" title="Narrowing">Narrowing</a>を参照)により実装することができるかもしれません。しかし、これらの候補案はときに退屈になりがちであり、特にそれぞれのテキストタイプが正しい表示と編集コマンドを提供するために高価なバッファーグローバル操作を要求する場合には、飛び抜けて高価になる場合があります。
</p><p>Emacsは、そのようなモードにたいする、別の機能を提供します。<code class="literal">buffer-swap-text</code>を使用すれば、2つのバッファー間でバッファーテキストを素早く交換することができます。この関数は、テキストの移動は行わず、異なるテキスト塊(text
chunk)をポイントするように、バッファーオブジェクトの内部的なデータ構造だけを変更するので、非常に高速です。これを使用することにより、2つ以上のバッファーグループから、個々のバッファーのコンテンツすべてを併せもつような、単一の仮想バッファー(virtual
buffer)が実在するように、見せかけることができます。
</p><pre class="synopsis"><a id="idm69341648" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">buffer-swap-text</code> <em class="replaceable"><code>buffer</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、カレントバッファーのテキストと、引数<em class="replaceable"><code>buffer</code></em>のテキストを交換する。2つのバッファーのいずれか一方がインダイレクトバッファー(<a class="link" href="ch27s11.html" title="Indirect Buffers">Indirect
Buffers</a>を参照)、またはインダイレクトバッファーのベースバッファーの場合は、エラーをシグナルする。
</p><p>バッファーテキストに関連するすべてのバッファープロパティ、つまりポイントとマークの位置、すべてのマーカーとオーバーレイ、テキストプロパティ、アンドゥリスト、<code class="literal">enable-multibyte-characters</code>フラグの値(<a class="link" href="ch33.html#Text-Representations" title="Text Representations">enable-multibyte-characters</a>を参照)等も、同じように交換される。
</p></blockquote></div><p>ファイルをvisitしているバッファーに<code class="literal">buffer-swap-text</code>を使用した場合は、交換されたテキストではなく、そのバッファーの元のテキストを保存するようにフックをセットアップするべきです。<code class="literal">write-region-annotate-functions</code>は、正にこの目的のために機能します。そのバッファーの<code class="literal">buffer-saved-size</code>を、おそらく交換されたテキストにたいする変更が自動保存に干渉しないであろう、−2にセットするべきでしょう。
</p></div></body></html>