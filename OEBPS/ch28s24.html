<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Window Configurations</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Window-Configurations"/>Window Configurations</h1></div></div></div><a id="idm71382864" class="indexterm"/><a id="idm71382096" class="indexterm"/><p><em class="firstterm">ウィンドウ構成(window configuration)</em>とは1つのフレーム上全体のレイアウト —
すべてのウィンドウ、およびそれらのサイズ、どんなバッファーを含んでいるか、それらのバッファーがスクロールされる方法、ポイント値とマーク値を記録し、フリンジ、マージン、スクロールバーのセッティングも記録します。これには<code class="literal">minibuffer-scroll-window</code>の値も含まれます。特別な例外として、ウィンドウ構成には選択されたウィンドウのカレントバッファーのポイント値は記録されません。
</p><p>以前に保存されたウィンドウ構成をリストアすることにより、フレーム全体のレイアウトを取り戻すことができます。1つだけではなくすべてのフレームのレイアウトを記録したい場合は、ウィンドウ構成のかわりに、フレーム構成(frame
configuration)を使用します。<a class="link" href="ch29s12.html" title="Frame Configurations">Frame Configurations</a>を参照してください。
</p><pre class="synopsis"><a id="idm71379024" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-window-configuration</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>frame</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>frame</code></em>のカレントのウィンドウ構成を表す新たなオブジェクトをリターンする。<em class="replaceable"><code>frame</code></em>のデフォルトは選択されたフレームである。変数<code class="literal">window-persistent-parameters</code>は、この関数により保存されるウィンドウパラメーター(もしあれば)を指定する。<a class="link" href="ch28s25.html" title="Window Parameters">Window
Parameters</a>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm71369552" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">set-window-configuration</code> <em class="replaceable"><code>configuration</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>configuration</code></em>が作成されたフレームにたいして、ウィンドウとバッファーの構成を<em class="replaceable"><code>configuration</code></em>で指定された構成にリストアする。
</p><p>引数<em class="replaceable"><code>configuration</code></em>は、以前に<code class="literal">current-window-configuration</code>がリターンした値でなければならない。この構成は、そのフレームが選択されているか否かに関わらず、<em class="replaceable"><code>configuration</code></em>が作成時のフレームから、当該フレームにリストアされる。これは常にウィンドウのサイズ変更とみなされ、<code class="literal">window-size-change-functions</code>(<a class="link" href="ch28s26.html" title="Hooks for Window Scrolling and Changes">Window
Hooks</a>を参照)の実行をトリガーする。なぜなら、<code class="literal">set-window-configuration</code>は、新たな構成が古い構成と実際に異なるかを示す方法を知らないからである。
</p><p><em class="replaceable"><code>configuration</code></em>が保存されたフレームが死んでいる(生きていない)場合、この関数が行うのは3つの変数<code class="literal">window-min-height</code>、<code class="literal">window-min-width</code>、<code class="literal">minibuffer-scroll-window</code>のリストアだけである。この場合、関数は<code class="literal">nil</code>をリターンし、それ以外は<code class="literal">t</code>をリターンする。
</p><p>以下は、<code class="literal">save-window-excursion</code>と同様な効果を得るためにこの関数を使用する例である:
</p><pre class="screen">(let ((config (current-window-configuration)))
  (unwind-protect
      (progn (split-window-below nil)
             …)
    (set-window-configuration config)))
</pre></blockquote></div><pre class="synopsis"><a id="idm71357648" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">save-window-excursion</code> <em class="replaceable"><code>forms</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このマクロは、選択されたフレームのウィンドウ構成を記録して、<em class="replaceable"><code>forms</code></em>を順に実行してから、以前のウィンドウ構成をリストアする。リターン値は、<em class="replaceable"><code>forms</code></em>内の最後のフォームの値である。
</p><p>Lispコードのほとんどは、このマクロを使用すべきではない。大抵は<code class="literal">save-selected-window</code>で十分である。特に、このマクロは<em class="replaceable"><code>forms</code></em>内で新たなウィンドウをオープンするコードを確実に防ぐことができず、新たなウィンドウは別のフレーム内でオープンされるかもしれないが(<a class="link" href="ch28s12.html" title="Choosing a Window for Display">Choosing
Window</a>を参照)、<code class="literal">save-window-excursion</code>が保存およびリストアするのは、カレントフレーム上のウィンドウ構成だけだからである。
</p><p>このマクロを<code class="literal">window-size-change-functions</code>内で使用してはならない。このマクロをexitすることにより<code class="literal">window-size-change-functions</code>の実行がトリガーされるが、これは無限ループを引き起こす。
</p></blockquote></div><pre class="synopsis"><a id="idm71349584" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">window-configuration-p</code> <em class="replaceable"><code>object</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>object</code></em>がウィンドウ構成なら<code class="literal">t</code>をリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm71345488" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">compare-window-configurations</code> <em class="replaceable"><code>config1</code></em> <em class="replaceable"><code>config2</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ポイント値、マーク値、保存されたスクロール位置を無視して(これらの観点が異なっても<code class="literal">t</code>をリターンし得る)、ウィンドウ構造の観点から2つのウィンドウ構成を比較する。
</p><p>関数<code class="literal">equal</code>も2つのウィンドウ構成を比較できる。これはすべての点から、たとえ1つでも異なるものがあれば等しい構成とはみなさず、たとえ保存されたポイント値やマーク値が異なるだけでも、等しくないとみなす。
</p></blockquote></div><pre class="synopsis"><a id="idm71336400" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">window-configuration-frame</code> <em class="replaceable"><code>config</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ウィンドウ構成<em class="replaceable"><code>config</code></em>が作成されたフレームをリターンする。
</p></blockquote></div><p>ウィンドウ構成の内部を調べる他のプリミティブも有用かもしれませんが、わたしたちはこれらを必要としないので実装されていません。ウィンドウ構成にたいしてより多くの操作を知りたい場合は、ファイル<code class="filename">winner.el</code>を参照してください。
</p><p><code class="literal">current-window-configuration</code>がリターンするオブジェクトは、Emacsプロセスとともに終焉します。ウィンドウ構成をディスク上に格納して、それを別のEmacsセッションに読み戻すために、次に説明する関数を使用できます。これらの関数は、フレームの状態を任意の生きたウィンドウにクローンする場合も有用です(<code class="literal">set-window-configuration</code>はフレームのウィンドウを、そのフレームのルートウィンドウだけに効果的にクローンする)。
</p><a id="idm71314512" class="indexterm"/><pre class="synopsis"><a id="idm71313488" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">window-state-get</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>window</code></em> <em class="replaceable"><code>writable</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>window</code></em>の状態をLispオブジェクトとしてリターンする。引数<em class="replaceable"><code>window</code></em>は有効なウィンドウでなければならず、デフォルトは選択されたフレームのルートウィンドウである。
</p><p>オプション引数<em class="replaceable"><code>writable</code></em>が非<code class="literal">nil</code>の場合、それは<code class="literal">window-point</code>や<code class="literal">window-start</code>のようなサンプリング位置にたいするマーカーを使用しないことを意味する。この状態をディスクに書き込んで別のセッションに読み戻す場合は、この引数は非<code class="literal">nil</code>であること。
</p><p>引数<em class="replaceable"><code>writable</code></em>と変数<code class="literal">window-persistent-parameters</code>の両方で、この関数によりどのウィンドウパラメーターが保存されるかを指定する。<a class="link" href="ch28s25.html" title="Window Parameters">Window
Parameters</a>を参照のこと。
</p></blockquote></div><p><code class="literal">window-state-get</code>によりリターンされる値は、同一セッション内の他のウィンドウ内にあるウィンドウのクローンを作成するために使用できます。これはディスクに書き込んで、別のセッションに読み戻すこともできます。どちらの場合でも、ウィンドウの状態をリストアするためには以下の関数を使用します。
</p><pre class="synopsis"><a id="idm71303248" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">window-state-put</code> <em class="replaceable"><code>state</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>window</code></em> <em class="replaceable"><code>ignore</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ウィンドウ状態<em class="replaceable"><code>state</code></em>を<em class="replaceable"><code>window</code></em>内にputする。引数<em class="replaceable"><code>state</code></em>は以前に呼び出した<code class="literal">window-state-get</code>がリターンしたウィンドウ状態であること。オプション引数<em class="replaceable"><code>window</code></em>には生きたウィンドウ、または内部ウィンドウ(<a class="link" href="ch28s02.html" title="Windows and Frames">Windows
and
Frames</a>を参照)のいずれかを指定でき、デフォルトは選択されたウィンドウである。<em class="replaceable"><code>window</code></em>が生きていない場合は、<em class="replaceable"><code>state</code></em>をputする前に生きたウィンドウに置き換える。
</p><p>オプション引数<em class="replaceable"><code>ignore</code></em>が非<code class="literal">nil</code>の場合、それは最小ウィンドウサイズと固定サイズの制限を無視することを意味する。<em class="replaceable"><code>ignore</code></em>が<code class="literal">safe</code>なら、それは1行および/または2列まで、できる限り小さくできることを意味する。
</p></blockquote></div></div></body></html>