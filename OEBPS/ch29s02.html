<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Multiple Terminals</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Multiple-Terminals"/>Multiple Terminals</h1></div></div></div><a id="idm71074640" class="indexterm"/><a id="idm71073872" class="indexterm"/><a id="idm71073104" class="indexterm"/><a id="idm71072336" class="indexterm"/><p>Emacsは、それぞれの端末を<em class="firstterm">端末オブジェクト(terminal object)</em>というデータ型で表します(<a class="link" href="ch03s04.html#Terminal-Type" title="Terminal Type">Terminal
Type</a>を参照)。GNUおよびUnixシステムでは、Emacsはそれぞれのセッション内で複数の端末を同時に実行できます。その他のシステムでは、単一の端末だけが使用できます。端末オブジェクトはそれぞれ、以下の属性をもちます:
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>その端末により使用されるデバイスの名前(たとえば‘<code class="literal">:0.0</code>’や<code class="filename">/dev/tty</code>)。
</p></li><li class="listitem"><p>その端末により使用される端末とキーボードのコーディングシステム。<a class="link" href="ch33s10.html#Terminal-I_002fO-Encoding" title="Terminal I/O Encoding">Terminal I/O Encoding</a>を参照のこと。
</p></li><li class="listitem"><p>その端末に関連付けられたディスプレイの種類。これは、関数<code class="literal">terminal-live-p</code>によりリターンされるシンボル(たとえば<code class="literal">x</code>、<code class="literal">t</code>、<code class="literal">w32</code>、<code class="literal">ns</code>、<code class="literal">pc</code>)である。<a class="link" href="ch29.html" title="Chapter 28. Frames">Frames</a>を参照のこと。
</p></li><li class="listitem"><p>端末パラメーターのリスト。<a class="link" href="ch29s04.html" title="Terminal Parameters">Terminal Parameters</a>を参照のこと。
</p></li></ul></div><p>端末オブジェクトを作成するプリミティブはありません。<code class="literal">make-frame-on-display</code>(以下参照)を呼び出したときなど、Emacsは必要に応じてそれらを作成します。
</p><pre class="synopsis"><a id="idm71061328" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">terminal-name</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>terminal</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>terminal</code></em>により使用されるデバイスのファイル名をリターンする。<em class="replaceable"><code>terminal</code></em>が省略または<code class="literal">nil</code>の場合のデフォルトは、選択されたフレームの端末である。<em class="replaceable"><code>terminal</code></em>はフレームでもよく、その場合はそのフレームの端末となる。
</p></blockquote></div><pre class="synopsis"><a id="idm71056080" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">terminal-list</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、すべての生きた端末オブジェクトのリストをリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm71053264" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">get-device-terminal</code> <em class="replaceable"><code>device</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>device</code></em>により与えられたデバイス名の端末をリターンする。<em class="replaceable"><code>device</code></em>が文字列の場合は端末デバイス名、または‘<code class="literal"><em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>server</code></em>.<em class="replaceable"><code>screen</code></em></code>’という形式のXディスプレイ名のいずれかを指定できる。<em class="replaceable"><code>device</code></em>の場合、この関数はそのフレームの端末をリターンする。<code class="literal">nil</code>は選択されたフレームを意味する。最後に、もし<em class="replaceable"><code>device</code></em>が生きた端末を表す端末オブジェクトなら、その端末がリターンされる。引数がこれらのいずれとも異なる場合、この関数はエラーをシグナルする。
</p></blockquote></div><pre class="synopsis"><a id="idm71046480" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">delete-terminal</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>terminal</code></em> <em class="replaceable"><code>force</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>terminal</code></em>上のすべてのフレームを削除して、それらが使用していたリソースを解放する。これらはアブノーマルフック<code class="literal">delete-terminal-functions</code>を実行し、各関数の引数として<em class="replaceable"><code>terminal</code></em>を渡す。
</p><p><em class="replaceable"><code>terminal</code></em>が省略または<code class="literal">nil</code>の場合のデフォルトは、選択されたフレームの端末である。<em class="replaceable"><code>terminal</code></em>はフレームでもよく、その場合はそのフレームの端末を意味する。
</p><p>この関数は通常、唯一アクティブな端末の削除を試みるとエラーをシグナルするが、<em class="replaceable"><code>force</code></em>が非<code class="literal">nil</code>なら、これを行うことができる。端末上で最後のフレームを削除した際、Emacsは自動的にこの関数を呼び出す(<a class="link" href="ch29s06.html" title="Deleting Frames">Deleting
Frames</a>を参照)。
</p></blockquote></div><pre class="synopsis"><a id="idm71037776" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">delete-terminal-functions</code></pre><div class="blockquote"><blockquote class="blockquote"><p><code class="literal">delete-terminal</code>により実行されるアブノーマルフック。各関数は、<code class="literal">delete-terminal</code>に渡された<em class="replaceable"><code>terminal</code></em>を、唯一の引数として受け取る。技術的な詳細により、この関数は端末の削除の直前、または直後のいずれかに呼び出される。
</p></blockquote></div><a id="idm71034064" class="indexterm"/><p>数は多くありませんが、いくつかのLisp変数は<em class="firstterm">端末ローカル(terminal-local)</em>です。つまり、それらは端末それぞれにたいして、個別にバインディングをもちます。いかなるときも、実際に効果をもつバインディングは、カレントで選択されたフレームに属する端末にたいして1つだけです。これらの変数には<code class="literal">default-minibuffer-frame</code>、<code class="literal">defining-kbd-macro</code>、<code class="literal">last-kbd-macro</code>、<code class="literal">system-key-alist</code>が含まれます。これらは常に端末ローカルであり、決してバッファーローカル(<a class="link" href="ch12s10.html" title="Buffer-Local Variables">Buffer-Local
Variables</a>を参照)にはできません。
</p><p>GNUおよびUnixシステムでは、Xディスプレイはそれぞれ別のグラフィカル端末になります。Xウィンドウシステム内でEmacsが開始された際は環境変数<code class="envar">DISPLAY</code>、または‘<code class="literal">--display</code>’オプション(section “Initial
Options” in <em class="citetitle">The GNU Emacs
Manual</em>を参照)により指定されたXディスプレイを使用します。Emacsはコマンド<code class="literal">make-frame-on-display</code>を通じて、別のXディスプレイに接続できます。それぞれのXディスプレイは各自、選択されたフレームとミニバッファーをもちます。しかしあらゆる瞬間(<a class="link" href="ch29s09.html" title="Input Focus">Input
Focus</a>を参照)において、それらのフレームのうちの1つだけが、“<span class="emphasis"><em>いわゆる</em></span>選択されたフレーム”になります。<span class="command"><strong>emacsclient</strong></span>との対話することにより、Emacsが別のテキスト端末と接続することさえ可能です。section “Emacs
Server” in <em class="citetitle">The GNU Emacs Manual</em>を参照してください。
</p><a id="idm71026000" class="indexterm"/><a id="idm71025232" class="indexterm"/><p>1つのXサーバーが、1つ以上のディスプレイを処理できます。各Xディスプレイには、‘<code class="literal"><em class="replaceable"><code>hostname</code></em>:<em class="replaceable"><code>displaynumber</code></em>.<em class="replaceable"><code>screennumber</code></em></code>’という3つの部分からなる名前があります。1つ目の部分の<em class="replaceable"><code>hostname</code></em>は、その端末が物理的に接続されるマシン名です。2つ目の部分の<em class="replaceable"><code>displaynumber</code></em>は、同じキーボードとポインティングデバイス(マウスやタブレット等)を共有するマシンに接続された、1つ以上のモニターを識別するための、0基準の番号です。3つ目の部分の<em class="replaceable"><code>screennumber</code></em>は、そのXサーバー上の単一のモニターコレクション(a
single monitor
collection)の一部である、0基準のスクリーン番号(個別のモニター)です。1つのサーバー配下にある2つ以上のスクリーンを使用する際、Emacsはそれらの名前の同一部分から、それらが単一のキーボードを共有することを知ることができるのです。
</p><p>MS-WindowsのようにXウィンドウシステムを使用しないシステムは、Xディスプレイの概念をサポートせず、各ホスト上には1つのディスプレイだけがあります。これらのシステム上のディスプレイ名は、上述したような3つの部分からなる名前にしたがいません。たとえば、MS-Windowsシステム上のディスプレイ名は文字列定数‘<code class="literal">w32</code>’です。これは互換性のために存在するものであり、ディスプレイ名を期待する関数にこれを渡すことができます。
</p><pre class="synopsis"><a id="idm71016272" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">make-frame-on-display</code> <em class="replaceable"><code>display</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>parameters</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>display</code></em>上に新たにフレームを作成して、それをリターンする。その他のフレームパラメーターは、alist
<em class="replaceable"><code>parameters</code></em>から取得する。<em class="replaceable"><code>display</code></em>はXディスプレイの名前(文字列)であること。
</p><p>この関数は、フレーム作成前にEmacsがグラフィックを表示するために“セットアップ”されることを保証する。たとえば、Emacsが(テキスト端末上で開始された等で)Xリソースを未処理なら、この時点で処理を行う。他のすべての点においては、この関数は<code class="literal">make-frame</code>(<a class="link" href="ch29.html#Creating-Frames" title="Creating Frames">Creating
Frames</a>を参照)と同様に振る舞う。
</p></blockquote></div><pre class="synopsis"><a id="idm71009744" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">x-display-list</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、EmacsがどのXディスプレイに接続したかを識別するリストをリターンする。このリストの要素は文字列で、それぞれがディスプレイ名を表す。
</p></blockquote></div><pre class="synopsis"><a id="idm71006928" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">x-open-connection</code> <em class="replaceable"><code>display</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>xrm-string</code></em> <em class="replaceable"><code>must-succeed</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ディスプレイ上にフレームを作成することなく、Xディスプレイ<em class="replaceable"><code>display</code></em>への接続をオープンする。通常は、<code class="literal">make-frame-on-display</code>が自動的に呼び出すので、Emacs
Lispプログラムがこの関数を呼び出す必要はない。これを呼び出す唯一の理由は、与えられたXディスプレイにたいして通信を確立できるかどうかチェックするためである。
</p><p>オプション引数<em class="replaceable"><code>xrm-string</code></em>が非<code class="literal">nil</code>なら、それは<code class="filename">.Xresources</code>ファイル内で使用されるフォーマットと同一な、リソース名とリソース値である。section “X Resources” in <em class="citetitle">The GNU Emacs
Manual</em>を参照のこと。これらの値はそのXサーバー上で記録されたリソース値をオーバーライドして、このディスプレイ上で作成されるすべてのEmacsフレームにたいして適用される。以下は、この文字列がどのようなものかを示す例である:
</p><pre class="screen">"*BorderWidth: 3\n*InternalBorder: 2\n"
</pre><p><em class="replaceable"><code>must-succeed</code></em>が非<code class="literal">nil</code>なら、接続オープンの失敗によりEmacsが終了させられる。それ以外の場合は、通常のLispエラーとなる。
</p></blockquote></div><pre class="synopsis"><a id="idm70997840" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">x-close-connection</code> <em class="replaceable"><code>display</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ディスプレイ<em class="replaceable"><code>display</code></em>への接続をクローズする。これを行う前にまず、そのディスプレイ上でオープンしたすべてのフレームを削除しなければならない(<a class="link" href="ch29s06.html" title="Deleting Frames">Deleting
Frames</a>を参照)。
</p></blockquote></div><a id="idm70994000" class="indexterm"/><p>“マルチモニター”のセットアップにおいて、単一のXディスプレイが複数の物理モニターに出力される場合があります。そのようなセットアップを取得するために、関数<code class="literal">display-monitor-attributes-list</code>と<code class="literal">frame-monitor-attributes</code>を使用できます。
</p><pre class="synopsis"><a id="idm70991568" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">display-monitor-attributes-list</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>display</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>display</code></em>上の物理モニターの属性のリストをリターンする。<em class="replaceable"><code>display</code></em>にはディスプレイ名(文字列)、端末、フレームを指定でき、省略または<code class="literal">nil</code>の場合のデフォルトは、選択されたフレームのディスプレイである。このリストの各要素は、物理モニターの属性を表す連想リストである。1つ目の要素はプライマリーモニターである。以下は属性のキーと値である:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">‘<code class="literal">geometry</code>’
</span></dt><dd><p>‘<code class="literal">(<em class="replaceable"><code>x</code></em> <em class="replaceable"><code>y</code></em> <em class="replaceable"><code>width</code></em>
<em class="replaceable"><code>height</code></em>)</code>’のような、ピクセル単位でのそのモニターのスクリーンの左上隅の位置、そのサイズ。そのモニターがプライマリーモニターでない場合は、いくつかの座標が負になり得る。
</p></dd><dt><span class="term">‘<code class="literal">workarea</code>’
</span></dt><dd><p>‘<code class="literal">(<em class="replaceable"><code>x</code></em> <em class="replaceable"><code>y</code></em> <em class="replaceable"><code>width</code></em>
<em class="replaceable"><code>height</code></em>)</code>’のような、ピクセル単位でのワークエリア(“使用可能”なスペース)の左上隅の位置と、そのサイズ。これはワークエリアから除外され得る、ウィンドウマネージャーのさまざまな機能(dock、taskbar等)が占めるスペースの分、‘<code class="literal">geometry</code>’とは異なるかもしれない。そのような機能が実際にワークエリアから差し引かれるかどうかは、そのプラットフォームと環境に依存する。繰り返しになるが、そのモニターがプライマリーモニターでない場合、いくつかの座標は負になり得る。
</p></dd><dt><span class="term">‘<code class="literal">mm-size</code>’
</span></dt><dd><p>‘<code class="literal">(<em class="replaceable"><code>width</code></em> <em class="replaceable"><code>height</code></em>)</code>’&lt;のような、ミリメートル単位での幅と高さ。
</p></dd><dt><span class="term">‘<code class="literal">frames</code>’
</span></dt><dd><p>その物理モニターが支配(dominate)するフレームのリスト(以下参照)。
</p></dd><dt><span class="term">‘<code class="literal">name</code>’
</span></dt><dd><p><em class="replaceable"><code>string</code></em>のような、その物理モニターの名前。
</p></dd><dt><span class="term">‘<code class="literal">source</code>’
</span></dt><dd><p><em class="replaceable"><code>string</code></em>のような、マルチモニターの情報ソース(例: ‘<code class="literal">XRandr</code>’、‘<code class="literal">Xinerama</code>’等)。
</p></dd></dl></div><p><em class="replaceable"><code>x</code></em>、<em class="replaceable"><code>y</code></em>、<em class="replaceable"><code>width</code></em>、<em class="replaceable"><code>height</code></em>は整数。‘<code class="literal">name</code>’と‘<code class="literal">source</code>’は欠落しているかもしれない。
</p><p>あるモニター内にフレームの最大領域がある、または(フレームがどの物理モニターに跨がらないなら)そのモニターがフレームに最も近いとき、フレームは物理モニターにより<em class="firstterm">支配(dominate)</em>される。グラフィカルなディスプレイ内の(ツールチップではない)すべてのフレームは、たとえそのフレームが複数の物理モニターに跨がる(または物理モニター上にない)としても、(可視か否かによらず)正確に1つの物理モニターにより支配される。
</p><p>以下は、2つのモニターディスプレイ上でこの関数により生成されたデータの例である:
</p><pre class="programlisting">  (display-monitor-attributes-list)
  ⇒
  (((geometry 0 0 1920 1080) ;; 左手側プライマリーモニター
    (workarea 0 0 1920 1050) ;; タスクバーが幾分かの高さを占有
    (mm-size 677 381)
    (name . "DISPLAY1")
    (frames #&lt;frame emacs@host *Messages* 0x11578c0&gt;
            #&lt;frame emacs@host *scratch* 0x114b838&gt;))
   ((geometry 1920 0 1680 1050) ;; 右手側モニター
    (workarea 1920 0 1680 1050) ;; スクリーン全体を使用可
    (mm-size 593 370)
    (name . "DISPLAY2")
    (frames)))
</pre></blockquote></div><pre class="synopsis"><a id="idm70945360" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">frame-monitor-attributes</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>frame</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、 <em class="replaceable"><code>frame</code></em>を支配(上記参照)する物理モニターの属性をリターンする。
<em class="replaceable"><code>frame</code></em>のデフォルトは選択されたフレームである。
</p></blockquote></div></div></body></html>