<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Input Focus</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Input-Focus"/>Input Focus</h1></div></div></div><a id="idm70303184" class="indexterm"/><p>どんなときでも、Emacs内のただ1つのフレームが<em class="firstterm">選択されたフレーム(selected
frame)</em>です。選択されたウィンドウは、常に選択されたフレーム上にあります。
</p><p>Emacsがフレームを複数端末(<a class="link" href="ch29s02.html" title="Multiple Terminals">Multiple
Terminals</a>を参照)上に表示する際、各端末は自身の選択されたフレームをもちます。しかし、それらのうち1つだけが、“<span class="emphasis"><em>いわゆる</em></span>選択されたフレーム”であり、それはもっとも最近に入力があった端末に属すフレームです。つまり、特定の端末からのコマンドをEmacsが実行する際は、その端末上の1つが選択されたフレームです。Emacsが実行するコマンドは常に1つだけなので、選択されたフレームは常に1つだけだと考える必要があります。このフレームこそ、このマニュアルで<em class="firstterm">選択されたフレーム</em>と呼ぶフレームです。選択されたフレームを表示するディスプレイは、<em class="firstterm">選択されたフレームのディスプレイ(selected
frame’s display)</em>です。
</p><pre class="synopsis"><a id="idm70299088" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">selected-frame</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は選択されたフレームをリターンする。
</p></blockquote></div><p>いくつかのウィンドウシステムおよびウィンドウマネージャーは、マウスがあるウィンドウオブジェクトにキーボード入力をダイレクトします。それ以外は、さまざまなウィンドウオブジェクトに<em class="firstterm">フォーカスをシフト(shift
the
focus)</em>するために、明示的なクリックやコマンドを要求します。どちらの方法でも、Emacsはフォーカスをもつフレームを自動的に追跡します。Lisp関数から別フレームに明示的に切り替えるためには、<code class="literal">select-frame-set-input-focus</code>を呼び出します。
</p><p>関数<code class="literal">select-frame</code>を呼び出すことにより、Lispプログラムが“一時的”にフレームを切り替えることもできます。これは、そのウィンドウシステムのフォーカス概念を変更はしません。変更ではなく、何らかの方法により制御が再確認(reasserted)されるまで、ウィンドウマネージャーの制御から抜け出す(escape)のです。
</p><p>テキスト端末使用時は、その端末上で一度に表示できるフレームは1つだけなので、<code class="literal">select-frame</code>呼び出し後、次回の再表示で新たに選択されたフレームが実際に表示されます。このフレームは、次の<code class="literal">select-frame</code>呼び出しまで、選択されたままです。テキスト端末上の各フレームは、バッファー名の前に表示される番号をもちます(<a class="link" href="ch23s04.html#Mode-Line-Variables" title="Variables Used in the Mode Line">Mode
Line Variables</a>を参照)。
</p><pre class="synopsis"><a id="idm70287952" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">select-frame-set-input-focus</code> <em class="replaceable"><code>frame</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>norecord</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>frame</code></em>を選択、(他のフレームのせいで不明瞭な場合には)それを前面に移動(raise)して、Xサーバーのフォーカス授与を試みる。テキスト端末上では、次回再表示時に端末スクリーン全体に新たにフレームが表示される。オプション引数<em class="replaceable"><code>norecord</code></em>は、<code class="literal">select-frame</code>(下記参照)のときと同じ意味をもつ。この関数のリターン値に意味はない。
</p></blockquote></div><pre class="synopsis"><a id="idm70282704" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">select-frame</code> <em class="replaceable"><code>frame</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>norecord</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、フレーム<em class="replaceable"><code>frame</code></em>を選択し、Xサーバーのフォーカスがあればそれを一時的に無視する。<em class="replaceable"><code>frame</code></em>にたいする選択は、次回ユーザーが別フレームに何かを行うか、この関数の次回呼び出しまで継続する(ウィンドウシステムを使用する場合は、以前に選択されていたフレームに依然としてウィンドウシステムの入力フォーカスがあるかもしれないので、コマンドループからリターン後に、そのフレームが選択されたフレームとしてリストアされるかもしれない)。
</p><p>指定された<em class="replaceable"><code>frame</code></em>は選択されたフレームとなり、その端末が選択された端末になる。その後、この関数は<em class="replaceable"><code>frame</code></em>内で選択されていたウィンドウを第1引数、<em class="replaceable"><code>norecord</code></em>を第2引数でサブルーチンとして<code class="literal">select-window</code>を呼び出す(したがって、<em class="replaceable"><code>norecord</code></em>が非<code class="literal">nil</code>なら、もっとも最近に選択されたウィンドウおよびバッファーリストの変更を避ける)。<a class="link" href="ch28s08.html" title="Selecting Windows">Selecting
Windows</a>を参照のこと。
</p><p>この関数は<em class="replaceable"><code>frame</code></em>、または<em class="replaceable"><code>frame</code></em>が削除されていれば<code class="literal">nil</code>をリターンする。
</p><p>一般的には、実行後に端末を戻すよう切り替えることなく、別の端末に切り替えるのが可能な手段として<code class="literal">select-frame</code>を決して使用すべきではない。
</p></blockquote></div><p>Emacsは、サーバーおよびウィンドウマネージャーのリクエストとしてフレーム選択をアレンジすることにより、ウィンドウシステムと協調します。これは、適切なときに<em class="firstterm">フォーカス(focus)</em>と呼ばれる特殊な入力イベントを生成することにより行われます。コマンドループは、<code class="literal">handle-switch-frame</code>を呼び出してフォーカスイベントを処理します。<a class="link" href="ch21s07.html#Focus-Events" title="Focus Events">Focus
Events</a>を参照してください。
</p><pre class="synopsis"><a id="idm70269776" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">handle-switch-frame</code> <em class="replaceable"><code>frame</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、フレーム<em class="replaceable"><code>frame</code></em>選択によりフォーカスイベントを処理する。
</p><p>フォーカスイベントは通常、このコマンドを呼び出すことにより、その処理を行う。他の理由でこれを呼び出しではならない。
</p></blockquote></div><pre class="synopsis"><a id="idm70265808" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">redirect-frame-focus</code> <em class="replaceable"><code>frame</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>focus-frame</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>frame</code></em>から<em class="replaceable"><code>focus-frame</code></em>にフォーカスをリダイレクトする。これは、<em class="replaceable"><code>frame</code></em>にかわって<em class="replaceable"><code>focus-frame</code></em>が以降のキーストロークとイベントを受け取るであろうことを意味する。そのようなイベント後は、<code class="literal">last-event-frame</code>の値は<em class="replaceable"><code>focus-frame</code></em>になるだろう。また、<em class="replaceable"><code>frame</code></em>を指定したswitch-frameイベントも、かわりに
<em class="replaceable"><code>focus-frame</code></em>を選択するだろう。
</p><p><em class="replaceable"><code>focus-frame</code></em>が省略または<code class="literal">nil</code>の場合は、<em class="replaceable"><code>frame</code></em>にたいするすべての既存のリダイレクションがキャンセルされ、したがって<em class="replaceable"><code>frame</code></em>が自身のイベントを再度受け取ることになる。
</p><p>フォーカスリダイレクトの用途の1つは、ミニバッファーをもたないフレームにたいしてである。これらのフレームは、別フレーム上のミニバッファーを使用する。別フレーム上のミニバッファーをアクティブにすることは、そのフレームにフォーカスをリダイレクトすることである。これは、たとえマウスがミニバッファーをアクティブにしたフレーム内に留まっていても、ミニバッファーが属すフレームにフォーカスを置く。
</p><p>フレーム選択は、フォーカスリダイレクションの変更も可能にする。<code class="literal">foo</code>が選択されているときにフレーム<code class="literal">bar</code>を選択することにより、<code class="literal">foo</code>を指すすべてのリダイレクションは、かわりに<code class="literal">bar</code>を指す。これは、ユーザーが<code class="literal">select-window</code>を使用してあるフレームから別のフレームに切り替えた際に、フォーカスのリダイレクトが正しく機能することを可能にする。
</p><p>これは、フォーカスが自身にリダイレクトされたフレームが、フォーカスがリダイレクトされていないフレームとは異なう扱いを受けることを意味する。前者にたいして<code class="literal">select-frame</code>は影響するが、後者には影響がない。
</p><p>このリダイレクションは、それを変更するために<code class="literal">redirect-frame-focus</code>が呼び出されるまで継続する。
</p></blockquote></div><pre class="synopsis"><a id="idm70251600" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">focus-in-hook</code></pre><div class="blockquote"><blockquote class="blockquote"><p>これは、Emacsフレームが入力フォーカスを得た際に実行されるノーマルフックである。
</p></blockquote></div><pre class="synopsis"><a id="idm70248784" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">focus-out-hook</code></pre><div class="blockquote"><blockquote class="blockquote"><p>これは、Emacsフレームが入力フォーカスを失った際に実行されるノーマルフックである。
</p></blockquote></div><pre class="synopsis"><a id="idm70245968" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">focus-follows-mouse</code></pre><div class="blockquote"><blockquote class="blockquote"><p>これは、ユーザーがマウスを移動した際に、ウィンドウマネージャーがフォーカスを転送するかどうかをEmacsに告げるためのオプションである。非<code class="literal">nil</code>なら、フォーカスは転送される。その場合、コマンド<code class="literal">other-frame</code>は新たに選択されたフレームと一貫性のある位置にマウスを移動する。
</p></blockquote></div></div></body></html>