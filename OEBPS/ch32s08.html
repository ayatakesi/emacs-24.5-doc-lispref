<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>The Kill Ring</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="The-Kill-Ring"/>The Kill Ring</h1></div></div></div><a id="idm72436816" class="indexterm"/><p><em class="firstterm">kill関数(kill
functions)</em>は削除関数のようにテキストを削除しますが、ユーザーが<em class="firstterm">yank</em>により再挿入できるようにそれらを保存する点が異なります。これらの関数のほとんどは、‘<code class="literal">kill-</code>’という名前をもちます。対照的に名前が‘<code class="literal">delete-</code>’で始まる関数は、(たとえ削除をundoできるとしても)通常はyank用にテキストを保存しません。それらは“削除(deletion)”関数です。
</p><p>ほとんどのkillコマンドは、主にインタラクティブな使用を意図しており、ここでは説明しません。ここで説明するのは、そのようなコマンドの記述に使用されるために提供される関数です。テキストをkillするために、これらのカを使用できます。Lisp関数の内部的な目的のためにテキストの削除を要するときは、killリング内のコンテンツに影響を与えないように、通常は削除関数を使用するべきでしょう。<a class="link" href="ch32s06.html" title="Deleting Text">Deletion</a>を参照してください。
</p><p>killされたテキストは、後のyank用に<em class="firstterm">killリング(kill
ring)</em>内に保存されます。これは、直前のkillだけでなく直近のkillのいくつかを保持するリストです。yankがそれをサイクル順に要素をもつリストとして扱うので、これを“リング(ring)”と称しています。このリストは変数<code class="literal">kill-ring</code>に保持されており、リスト用の通常関数で操作可能です。このセクションで説明する、これをリングとして扱うために特化された関数も存在します。
</p><p>特に“kill”された実体が<span class="emphasis"><em>破壊</em></span>されてしまわないような操作を参照するという理由から、“kill”という単語の使用が不適切だと考える人もいます。これは通常の生活において、死は永遠であり“kill”された実体は生活に戻ることはないことと対照的です。したがって、他の比喩表現も提案されてきました。たとえば、“cutリング(cut
ring)”という用語は、コンピューター誕生前に原稿を再配置するためにハサミで切り取って貼り付けていたような人に意味があるでしょう。しかし、今となってはこの用語を変更するのは困難です。
</p><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Kill-Ring-Concepts"/>Kill Ring Concepts</h2></div></div></div><p>killリングは、リスト内でもっとも最近にkillされたテキストが先頭になるように、killされたテキストを記録します。たとえば、短いkillリングは以下のようになるでしょう:
</p><pre class="screen">("some text" "a different piece of text" "even older text")
</pre><p>このリストのエントリー長が<code class="literal">kill-ring-max</code>に達すると、新たなエントリー追加により最後のエントリーが自動的に削除されます。
</p><p>killコマンドが他のコマンドと混ざり合っているときは、各killコマンドはkillリング内に新たなエントリーを作成します。連続する複数のkillコマンドは単一のkillリングエントリーを構成します。これは1つの単位としてyankされます。2つ目以降の連続するkillコマンドは、最初のkillにより作成されたエントリーにテキストを追加します。
</p><p>yankにたいしては、killリング内のただ1つのエントリーが、そのリングの“先頭”のエントリーとなります。いくつかのyankコマンドは、異なる要素を“先頭”に指定することにより、リングを“回転(rotate)”させます。しかしこの仮想的回転はリスト自身を変更しません。もっとも最近のエントリーが、常にリスト内の最初に配置されます。
</p></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Kill-Functions"/>Functions for Killing</h2></div></div></div><p><code class="literal">kill-region</code>は、テキストkill用の通常サブルーチンです。この関数を呼び出すすべてのコマンドは、“killコマンド”です(そして恐らくは名前に‘<code class="literal">kill</code>’が含まれる)。<code class="literal">kill-region</code>は新たにkillされたテキストをkillリング内の最初の要素内に置くか、それをもっとも最近の要素に追加します。これは、前のコマンドがkillコマンドか否かを、(<code class="literal">last-command</code>を使用して)自動的に判別し、もしkillコマンドならkillされたテキストをもっとも最近のエントリーに追加します。
</p><pre class="synopsis"><a id="idm72423760" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">kill-region</code> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>start</code></em>と<em class="replaceable"><code>end</code></em>から定義されるリージョン内のテキストをkillする。そのテキストは削除されるが、そのテキストプロパティと共にkillリングに保存される。値は常に<code class="literal">nil</code>。
</p><p>インタラクティブな呼び出しでは、<em class="replaceable"><code>start</code></em>と<em class="replaceable"><code>end</code></em>は、ポイントとマークになる。
</p><p>バッファーまたはテキストが読み取り専用の場合、<code class="literal">kill-region</code>は同じようにkillリングを変更後、バッファーを変更せずにエラーをシグナルする。これは、ユーザーが一連のkillコマンドで、読み取り専用バッファーからkillリングにテキストをコピーするのに有用である。
</p></blockquote></div><pre class="synopsis"><a id="idm72416848" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">kill-read-only-ok</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このオプションが非<code class="literal">nil</code>なら、バッファーやテキストが読み取り専用でも、<code class="literal">kill-region</code>はエラーをシグナルしない。かわりに、バッファーを変更せずにkillリングを更新して、単にリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm72413136" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">copy-region-as-kill</code> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、killリングに<em class="replaceable"><code>start</code></em>と<em class="replaceable"><code>end</code></em>で定義されるリージョン(テキストプロパティを含む)を保存するが、バッファーからテキストを削除しない。リターン値は<code class="literal">nil</code>。
</p><p>このコマンドは、後続のkillコマンドが同一のkillリングエントリーに追加しないよう、<code class="literal">this-command</code>に<code class="literal">kill-region</code>をセットしない。
</p><p>Lispプログラム内では、このコマンドより<code class="literal">kill-new</code>や<code class="literal">kill-append</code>を使うほうがよい。<a class="link" href="ch32s08.html#Low_002dLevel-Kill-Ring" title="Low-Level Kill Ring">Low-Level
Kill Ring</a>を参照のこと。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Yanking"/>Yanking</h2></div></div></div><p>yankとは、killリングからテキストを挿入するものの、単なる挿入ではないことを意味します。<code class="literal">yank</code>および関連するコマンドは、テキスト挿入前に特別な処理を施すために、<code class="literal">insert-for-yank</code>を使用します。
</p><pre class="synopsis"><a id="idm72397776" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">insert-for-yank</code> <em class="replaceable"><code>string</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<code class="literal">insert</code>と同様に機能するが、結果をカレントバッファーに挿入する前に、テキストプロパティ<code class="literal">yank-handler</code>、同様に変数<code class="literal">yank-handled-properties</code>および<code class="literal">yank-excluded-properties</code>に応じて<em class="replaceable"><code>string</code></em>内のテキストを処理する点が異なる。
</p></blockquote></div><pre class="synopsis"><a id="idm72392016" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">insert-buffer-substring-as-yank</code> <em class="replaceable"><code>buf</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は<code class="literal">insert-buffer-substring</code>と似ているが、<code class="literal">yank-handled-properties</code>および<code class="literal">yank-excluded-properties</code>に応じてテキストを処理する点が異なる(これは<code class="literal">yank-handler</code>プロパティを処理しないが、いずれにせよバッファー内のテキストでは通常は発生しない)。
</p></blockquote></div><p>文字列の一部またはすべてにテキストプロパティ<code class="literal">yank-handler</code>をputした場合、<code class="literal">insert-for-yank</code>が文字列を挿入する方法が変更されます。文字列の別の箇所が異なる<code class="literal">yank-handler</code>の値をもつ場合(比較は<code class="literal">eq</code>で行われる)、部分文字列はそれぞれ個別に処理されます。プロパティ値は以下の形式からなる1から4要素のリストでなければなりません(2番目以降の要素は省略されるかもしれない):
</p><pre class="screen">(<em class="replaceable"><code>function</code></em> <em class="replaceable"><code>param</code></em> <em class="replaceable"><code>noexclude</code></em> <em class="replaceable"><code>undo</code></em>)
</pre><p>以下は、これらの要素が何を行うかです:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>function</code></em>
</span></dt><dd><p><em class="replaceable"><code>function</code></em>が非<code class="literal">nil</code>なら、<code class="literal">insert</code>のかわりに文字列を挿入するために、挿入する文字列を単一の引数として、その関数が呼び出される。
</p></dd><dt><span class="term"><em class="replaceable"><code>param</code></em>
</span></dt><dd><p>非<code class="literal">nil</code>の<em class="replaceable"><code>param</code></em>が与えられた場合、それは<em class="replaceable"><code>string</code></em>(または処理される<em class="replaceable"><code>string</code></em>の部分文字列)を置き換えるオブジェクトとして<em class="replaceable"><code>function</code></em>(または<code class="literal">insert</code>)に渡される。たとえば<em class="replaceable"><code>function</code></em>が<code class="literal">yank-rectangle</code>なら、<em class="replaceable"><code>param</code></em>は矩形(rectangle)として挿入されるべき文字列のリストになる。
</p></dd><dt><span class="term"><em class="replaceable"><code>noexclude</code></em>
</span></dt><dd><p>非<code class="literal">nil</code>の<em class="replaceable"><code>noexclude</code></em>が与えられた場合は、挿入される文字列にたいする<code class="literal">yank-handled-properties</code>および<code class="literal">yank-excluded-properties</code>の通常の動作を無効にする。
</p></dd><dt><span class="term"><em class="replaceable"><code>undo</code></em>
</span></dt><dd><p>非<code class="literal">nil</code>の<em class="replaceable"><code>undo</code></em>が与えられた場合、それはカレントオブジェクトの挿入をundoするために<code class="literal">yank-pop</code>が呼び出す関数である。この関数は、カレントリージョンのstartとendの、2つの引数で呼び出される。<em class="replaceable"><code>function</code></em>は<code class="literal">yank-undo-function</code>をセットすることにより、<em class="replaceable"><code>undo</code></em>の値をオーバーライドできる。
</p></dd></dl></div><a id="idm72366160" class="indexterm"/><pre class="synopsis"><a id="idm72365136" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">yank-handled-properties</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、yankされるテキストの状態を処理するスペシャルテキストプロパティを指定する。これは(通常の方法、または<code class="literal">yank-handler</code>を通じた)テキスト挿入後、<code class="literal">yank-excluded-properties</code>が効力をもつ前に効果を発揮する。
</p><p>値は、要素が<code class="literal">(<em class="replaceable"><code>prop</code></em>
.
<em class="replaceable"><code>fun</code></em>)</code>であるようなalistであること。alistの各要素は、順番に処理される。挿入されるテキストはテキスト範囲にたいして、テキストプロパティが<em class="replaceable"><code>prop</code></em>と<code class="literal">eq</code>なものがスキャンされる。そのような範囲には、そのプロパティの値、そのテキストの開始と終了の位置という、3つの引数により<em class="replaceable"><code>fun</code></em>が呼び出される。
</p></blockquote></div><pre class="synopsis"><a id="idm72358480" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">yank-excluded-properties</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、挿入されるテキストから削除するための、プロパティのリストである。デフォルト値には、マウスに応答したりキーバインディングの指定を引き起こすテキストのような、煩わしい結果をもたらすかもしれないプロパティが含まれる。これは、<code class="literal">yank-handled-properties</code>の後に効果を発揮する。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Yank-Commands"/>Functions for Yanking</h2></div></div></div><p>このセクションでは、yank用の高レベルなコマンドを説明します。これらのコマンドは主にユーザー用に意図されたものですが、Lispプログラム内での使用にたいしても有用です。<code class="literal">yank</code>および<code class="literal">yank-pop</code>はどちらも、変数<code class="literal">yank-excluded-properties</code>およびテキストプロパティ<code class="literal">yank-handler</code>にしたがいます(<a class="link" href="ch32s08.html#Yanking" title="Yanking">Yanking</a>を参照)。
</p><pre class="synopsis"><a id="idm72351312" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">yank</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>arg</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="idm72348368" class="indexterm"/><p>このコマンドは、killリングの先頭にあるテキストを、ポイントの前に挿入する。これは<code class="literal">push-mark</code>(<a class="link" href="ch31s07.html" title="The Mark">The
Mark</a>を参照)を使用して、そのテキストの先頭にマークをセットする。
</p><p><em class="replaceable"><code>arg</code></em>が非<code class="literal">nil</code>のリスト(これはユーザーがインタラクティブに数字を指定せずに<strong class="userinput"><code>C-u</code></strong>をタイプ時に発生する)なら、<code class="literal">yank</code>は上述のようにテキストを挿入するが、ポイントはyankされたテキストの前、マークはyankされたテキストの後に置かれる。
</p><p><em class="replaceable"><code>arg</code></em>が数字なら、<code class="literal">yank</code>は<em class="replaceable"><code>arg</code></em>番目に最近killされたテキスト、すなわちkillリングリストの<em class="replaceable"><code>arg</code></em>番目の要素を挿入する。この順番は、コマンドの目的にたいして1番目の要素としてみなされる、リスト先頭の要素から巡回的に数えられる。
</p><p><code class="literal">yank</code>は、それが他のプログラムから提供されるテキストを使用しないかぎり(使用する場合はそのテキストをkillリングにpushする)、killリングのコンテンツを変更しない。しかし、<em class="replaceable"><code>arg</code></em>が非1の整数の場合は、killリングを転回(rotate)してyankされるテキストをリング先頭に置く。
</p><p><code class="literal">yank</code>は<code class="literal">nil</code>をリターンする。
</p></blockquote></div><pre class="synopsis"><a id="idm72326864" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">yank-pop</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>arg</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、killリング上の正にyankされたばかりのエントリーを、killリングの別エントリーで置き換える。
</p><p>このコマンドは、<code class="literal">yank</code>または別の<code class="literal">yank-pop</code>の直後のみ許される。そのような際、そのリージョンにはyankにより正に挿入されたテキストが含まれる。<code class="literal">yank-pop</code>はそのテキストを削除して、killされた別のテキスト片をその位置に挿入する。そのテキスト片はすでにkillリング内のどこか別の箇所にあるので、これは削除されたテキストをkillリングに追加しない。しかし、新たにyankされたテキストが先頭になるよう、killリングの転回は行う。
</p><p><em class="replaceable"><code>arg</code></em>が<code class="literal">nil</code>なら、置換テキストはkillリングの1つ前の要素である。<em class="replaceable"><code>arg</code></em>が数字なら、置換テキストはkillリングの<em class="replaceable"><code>arg</code></em>個前の要素である。<em class="replaceable"><code>arg</code></em>が負の場合は、より最近のkillが置換される。
</p><p>killリング内のkillされたエントリーの順序はラップする。すなわちもっとも古いkillの次にもっとも新しいkill、もっとも新しいkillの前はもっとも古いkillとなる。
</p><p>リターン値は常に<code class="literal">nil</code>である。
</p></blockquote></div><pre class="synopsis"><a id="idm72317776" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">yank-undo-function</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>の場合、関数<code class="literal">yank-pop</code>は前の<code class="literal">yank</code>または<code class="literal">yank-pop</code>により挿入されたテキストを削除するために、<code class="literal">delete-region</code>のかわりにこの変数の値を使用する。値は、カレントリージョンの開始と終了という、2つの引数をとる関数でなければならない。
</p><p>関数<code class="literal">insert-for-yank</code>は、テキストプロパティ<code class="literal">yank-handler</code>の要素<em class="replaceable"><code>undo</code></em>に対応して、この変数を自動的にセットする。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Low_002dLevel-Kill-Ring"/>Low-Level Kill Ring</h2></div></div></div><p>以下の関数および変数は、killリングにたいして低レベルなアクセスを提供しますが、それらはウィンドウシステムの選択(<a class="link" href="ch29s18.html" title="Window System Selections">Window System
Selections</a>を参照)との相互作用にも留意するので、Lispプログラム内での使用に関しても依然として有用です。
</p><pre class="synopsis"><a id="idm72308816" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-kill</code> <em class="replaceable"><code>n</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>do-not-move</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>関数<code class="literal">current-kill</code>は、killリングの“先頭”を指すyankポインターを、(新しいkillから古いkillに)<em class="replaceable"><code>n</code></em>個転回して、リング内のその箇所のテキストをリターンする。
</p><p>オプションの第2引数<em class="replaceable"><code>do-not-move</code></em>が非<code class="literal">nil</code>なら、<code class="literal">current-kill</code>はyankポインターを変更しない。カレントyankポインターから、<em class="replaceable"><code>n</code></em>個目のkillを単にリターンする。
</p><p><em class="replaceable"><code>n</code></em>が0の場合、それは最新のkillの要求を意味しており、<code class="literal">current-kill</code>はkillリング照会前に<code class="literal">interprogram-paste-function</code>(以下参照)の値を呼び出す。その値が関数で、かつそれが文字列または複数の文字列からなるリストをリターンした場合、<code class="literal">current-kill</code>はその文字列をkillリング上にpushして、最初の文字列をリターンする。これは<em class="replaceable"><code>do-not-move</code></em>の値に関わらず、<code class="literal">interprogram-paste-function</code>がリターンする最初の文字列のkillリングエントリーを指すように、yankポインターのセットも行う。それ以外では、<code class="literal">current-kill</code>は<em class="replaceable"><code>n</code></em>にたいする0値を特別に扱うことはなく、yankポインターが指すエントリーをリターンし、yankポインターの移動は行わない。
</p></blockquote></div><pre class="synopsis"><a id="idm72297808" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">kill-new</code> <em class="replaceable"><code>string</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>replace</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、テキスト<em class="replaceable"><code>string</code></em>をkillリング上にpushして、yankポインターがそれを指すようにセットする。それが適切なら、もっとも古いエントリーを破棄する。<code class="literal">interprogram-cut-function</code>(以下参照)の呼び出しも行う。
</p><p><em class="replaceable"><code>replace</code></em>が非<code class="literal">nil</code>なら、<code class="literal">kill-new</code>はkillリング上に<em class="replaceable"><code>string</code></em>をpushせずに、killリングの1つ目の要素を<em class="replaceable"><code>string</code></em>に置き換える。
</p></blockquote></div><pre class="synopsis"><a id="idm72278224" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">kill-append</code> <em class="replaceable"><code>string</code></em> <em class="replaceable"><code>before-p</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、killリング内の最初のエントリーにテキスト<em class="replaceable"><code>string</code></em>を追加して、その結合されたエントリーを指すようにyankポインターをセットする。通常はそのエントリーの終端に<em class="replaceable"><code>string</code></em>が追加されるが、<em class="replaceable"><code>before-p</code></em>が非<code class="literal">nil</code>ならエントリーの先頭に追加される。この関数は、<code class="literal">interprogram-cut-function</code>(以下参照)の呼び出しも行う。
</p></blockquote></div><pre class="synopsis"><a id="idm72272464" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">interprogram-paste-function</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、他のプログラムからkillリングへkillされたテキストを転送する方法を提供する。値は<code class="literal">nil</code>、または引数のない関数であること。
</p><p>値が関数なら、“もっとも最近のkill”を取得するために、<code class="literal">current-kill</code>はそれを呼び出す。その関数が非<code class="literal">nil</code>値をリターンした場合は、その値が“もっとも最近のkill”として使用される。<code class="literal">nil</code>をリターンした場合は、killリングの先頭が使用される。
</p><p>複数選択をサポートするウィンドウシステムのサポートを容易にするために、この関数は文字列のリストもリターンするかもしれない。その場合、1つ目の文字列が“もっとも最近のkill”として使用され、その他の文字列はすべて<code class="literal">yank-pop</code>によるアクセスを容易にするために、killリング上にpushされる。
</p><p>この関数の通常の用途は、たとえそれが他アプリケーションに属する選択であっても、もっとも最近のkillとして、ウィンドウシステムのクリップボードからそれを取得することである。しかし、クリップボードのコンテンツがカレントEmacsセッション由来なら、この関数は<code class="literal">nil</code>をリターンする筈である。
</p></blockquote></div><pre class="synopsis"><a id="idm72265552" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">interprogram-cut-function</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、ウィンドウシステム使用時に、他のプログラムにkillされたテキストを転送する方法を提供する。値は<code class="literal">nil</code>、または1つの引数を要求する関数であること。
</p><p>値が関数なら、<code class="literal">kill-new</code>および<code class="literal">kill-append</code>は、killリングの新たな1つ目要素を引数として、それを呼び出す。
</p><p>この関数の通常の用途は、新たにkillされたテキストを、ウィンドウシステムのクリップボードに配すことである。<a class="link" href="ch29s18.html" title="Window System Selections">Window System
Selections</a>を参照のこと。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Internals-of-Kill-Ring"/>Internals of the Kill Ring</h2></div></div></div><p>変数<code class="literal">kill-ring</code>は、文字列リスト形式でkillリングのコンテンツを保持します。もっとも最近のkillが、常にこのリストの先頭になります。
</p><p>変数<code class="literal">kill-ring-yank-pointer</code>は、CARが次のyankのテキストであるような、killリングリスト内のリンクをpointします。これを、リングの“先頭”を識別すると言います。そして、<code class="literal">kill-ring-yank-pointer</code>を異なるリンクに移動することを、<em class="firstterm">killリングの転回(rotating
the kill
ring)</em>と呼びます。yankポインターを移動する関数は、yankポインターをリスト終端から先頭、またはその逆へラップするので、、killリングを“ring”と呼びます。killリングの転回は仮想的なものであり、<code class="literal">kill-ring</code>の値は変更しません。
</p><p><code class="literal">kill-ring</code>および<code class="literal">kill-ring-yank-pointer</code>はどちらも、通常は値がリストであるようなLisp変数です。<code class="literal">kill-ring-yank-pointer</code>の名前にある単語“pointer”は、その変数の目的が次回yankコマンドにより使用されるリストの最初の要素を指すことであるのを示します。
</p><p><code class="literal">kill-ring-yank-pointer</code>の値は常にkillリングリスト内の1つのリンクと<code class="literal">eq</code>です。それが指す要素は、そのリンクのCARです。killリングを変更するkillコマンドも、この変数に<code class="literal">kill-ring</code>の値をセットします。その効果は、新たにkillされた先頭になるように、リングを転回することです。
</p><p>以下は、変数<code class="literal">kill-ring-yank-pointer</code>が、killリング<code class="literal">("some text" "a different
piece of text" "yet older text")</code>内の2番目のエントリーを指すことを表すダイアグラムです。
</p><pre class="screen">kill-ring                  ---- kill-ring-yank-pointer
  |                       |
  |                       v
  |     --- ---          --- ---      --- ---
   --&gt; |   |   |------&gt; |   |   |--&gt; |   |   |--&gt; nil
        --- ---          --- ---      --- ---
         |                |            |
         |                |            |
         |                |             --&gt;"yet older text"
         |                |
         |                 --&gt; "a different piece of text"
         |
          --&gt; "some text"
</pre><p>この状態は、<strong class="userinput"><code>C-y</code></strong>(<code class="literal">yank</code>)の直後に<strong class="userinput"><code>M-y</code></strong>(<code class="literal">yank-pop</code>)を行うことにより発生し得ます。
</p><pre class="synopsis"><a id="idm72247888" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">kill-ring</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、もっとも最近にkillされたテキストが先頭になるように、killされたテキストのシーケンスのリストを保持する。
</p></blockquote></div><pre class="synopsis"><a id="idm72245200" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">kill-ring-yank-pointer</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、yankにたいして使用される、killリングの先頭にある要素を示す。より正確には、値は<code class="literal">kill-ring</code>の値のtail値であり、そのCARが<strong class="userinput"><code>C-y</code></strong>によりyankされるはずのkill文字列となる。
</p></blockquote></div><pre class="synopsis"><a id="idm72241488" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">kill-ring-max</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、リング終端の要素を破棄する前に、killリングが成長し得る最大長である。<code class="literal">kill-ring-max</code>のデフォルト値は60。
</p></blockquote></div></div></div></body></html>