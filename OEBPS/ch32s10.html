<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Maintaining Undo Lists</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Maintaining-Undo"/>Maintaining Undo Lists</h1></div></div></div><p>このセクションでは、与えられたバッファーにたいしてundo情報を有効、および無効にする方法を説明します。undoリストが巨大化しないように、undoリストを切り詰める方法も説明します。
</p><p>新たに作成されたバッファー内のundo情報記録は、開始とともに通常は有効になります。しかしバッファー名がスペースで始まる場合、undoの記録は初期状態では無効になっています。以下の2つの関数、または自身で<code class="literal">buffer-undo-list</code>をセットすることにより、undo記録の有効、または無効化を明示的に行うことができます。
</p><pre class="synopsis"><a id="idm72147536" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">buffer-enable-undo</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>buffer-or-name</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、以降の変更をundo可能にするよう、バッファー<em class="replaceable"><code>buffer-or-name</code></em>のundo情報記録を有効にする。引数が与えられない場合は、カレントバッファーを使用する。そのバッファー内のundo記録がすでに有効なら、この関数は何も行わない。リターン値は<code class="literal">nil</code>。
</p><p>インタラクティブな呼び出しでは、<em class="replaceable"><code>buffer-or-name</code></em>はカレントバッファーであり、他のバッファーを指定することはできない。
</p></blockquote></div><pre class="synopsis"><a id="idm72142288" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">buffer-disable-undo</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>buffer-or-name</code></em></pre><div class="blockquote"><blockquote class="blockquote"><a id="idm72139344" class="indexterm"/><p>この関数は<em class="replaceable"><code>buffer-or-name</code></em>のundoリストを破棄して、それ以上のundo情報記録を無効にする。結果として、以前の変更および以降のすべての変更にたいするそれ以上のundoは不可能になる。<em class="replaceable"><code>buffer-or-name</code></em>のundoリストがすでに無効なら、この関数に効果はない。
</p><p>インタラクティブな呼び出しでは、BUFFER-OR-NAMEはカレントバッファーとなる。他のバッファーを指定することはできない。リターン値は<code class="literal">nil</code>。
</p></blockquote></div><p>編集が継続されるにつれ、undoリストは次第に長くなっていく。利用可能なメモリー空間すべてを使い尽くすのを防ぐために、ガベージコレクションがundoリストを設定可能な制限サイズに切り詰め戻す(この目的のために、undoリストの“サイズ”はリストを構成するコンスセルに加えて削除された文字列により算出される)。<code class="literal">undo-limit</code>、<code class="literal">undo-strong-limit</code>、<code class="literal">undo-outer-limit</code>の3つの変数は、許容できるサイズの範囲を制御する。これらの変数においてサイズは専有するバイト数で計数され、それには保存されたテキストとその他データが含まれる。
</p><pre class="synopsis"><a id="idm72134352" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">undo-limit</code></pre><div class="blockquote"><blockquote class="blockquote"><p>これは、許容できるundoリストサイズのソフトリミットである。このサイズを超過した箇所の変更グループは、最新の変更グループ1つが保持される。
</p></blockquote></div><pre class="synopsis"><a id="idm72131664" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">undo-strong-limit</code></pre><div class="blockquote"><blockquote class="blockquote"><p>これは、undoリストの許容できるサイズの上限である。このサイズを超過する箇所の変更グループは(その他すべてのより古い変更グループとともに)自身を破棄する。1つ例外があり、<code class="literal">undo-outer-limit</code>を超過した場合は、最新の変更グループだけが破棄される。
</p></blockquote></div><pre class="synopsis"><a id="idm72128464" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">undo-outer-limit</code></pre><div class="blockquote"><blockquote class="blockquote"><p>ガベージコレクション時にカレントコマンドのundo情報がこの制限を超過したら、Emacsはその情報を破棄して、警告を表示する。これはメモリーオーバーフローを防ぐための、最後の回避用リミットである。
</p></blockquote></div><pre class="synopsis"><a id="idm72125776" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">undo-ask-before-discard</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>なら、undo情報の<code class="literal">undo-outer-limit</code>超過時、Emacsはその情報を破棄するかどうかを、エコーエリアで尋ねる。デフォルト値は<code class="literal">nil</code>で、これは自動的な破棄を意味する。
</p><p>このオプションは、主にデバッグを意図している。これを尋ねる際、ガベージコレクションは抑制されており、もしユーザーがその問にたいして答えるのをあまりに長くかかるなら、Emacsがメモリーリークを起こすかもしれないことを意味する。
</p></blockquote></div></div></body></html>