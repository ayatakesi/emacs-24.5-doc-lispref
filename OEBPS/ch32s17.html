<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Indentation</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Indentation"/>Indentation</h1></div></div></div><a id="idm71701328" class="indexterm"/><p>インデント関数は、行の先頭にある空白文字の調査、移動、変更に使用されます。行の他の箇所にある空白文字を変更できる関数も、いくつかあります。列およびインデントは、左マージンを0として数えられます。
</p><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Primitive-Indent"/>Indentation Primitives</h2></div></div></div><p>このセクションでは、インデントのカウントと挿入に使用されるプリミティブ関数について説明します。以降のセクションの関数は、これらのプリミティブを使用します。関連する関数については、<a class="link" href="ch38s10.html" title="Size of Displayed Text">Size
of Displayed Text</a>を参照してください。
</p><pre class="synopsis"><a id="idm71698128" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">current-indentation</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、カレント行のインデント、すなわち最初の非ブランク文字の水平位置をリターンする。行のコンテンツ全体がブランクなら、それは行終端の水平位置である。
</p></blockquote></div><pre class="synopsis"><a id="idm71694800" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-to</code> <em class="replaceable"><code>column</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>minimum</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、ポイントから<em class="replaceable"><code>column</code></em>に達するまで、タブとスペースでインデントを行う。<em class="replaceable"><code>minimum</code></em>が指定され、かつそれが非<code class="literal">nil</code>なら、たとえ<em class="replaceable"><code>column</code></em>を超えることが要求される場合であっても、少なくともその個数のスペースが挿入される。それ以外では、ポイントがすでに<em class="replaceable"><code>column</code></em>を超える場合、この関数は何も行わない。値は、挿入されたインデントの終端列である。
</p><p>挿入される空白文字は、周囲のテキスト(通常は先行するテキストのみ)のテキストプロパティを継承する。<a class="link" href="ch32s19.html#Sticky-Properties" title="Stickiness of Text Properties">Sticky
Properties</a>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm71687248" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">indent-tabs-mode</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>なら、インデント関数はスペースと同様、タブを挿入でき、それ以外ではスペースだけを挿入できる。この変数をセットすることにより、自動的にカレントバッファー内でバッファーローカルになる。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Mode_002dSpecific-Indent"/>Indentation Controlled by Major Mode</h2></div></div></div><p>すべてのメジャーモードにとって重要な関数は、編集対象の言語にたいして正しくインデントを行うように、<span class="keycap"><strong>TAB</strong></span>キーをカスタマイズします。このセクションでは、<span class="keycap"><strong>TAB</strong></span>キーのメカニズムと、それを制御する方法について説明します。このセクションの関数は、予期せぬ値をリターンします。
</p><pre class="synopsis"><a id="idm71681360" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-for-tab-command</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>rigid</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>これはほとんどの編集用モードで、<span class="keycap"><strong>TAB</strong></span>にバインドされるコマンドである。これの通常の動作はカレント行のインデントだが、かわりにタブ文字の挿入や、リージョンのインデントを行うこともできる。
</p><p>これは以下のことを行う:
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>まずTransient
Markモードが有効か、そしてリージョンがアクティブかどうかをチェックする。もしそうなら、リージョン内のテキストすべてをインデントするために<code class="literal">indent-region</code>を呼び出す(<a class="link" href="ch32s17.html#Region-Indent" title="Indenting an Entire Region">Region
Indent</a>を参照)。
</p></li><li class="listitem"><p>それ以外なら、<code class="literal">indent-line-function</code>内のインデント関数が<code class="literal">indent-to-left-margin</code>の場合、または変数<code class="literal">tab-always-indent</code>が挿入する文字としてタブ文字を指定する場合(以下参照)は、タブ文字を挿入する。
</p></li><li class="listitem"><p>それ以外なら、カレント行をインデントする。これは<code class="literal">indent-line-function</code>内の関数を呼び出すことにより行われる。その行がすでにインデント済みで、かつ<code class="literal">tab-always-indent</code>の値が<code class="literal">complete</code>(以下参照)なら、ポイント位置のテキストの補完を試みる。
</p></li></ul></div><p><em class="replaceable"><code>rigid</code></em>が非<code class="literal">nil</code>(インタラクティブな場合はプレフィクス引数)の場合、このコマンドが行をインデントした後、あるいはタブを挿入後、新たなインデントを反映するために、このコマンドはカレント行先頭にあるバランスされた式全体も厳正にインデントする。この引数は、コマンドがリージョンをインデントする場合は無視される。
</p></blockquote></div><pre class="synopsis"><a id="idm71653456" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">indent-line-function</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値はカレント行をインデントするために<code class="literal">indent-for-tab-command</code>、およびその他種々のインデントコマンドにより使用される関数である。これは通常メジャーモードにより割り当てられ、たとえばLispモードはこれを<code class="literal">lisp-indent-line</code>、Cモードは<code class="literal">c-indent-line</code>、のようにセットする。デフォルト値は<code class="literal">indent-relative</code>。<a class="link" href="ch23s07.html" title="Automatic Indentation of code">Auto-Indentation</a>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm71648208" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-according-to-mode</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、カレントのメジャーモードに適した方法でカレント行をインデントするために、<code class="literal">indent-line-function</code>内の関数を呼び出す。
</p></blockquote></div><pre class="synopsis"><a id="idm71644880" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">newline-and-indent</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は改行を挿入後、メジャーモードに応じて新たな行(挿入した改行の次の行)をインデントする。これは<code class="literal">indent-according-to-mode</code>を呼び出すことによりインデントを行う。
</p></blockquote></div><pre class="synopsis"><a id="idm71641552" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">reindent-then-newline-and-indent</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、カレント行の再インデント、ポイント位置への改行の挿入、その後新たな行(挿入した改行の次の行)のインデントを行う。これは<code class="literal">indent-according-to-mode</code>を呼び出すことにより、両方の行をインデントする。
</p></blockquote></div><pre class="synopsis"><a id="idm71638224" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">tab-always-indent</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、<span class="keycap"><strong>TAB</strong></span>(<code class="literal">indent-for-tab-command</code>)コマンドの挙動のカスタマイズに使用できる。値が<code class="literal">t</code>(デフォルト)なら、コマンドは通常カレント行だけをインデントする。値が<code class="literal">nil</code>なら、コマンドはポイントが左マージン、またはその行のインデント内ににあるときのみ、カレント行をインデントし、それ以外はタブ文字を挿入する。値が<code class="literal">complete</code>なら、コマンドはまずカレント行のインデントを試み、その行がすでにインデント済みならポイント位置のテキストを補完するために<code class="literal">completion-at-point</code>を呼び出す(<a class="link" href="ch20s06.html#Completion-in-Buffers" title="Completion in Ordinary Buffers">Completion
in Buffers</a>を参照)。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Region-Indent"/>Indenting an Entire Region</h2></div></div></div><p>このセクションでは、リージョン内すべての行をインデントするコマンドを説明します。これらは予期せぬ値をリターンします。
</p><pre class="synopsis"><a id="idm71630544" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-region</code> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>to-column</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、<em class="replaceable"><code>start</code></em>(含む)から<em class="replaceable"><code>end</code></em>(含まず)で始まる非ブランク行すべてをインデントする。<em class="replaceable"><code>to-column</code></em>が<code class="literal">nil</code>なら、<code class="literal">indent-region</code>はカレントモードのインデント関数、すなわち<code class="literal">indent-line-function</code>の値を呼び出すことにより、非ブランク行すべてをインデントする。
</p><p><em class="replaceable"><code>to-column</code></em>が非<code class="literal">nil</code>なら、それはインデントの列数を指定する整数であること。その場合、この関数は空白文字を追加もしくは削除することにより、正確にその量のインデントを各行に与える。
</p><p>フィルプレフィクスがある場合、<code class="literal">indent-region</code>はそのフィルプレフィクスで開始されるように、各行をインデントする。
</p></blockquote></div><pre class="synopsis"><a id="idm71621456" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">indent-region-function</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数の値は、ショートカットとして<code class="literal">indent-region</code>により使用されるかもしれない関数である。その関数はリージョンの開始と終了という、2つの引数をとること。その関数はリージョンの行を1行ずつインデントするときと同じような結果を生成するようにデザインするべきだが、おそらくより高速になるであろう。
</p><p>値が<code class="literal">nil</code>ならショートカットは存在せず、<code class="literal">indent-region</code>は実際に1行ずつ機能する。
</p><p>ショートカット関数は、<code class="literal">indent-line-function</code>が関数定義先頭をスキャンしなければならない、CモードやLispモードのようなモードに有用で、それを各行に適用するためには行数の2乗に比例する時間を要するだろう。ショートカットは各行のインデントとともに移動してスキャン情報を更新でき、それは線形時間である。行を個別にインデントするのが高速なモードでは、ショートカットの必要性はない。
</p><p>引数<em class="replaceable"><code>to-column</code></em>が非<code class="literal">nil</code>の<code class="literal">indent-region</code>では意味は異なり、この変数は使用しない。
</p></blockquote></div><pre class="synopsis"><a id="idm71614160" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-rigidly</code> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em> <em class="replaceable"><code>count</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>start</code></em>(含む)から<em class="replaceable"><code>end</code></em>(含まず)までのすべての行を、横に<em class="replaceable"><code>count</code></em>列インデントする。これは影響を受けるリージョンの“外観を保ち”、それを厳密な単位として移動する。
</p><p>これはインデントされていないテキストリージョンのインデントだけでなく、フォーマット済みコードのリージョンにたいするインデントにも有用である。たとえば<em class="replaceable"><code>count</code></em>が3なら、このコマンドは指定されたリージョン内で始まるすべての行のインデントに3を追加する。
</p><p>プレフィクス引数なしでインタラクティブに呼び出された場合、このコマンドはインデントを厳密に調整するために、Transient
Markモードを呼び出す。section “Indentation Commands” in <em class="citetitle">The GNU Emacs
Manual</em>を参照のこと。
</p></blockquote></div><pre class="synopsis"><a id="idm71607504" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-code-rigidly</code> <em class="replaceable"><code>start</code></em> <em class="replaceable"><code>end</code></em> <em class="replaceable"><code>columns</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>nochange-regexp</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>これは<code class="literal">indent-rigidly</code>と似ているが、文字列やコメントで始まる行を変更しない点が異なる。
</p><p>加えて、(<em class="replaceable"><code>nochange-regexp</code></em>が非<code class="literal">nil</code>の場合)<em class="replaceable"><code>nochange-regexp</code></em>が行先頭にマッチすれば、その行を変更しない。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Relative-Indent"/>Indentation Relative to Previous Lines</h2></div></div></div><p>このセクションでは、前の行のコンテンツにもとづいてカレント行をインデントする、コマンドを2つ説明します。
</p><pre class="synopsis"><a id="idm71599184" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-relative</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>unindented-ok</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、前の非ブランク行の次の<em class="firstterm">インデントポイント(indent
point)</em>と同じ列に拡張されるように、ポイント位置に空白文字を挿入する。インデントポイントとは、後に空白文字をともなった非空白文字である。次のインデントポイントは、ポイントのカレント列より大きい、最初のインデントポイントになる。たとえばポイントがテキスト行の最初の非ブランク文字の下と左にある場合、空白文字を挿入してその列に移動する。
</p><p>前の非ブランク行に次のインデントポイントがない(列の位置が十分大きくない)場合は、(<em class="replaceable"><code>unindented-ok</code></em>が非<code class="literal">nil</code>なら)何もしないか、あるいは<code class="literal">tab-to-tab-stop</code>を呼び出す。したがって、ポイントが短いテキスト行の最後の列の下と右にある場合、このコマンドは通常は空白文字を挿入することにより、次のタブストップにポイントを移動する。
</p><p><code class="literal">indent-relative</code>のリターン値は予測できない。
</p><p>以下の例では、ポイントは2行目の先頭にある:
</p><pre class="screen">            This line is indented twelve spaces.
★The quick brown fox jumped.
</pre><p>式<code class="literal">(indent-relative nil)</code>の評価により、以下が生成される:
</p><pre class="screen">            This line is indented twelve spaces.
            ★The quick brown fox jumped.
</pre><p>次の例では、ポイントは‘<code class="literal">jumped</code>’の‘<code class="literal">m</code>’と‘<code class="literal">p</code>’の間にある:
</p><pre class="screen">            This line is indented twelve spaces.
The quick brown fox jum★ped.
</pre><p>式<code class="literal">(indent-relative nil)</code>の評価により、以下が生成される:
</p><pre class="screen">            This line is indented twelve spaces.
The quick brown fox jum  ★ped.
</pre></blockquote></div><pre class="synopsis"><a id="idm71586384" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">indent-relative-maybe</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、引数<em class="replaceable"><code>unindented-ok</code></em>に<code class="literal">t</code>を指定して<code class="literal">indent-relative</code>を呼び出すことにより、前の非ブランク行に倣ってカレント行をインデントする。リターン値は予測できない。
</p><p>カレント列より先のインデントポイントが前の非ブランク行に存在しなければ、このコマンドは何もしない。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Indent-Tabs"/>Adjustable “Tab Stops”</h2></div></div></div><a id="idm71580752" class="indexterm"/><p>このセクションでは、ユーザー指定の“タブストップ(tab
stops)”と、それらを使用、セットするメカニズムについて説明します。“タブストップ”という名前は、タイプライターのタブストップと機能が類似しているため使用されています。この機能は、次のタブストップ列に到達するために、適切な数のスペースとタブを挿入することにより機能します。これは、バッファー内のタブ文字の表示に影響を与えません(<a class="link" href="ch38s21.html#Usual-Display" title="Usual Display Conventions">Usual
Display</a>を参照)。Textモードのような少数のメジャーモードだけが、<span class="keycap"><strong>TAB</strong></span>文字を入力として、このタブストップ機能を使用することに注意してください。section “Tab
Stops” in <em class="citetitle">The GNU Emacs Manual</em>を参照してください。
</p><pre class="synopsis"><a id="idm71577936" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">tab-to-tab-stop</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、<code class="literal">tab-stop-list</code>により定義される次のタブストップ列まで、ポイント前にスペースまたはタブを挿入する。
</p></blockquote></div><pre class="synopsis"><a id="idm71562192" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">tab-stop-list</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、<code class="literal">tab-to-tab-stop</code>により使用されるタブストップ列を定義する。これは<code class="literal">nil</code>、もしくは増加(均等に増加する必要はない)していく整数のリストであること。このリストは暗黙に、最後の要素と最後から2番目の要素の間隔(またはリストの要素が2未満なら<code class="literal">tab-width</code>)を繰り返すことにより、無限に拡張される。値<code class="literal">nil</code>は、列<code class="literal">tab-width</code>ごとにタブストップすることを意味する。
</p><p>インタラクティブにタブストップの位置を編集するには、<strong class="userinput"><code>M-x edit-tab-stops</code></strong>を使用すればよい。
</p></blockquote></div></div><div class="sect2"><div class="titlepage"><div><div><h2 class="title"><a id="Motion-by-Indent"/>Indentation-Based Motion Commands</h2></div></div></div><p>以下のコマンドは主にインタラクティブに使用され、テキスト内のインデントにもとづいて動作します。
</p><pre class="synopsis"><a id="idm71554640" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">back-to-indentation</code></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、カレント行(ポイントのある行のこと)の最初の非空白文字にポイントを移動する。リターン値は<code class="literal">nil</code>。
</p></blockquote></div><pre class="synopsis"><a id="idm71551056" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">backward-to-indentation</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>arg</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、後方へ<em class="replaceable"><code>arg</code></em>行ポイントを移動した後に、その行の最初の非ブランク文字にポイントを移動する。リターン値は<code class="literal">nil</code>。<em class="replaceable"><code>arg</code></em>が省略または<code class="literal">nil</code>のときのデフォルトは1。
</p></blockquote></div><pre class="synopsis"><a id="idm71545424" class="indexterm"/><span class="category"><span class="bold"><strong>Command</strong></span>:</span> <code class="function">forward-to-indentation</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>arg</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このコマンドは、前方へ<em class="replaceable"><code>arg</code></em>行ポイントを移動した後に、その行の最初の非ブランク文字にポイントを移動する。リターン値は<code class="literal">nil</code>。<em class="replaceable"><code>arg</code></em>が省略または<code class="literal">nil</code>のときのデフォルトは1。
</p></blockquote></div></div></div></body></html>