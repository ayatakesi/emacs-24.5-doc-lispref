<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Change Hooks</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Change-Hooks"/>Change Hooks</h1></div></div></div><a id="idm74573136" class="indexterm"/><a id="idm74572368" class="indexterm"/><p>以下のフック変数により、すべてのバッファー(これらをバッファーローカルにした場合は特定のバッファー)でのすべての変更にたいして、通知を受け取るようにアレンジすることができます。テキストの特定部分にたいする変更の検出方法については、<a class="link" href="ch32s19.html#Special-Properties" title="Properties with Special Meanings">Special
Properties</a>も参照してください。
</p><p>これらのフック内で使用する関数は、もしそれらが正規表現を使用して何かを行う場合は、マッチしたデータの保存とリストアを行うべきです。さもないと、それらが呼び出す編集処理に、奇妙な方法で干渉するでしょう。
</p><pre class="synopsis"><a id="idm74570064" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">before-change-functions</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、何らかのバッファー変更を行う前に呼び出すための、関数のリストを保持する。各関数は変更されようとするリージョンの先頭と終端を整数で表す、2つの引数を受け取る。変更されようとするバッファーは、常にカレントバッファーである。
</p></blockquote></div><pre class="synopsis"><a id="idm74567376" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">after-change-functions</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、何らかのバッファー変更を行った後に呼び出すための、関数のリストを保持する。各関数は正に変更されたリージョンの先頭と終端、およびその変更前に存在したテキストの長さである。これら3つの変数は、すべて整数である。変更されたバッファーは、常にカレントバッファーである。
</p><p>古いテキストの長さは、変更される前のテキストでの、そのテキストの前後のバッファー位置の差である。変更されたテキストでは、その長さは単に最初の2つの引数の差である。
</p></blockquote></div><p><code class="filename">*Messages*</code>バッファーへのメッセージ出力は、これらの関数を呼び出しません。
</p><pre class="synopsis"><a id="idm74563536" class="indexterm"/><span class="category"><span class="bold"><strong>Macro</strong></span>:</span> <code class="function">combine-after-change-calls</code> <em class="replaceable"><code>body</code></em><em class="replaceable"><code>…</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>このマクロは普通に<em class="replaceable"><code>body</code></em>を実行するが、もしそれが安全なように見えるなら、一連の複数の変更にたいして正に一度、after-change関数を呼び出すようにアレンジする。
</p><p>そのバッファーの同じ領域内でプログラムが複数のテキスト変更を行う場合は、その部分のプログラムの周囲でマクロ<code class="literal">combine-after-change-calls</code>を使用することにより、after-changeフック使用中の実行がかなり高速になり得る。after-changeフックが最終的に呼び出される際、その引数は<code class="literal">combine-after-change-calls</code>のbody内で行われたすべての変更にたいして含むバッファーの範囲を指定する。
</p><p><span class="bold"><strong>警告:</strong></span>
フォーム<code class="literal">combine-after-change-calls</code>のbody内で、<code class="literal">after-change-functions</code>の値を変更してはならない。
</p><p><span class="bold"><strong>警告:</strong></span>
組み合わされた変更がバッファーの広い範囲にばらばらに発生する場合でも、これは依然として機能するものの、お勧めはできない。なぜならこれは、ある変更フック関数を、非効率的な挙動へと導くかもしれないからである。
</p></blockquote></div><pre class="synopsis"><a id="idm74555728" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">first-change-hook</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数は、以前は未変更の状態だったバッファーが変更された際は常に実行されるノーマルフックである。
</p></blockquote></div><pre class="synopsis"><a id="idm74553040" class="indexterm"/><span class="category"><span class="bold"><strong>Variable</strong></span>:</span> <code class="varname">inhibit-modification-hooks</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>なら、すべての変更フックは無効になる。それらは何も実行されない。これはこのセクションで説明したすべてのフック変数、同様に特定のスペシャルテキストプロパティ(<a class="link" href="ch32s19.html#Special-Properties" title="Properties with Special Meanings">Special
Properties</a>を参照)とオーバーレイプロパティ(<a class="link" href="ch38s09.html#Overlay-Properties" title="Overlay Properties">Overlay Properties</a>を参照)にアタッチされたフックに影響を与える。
</p><p>これらの同じフック変数実行の間、バッファー変更によるデフォルトの変更フックが他の変更フック実行中に実行されないように、この変数は非<code class="literal">nil</code>にバインドされるそれ自体が変更フックから実行される特定のコード断片内で変更フックを実行したければ、ローカルに<code class="literal">inhibit-modification-hooks</code>を<code class="literal">nil</code>に再バインドすること。
</p></blockquote></div></div></body></html>