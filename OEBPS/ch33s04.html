<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Selecting a Representation</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Selecting-a-Representation"/>Selecting a Representation</h1></div></div></div><p>既存のバッファーまたは文字列がユニバイトの際にそれらをマルチバイトとして調べたり、その逆を行うことが有用なときがあります。
</p><pre class="synopsis"><a id="idm74419792" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">set-buffer-multibyte</code> <em class="replaceable"><code>multibyte</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>カレントバッファーの表現タイプをセットする。<em class="replaceable"><code>multibyte</code></em>が非<code class="literal">nil</code>ならバッファーはマルチバイト、<code class="literal">nil</code>ならユニバイトになる。
</p><p>この関数は、バイトシーケンスとして認識時には、バッファーを未変更のままとする。結果として、文字として認識時にはコンテンツを変更できる。たとえば、マルチバイト表現では1文字として扱われる3バイトのシーケンスは、ユニバイト表現では3文字として数えられるだろう。例外はrawバイトを表す8ビット文字である。これらはユニバイトバッファーでは1バイトで表現されるが、バッファーをマルチバイトにセットした際は2バイトのシーケンスに変換され、その逆の変換も行われる。
</p><p>この関数は、どの表現が使用されているかを記録するために、<code class="literal">enable-multibyte-characters</code>をセットする。これは以前の同じテキストをカバーするよう、バッファー内のさまざまなデータ(オーバーレイ、テキストプロパティ、マーカーを含む)を調整する。
</p><p>ナローイングはマルチバイト文字シーケンス中間で発生するかもしれないので、この関数はバッファーがナローイングされている場合はエラーをシグナルする。
</p><p>そのバッファーがインダイレクトバッファー(indirect buffer:
間接バッファー)の場合も、エラーをシグナルする。インダイレクトバッファーは、常にベースバッファー(base buffer:
基底バッファー)の表現を継承する。
</p></blockquote></div><pre class="synopsis"><a id="idm74409040" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">string-as-unibyte</code> <em class="replaceable"><code>string</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p><em class="replaceable"><code>string</code></em>がすでにユニバイト文字列なら、この関数は<em class="replaceable"><code>string</code></em>自身をリターンする。それ以外は<em class="replaceable"><code>string</code></em>と同じバイトだが、それぞれの文字を個別の文字としてとして扱い、新たな文字列をリターンする(値は<em class="replaceable"><code>string</code></em>より多くの文字をもつかもしれない)。例外として、rawバイトを表す8ビット文字はそれぞれ、単一のバイトに変換される。新たに作成された文字列に、テキストプロパティは含まれない。
</p></blockquote></div><pre class="synopsis"><a id="idm74392144" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">string-as-multibyte</code> <em class="replaceable"><code>string</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p><em class="replaceable"><code>string</code></em>がすでにマルチバイト文字列なら、この関数は<em class="replaceable"><code>string</code></em>自身をリターンする。それ以外は<em class="replaceable"><code>string</code></em>と同じバイトだが、それぞれのマルチバイトシーケンスを1つの文字としてとして扱い、新たな文字列をリターンする。これは、値が<em class="replaceable"><code>string</code></em>より少ない文字をもつかもしれないことを意味する。<em class="replaceable"><code>string</code></em>内のバイトシーケンスが、単一文字のマルチバイト表現として無効なら、そのシーケンスないの各バイトは、8ビットrawバイトとして扱われる。新たに作成された文字列には、テキストプロパティは含まれない
</p></blockquote></div></div></body></html>