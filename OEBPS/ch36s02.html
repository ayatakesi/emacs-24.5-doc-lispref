<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Defining Abbrevs</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Defining-Abbrevs"/>Defining Abbrevs</h1></div></div></div><a id="idm79822416" class="indexterm"/><p><code class="literal">define-abbrev</code>は、abbrevテーブル内にabbrevを定義するための基本的な低レベル関数です。
</p><p>メジャーモードがシステムabbrevを定義する際は、<code class="literal">:system</code>プロパティに<code class="literal">t</code>を指定して<code class="literal">define-abbrev</code>を呼び出すべきです。すべての保存された非“システム”abbrevは起動時(何らかのメジャーモードがロードされる前)にリストアされることに注意してください。したがってメジャーモードは、最初にそのモードがロードされた際、それらのモードのabbrevテーブルが空であると仮定するべきではありません。
</p><pre class="synopsis"><a id="idm79818704" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">define-abbrev</code> <em class="replaceable"><code>abbrev-table</code></em> <em class="replaceable"><code>name</code></em> <em class="replaceable"><code>expansion</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>hook</code></em> <em class="replaceable"><code>&amp;rest</code></em> <em class="replaceable"><code>props</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>abbrev-table</code></em>内に<em class="replaceable"><code>name</code></em>という名前で、<em class="replaceable"><code>expansion</code></em>に展開され、<em class="replaceable"><code>hook</code></em>を呼び出すabbrevを、プロパティ<em class="replaceable"><code>props</code></em>(<a class="link" href="ch36s06.html" title="Abbrev Properties">Abbrev
Properties</a>を参照)とともに定義する。リターン値は<em class="replaceable"><code>name</code></em>。ここでは、<em class="replaceable"><code>props</code></em>内の<code class="literal">:system</code>プロパティは特別に扱われる。このプロパティが値<code class="literal">force</code>をもつなら、たとえ同じ名前の非“システム”abbrevでも、既存の定義を上書きするだろう。
</p><p><em class="replaceable"><code>name</code></em>は文字列であること。引数<em class="replaceable"><code>expansion</code></em>は通常は望む展開形(文字列)であり、<code class="literal">nil</code>ならそのabbrevを未定義とする。これが文字列または<code class="literal">nil</code>以外の何かなら、そのabbrevは<em class="replaceable"><code>hook</code></em>を実行することにより、単に“展開”される。
</p><p>引数<em class="replaceable"><code>hook</code></em>は、関数または<code class="literal">nil</code>であること。<em class="replaceable"><code>hook</code></em>が非<code class="literal">nil</code>なら、abbrevが<em class="replaceable"><code>expansion</code></em>に置換された後に、引数なしでそれが呼び出される。<em class="replaceable"><code>hook</code></em>呼び出し時、ポイントは<em class="replaceable"><code>expansion</code></em>の終端に置かれる。
</p><a id="idm79803472" class="indexterm"/><p><em class="replaceable"><code>hook</code></em>が、<code class="literal">no-self-insert</code>プロパティが非<code class="literal">nil</code>であるような、非<code class="literal">nil</code>のシンボルなら、<em class="replaceable"><code>hook</code></em>は展開をトリガーするような自己挿入入力文字を挿入できるかどうかを、明示的に制御できる。この場合、<em class="replaceable"><code>hook</code></em>が非<code class="literal">nil</code>をリターンしたら、その文字の挿入を抑止する。対照的に、<em class="replaceable"><code>hook</code></em>が<code class="literal">nil</code>をリターンした場合は、あたかも実際には展開が行われなかったかのように、<code class="literal">expand-abbrev</code>(または<code class="literal">abbrev-insert</code>)も<code class="literal">nil</code>をリターンする。
</p><p>通常<code class="literal">define-abbrev</code>は、実際にabbrevを変更した場合は、変数<code class="literal">abbrevs-changed</code>に<code class="literal">t</code>をセットする。これはいくつかのコマンドが、abbrevの保存を提案するためである。システムabbrevは、いずれにせよ保存されないので、システムabbrevにたいして、これは行われない。
</p></blockquote></div><pre class="synopsis"><a id="idm79794256" class="indexterm"/><span class="category"><span class="bold"><strong>User Option</strong></span>:</span> <code class="varname">only-global-abbrevs</code></pre><div class="blockquote"><blockquote class="blockquote"><p>この変数が非<code class="literal">nil</code>なら、それはユーザーがグローバルabbrevのみの使用を計画していることを意味する。これはモード固有のabbrevを定義するコマンドにたいして、かわりにグローバルabbrevを定義するよう指示する。この変数は、このセクション内の関数の振る舞いを変更しない。それは呼び出し側により検証される。
</p></blockquote></div></div></body></html>