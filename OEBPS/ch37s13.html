<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Transaction Queues</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Transaction-Queues"/>Transaction Queues</h1></div></div></div><a id="idm78693456" class="indexterm"/><p>トランザクションを用いてサブプロセスと対話するために、<em class="firstterm">トランザクションキュー(transaction
queue)</em>を使用できます。まず<code class="literal">tq-create</code>を使用して、指定したプロセスと対話するためのトランザクションキューを作成します。それからトランザクションを送信するために、<code class="literal">tq-enqueue</code>を呼び出すことができます。
</p><pre class="synopsis"><a id="idm78690128" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">tq-create</code> <em class="replaceable"><code>process</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、<em class="replaceable"><code>process</code></em>と対話するトランザクションキューを作成してリターンする。引数<em class="replaceable"><code>process</code></em>は、バイトストリームを送受信する能力をもつサブプロセスであること。これは子プロセス、または(おそらく別のマシン上の)サーバーへのTCP接続かもしれない。
</p></blockquote></div><pre class="synopsis"><a id="idm78686160" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">tq-enqueue</code> <em class="replaceable"><code>queue</code></em> <em class="replaceable"><code>question</code></em> <em class="replaceable"><code>regexp</code></em> <em class="replaceable"><code>closure</code></em> <em class="replaceable"><code>fn</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>delay-question</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、キュー<em class="replaceable"><code>queue</code></em>にトランザクションを送信する。キューの指定は、対話するサブプロセスを指定する効果をもつ。
</p><p>引数<em class="replaceable"><code>question</code></em>は、トランザクションを開始するために発信するメッセージである。引数<em class="replaceable"><code>fn</code></em>は、それにたいする応答が返信された際に呼び出す関数である。これは<em class="replaceable"><code>closure</code></em>と受信した応答という、2つの引数で呼び出される。
</p><p>引数<em class="replaceable"><code>regexp</code></em>は応答全体の終端にマッチし、それより前にはマッチしない正規表現であること。これが応答の終わりを<code class="literal">tq-enqueue</code>が決定する方法である。
</p><p>引数<em class="replaceable"><code>delay-question</code></em>が非<code class="literal">nil</code>なら、そのプロセスが以前に発信したすべてのメッセージへの返信が完了するまで、このメッセージの送信を遅延する。これは、いくつかのプロセスにたいしてより信頼性のある結果が生成される。
</p></blockquote></div><pre class="synopsis"><a id="idm78676176" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">tq-close</code> <em class="replaceable"><code>queue</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>保留中のすべてのトランザクションの完了を待機して、トランザクションキュー<em class="replaceable"><code>queue</code></em>をシャットダウンし、それから接続または子プロセスを終了する。
</p></blockquote></div><p>トランザクションキューは、フィルター関数により実装されています。<a class="link" href="ch37s09.html#Filter-Functions" title="Process Filter Functions">Filter Functions</a>を参照してください。
</p></div></body></html>