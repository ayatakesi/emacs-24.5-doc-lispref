<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Desktop Notifications</title><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="Desktop-Notifications"/>Desktop Notifications</h1></div></div></div><a id="idm85320656" class="indexterm"/><a id="idm85319888" class="indexterm"/><p>Emacsはfreedesktop.orgのDesktop Notifications
Specificationをサポートするシステムでは、<em class="firstterm">通知(notifications)</em>を送ることができます。この機能を使用するには、EmacsがD-Busサポート付きでコンパイルされていて、<code class="literal">notifications</code>ライブラリーがロードされていなければなりません。section “D-Bus” in <em class="citetitle">D-Bus integration in Emacs</em>を参照してください。
</p><pre class="synopsis"><a id="idm85317200" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">notifications-notify</code> <em class="replaceable"><code>&amp;rest</code></em> <em class="replaceable"><code>params</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、引数<em class="replaceable"><code>params</code></em>で指定された構成したパラメーターにより、D-Busを通じてデスクトップに通知を送信する。これらの引数は、交互になったキーワードと値のペアーで構成されていること。以下はサポートされているキーワードと値である:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">:bus <em class="replaceable"><code>bus</code></em></code>
</span></dt><dd><p>D-Busのバス。この引数は、<code class="literal">:session</code>以外のバスを使用する場合のみ必要となる。
</p></dd><dt><span class="term"><code class="literal">:title <em class="replaceable"><code>title</code></em></code>
</span></dt><dd><p>通知のタイトル。
</p></dd><dt><span class="term"><code class="literal">:body <em class="replaceable"><code>text</code></em></code>
</span></dt><dd><p>通知ボディのテキスト。通知サーバーの実装に依存して‘<code class="literal">"&lt;b&gt;bold
text&lt;/b&gt;"</code>’のようなHTMLマークアップ、ハイパーリンク、イメージをテキストに含むことができる。HTML特殊文字は‘<code class="literal">"Contact
&amp;lt;postmaster@localhost&amp;gt;!"</code>’のように、エンコードしなければならない。
</p></dd><dt><span class="term"><code class="literal">:app-name <em class="replaceable"><code>name</code></em></code>
</span></dt><dd><p>その通知を送信するアプリケーション名。デフォルトは<code class="literal">notifications-application-name</code>。
</p></dd><dt><span class="term"><code class="literal">:replaces-id <em class="replaceable"><code>id</code></em></code>
</span></dt><dd><p>この通知が置換する通知の<em class="replaceable"><code>id</code></em>。<em class="replaceable"><code>id</code></em>は、<code class="literal">notifications-notify</code>の以前の呼び出し結果でなければならない。
</p></dd><dt><span class="term"><code class="literal">:app-icon <em class="replaceable"><code>icon-file</code></em></code>
</span></dt><dd><p>通知アイコンのファイル名。<code class="literal">nil</code>ならアイコンは表示されない。デフォルトは<code class="literal">notifications-application-icon</code>。
</p></dd><dt><span class="term"><code class="literal">:actions (<em class="replaceable"><code>key</code></em> <em class="replaceable"><code>title</code></em> <em class="replaceable"><code>key</code></em> <em class="replaceable"><code>title</code></em> ...)</code>
</span></dt><dd><p>適用されるアクションのリスト。<em class="replaceable"><code>key</code></em>と<em class="replaceable"><code>title</code></em>はどちらも文字列。(通常は通知クリックで呼び出される)デフォルトのアクションは、‘<code class="literal">"default"</code>’という名前であること。実装がそれを表示しないようにするには自由だが、titleは何でもよい。
</p></dd><dt><span class="term"><code class="literal">:timeout <em class="replaceable"><code>timeout</code></em></code>
</span></dt><dd><p>timeoutは、通知が表示されてからその通知が自動的にクローズされるまでの、ミリ秒での時間。−1なら、その通知の有効期限は通知サーバーのセッティングに依存し、通知のタイプにより異なるかもしれない。0なら、その通知は失効しない。デフォルト値は−1。
</p></dd><dt><span class="term"><code class="literal">:urgency <em class="replaceable"><code>urgency</code></em></code>
</span></dt><dd><p>緊急レベル。<code class="literal">low</code>、<code class="literal">normal</code>、<code class="literal">critical</code>のいずれか。
</p></dd><dt><span class="term"><code class="literal">:action-items</code>
</span></dt><dd><p>このキーワードが与えられると、そのアクションの<em class="replaceable"><code>title</code></em>文字列はアイコン名として解釈される。
</p></dd><dt><span class="term"><code class="literal">:category <em class="replaceable"><code>category</code></em></code>
</span></dt><dd><p>通知の種類で、文字列。標準のカテゴリーのリストは、<a class="ulink" href="http://developer.gnome.org/notification-spec/#categories">Desktop Notifications Specification</a>を参照されたい。
</p></dd><dt><span class="term"><code class="literal">:desktop-entry <em class="replaceable"><code>filename</code></em></code>
</span></dt><dd><p>これは‘<code class="literal">"emacs"</code>’のように、そのプログラムを呼び出すデスクトップファイル名の名前を指定する。
</p></dd><dt><span class="term"><code class="literal">:image-data (<em class="replaceable"><code>width</code></em> <em class="replaceable"><code>height</code></em> <em class="replaceable"><code>rowstride</code></em> <em class="replaceable"><code>has-alpha</code></em> <em class="replaceable"><code>bits</code></em> <em class="replaceable"><code>channels</code></em> <em class="replaceable"><code>data</code></em>)</code>
</span></dt><dd><p>これはそれぞれwidth、height、rowstride、およびalpha channel、bits per
sample、channels、image dataの有無を記述するrawデータのイメージフォーマット。
</p></dd><dt><span class="term"><code class="literal">:image-path <em class="replaceable"><code>path</code></em></code>
</span></dt><dd><p>これはURI(現在サポートされているのはURIスキーマは‘<code class="literal">file://</code>’のみ)、または‘<code class="literal">$XDG_DATA_DIRS/icons</code>’にあるfreedesktop.org準拠のアイコンテーマ名のいずれかを表される。
</p></dd><dt><span class="term"><code class="literal">:sound-file <em class="replaceable"><code>filename</code></em></code>
</span></dt><dd><p>通知ポップアップ時に再生するサウンドファイルのパス。
</p></dd><dt><span class="term"><code class="literal">:sound-name <em class="replaceable"><code>name</code></em></code>
</span></dt><dd><p>通知ポップアップ時に再生する、‘<code class="literal">$XDG_DATA_DIRS/sounds</code>’にあるfreedesktop.orgサウンド命名仕様準拠の、テーマに対応した名前付きサウンド。アイコン名と同様、サウンドにたいしてのみ。例としては‘<code class="literal">"message-new-instant"</code>’。
</p></dd><dt><span class="term"><code class="literal">:suppress-sound</code>
</span></dt><dd><p>それが可能なら、サーバーにすべてのサウンドの再生を抑制させる。
</p></dd><dt><span class="term"><code class="literal">:resident</code>
</span></dt><dd><p>セットした場合、アクション呼び出し時にサーバーはその通知を自動的に削除しない。ユーザーか送信者により明示的に削除されるまで、その通知はサーバー内に常駐し続ける。恐らくこのヒントは、そのサーバーが<code class="literal">:persistence</code>能力をもつときのみ有用。
</p></dd><dt><span class="term"><code class="literal">:transient</code>
</span></dt><dd><p>セットした場合、サーバーはその通知を過渡的なものとして扱い、もしそれが永続的であるべきなら、そのサーバーのpersistence能力をバイパスする。
</p></dd><dt><span class="term"><code class="literal">:x <em class="replaceable"><code>position</code></em></code>
, </span><span class="term"><code class="literal">:y <em class="replaceable"><code>position</code></em></code>
</span></dt><dd><p>その通知がポイントすべき、スクリーン上のXとYの座標を指定する。これらの引数は併せて使用しなければならない。
</p></dd><dt><span class="term"><code class="literal">:on-action <em class="replaceable"><code>function</code></em></code>
</span></dt><dd><p>アクション呼び出し時に呼び出す関数。通知<em class="replaceable"><code>id</code></em>とアクションの<em class="replaceable"><code>key</code></em>は、引数としてその関数に渡される。
</p></dd><dt><span class="term"><code class="literal">:on-close <em class="replaceable"><code>function</code></em></code>
</span></dt><dd><p>タイムアウトかユーザーにより通知がクローズされたときに呼び出す関数。通知<em class="replaceable"><code>id</code></em>とクローズ理由<em class="replaceable"><code>reason</code></em>は、引数としてその関数に渡される。:
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>通知が失効した場合は<code class="literal">expired</code>。
</p></li><li class="listitem"><p>ユーザーが通知を却下したら<code class="literal">dismissed</code>。
</p></li><li class="listitem"><p>notifications-close-notification呼び出しにより、
<code class="literal">通知がクローズされたら<code class="literal">close-notification</code>。</code>
</p></li><li class="listitem"><p>通知サーバーが理由を提供しなかったら<code class="literal">undefined</code>。
</p></li></ul></div></dd></dl></div><p>通知サーバーがどのパラメーターを受け入れるかのチェックは、<code class="literal">notifications-get-capabilities</code>を通じて行うことができる。
</p><p>この関数は、整数の通知idをリターンする。このidは<code class="literal">notifications-close-notification</code>や、別の<code class="literal">notifications-notify</code>呼び出しの<code class="literal">:replaces-id</code>引数で、通知アイテムの操作に使用できる。たとえば:
</p><pre class="screen">(defun my-on-action-function (id key)
  (message "Message %d, key \"%s\" pressed" id key))
     ⇒ my-on-action-function
</pre><pre class="screen">
</pre><pre class="screen">(defun my-on-close-function (id reason)
  (message "Message %d, closed due to \"%s\"" id reason))
     ⇒ my-on-close-function
</pre><pre class="screen">
</pre><pre class="screen">(notifications-notify
 :title "Title"
 :body "This is &lt;b&gt;important&lt;/b&gt;."
 :actions '("Confirm" "I agree" "Refuse" "I disagree")
 :on-action 'my-on-action-function
 :on-close 'my-on-close-function)
     ⇒ 22
</pre><pre class="screen">
</pre><pre class="screen">A message window opens on the desktop.  Press "I agree"
     ⇒ Message 22, key "Confirm" pressed
        Message 22, closed due to "dismissed"
</pre></blockquote></div><pre class="synopsis"><a id="idm85252944" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">notifications-close-notification</code> <em class="replaceable"><code>id</code></em> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>bus</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>この関数は、識別子<em class="replaceable"><code>id</code></em>の通知をクローズする。<em class="replaceable"><code>bus</code></em>はD-Bus接続を表す文字列で、デフォルトは<code class="literal">:session</code>。
</p></blockquote></div><pre class="synopsis"><a id="idm85247696" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">notifications-get-capabilities</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>bus</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>通知サーバーの能力を、シンボルのリストでリターンする。<em class="replaceable"><code>bus</code></em>はD-Bus接続を表す文字列で、デフォルトは<code class="literal">:session</code>。期待され得る能力は以下のとおり:
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">:actions</code>
</span></dt><dd><p>そのサーバーはユーザーにたいする指定されたアクションを提供する。
</p></dd><dt><span class="term"><code class="literal">:body</code>
</span></dt><dd><p>bodyのテキストをサポートする。
</p></dd><dt><span class="term"><code class="literal">:body-hyperlinks</code>
</span></dt><dd><p>サーバーは通知内のハイパーリンクをサポートする。
</p></dd><dt><span class="term"><code class="literal">:body-images</code>
</span></dt><dd><p>サーバーは通知内のイメージをサポートする。
</p></dd><dt><span class="term"><code class="literal">:body-markup</code>
</span></dt><dd><p>サーバーは通知内のマークアップをサポートする。
</p></dd><dt><span class="term"><code class="literal">:icon-multi</code>
</span></dt><dd><p>サーバーは与えられたイメージ配列内のすべてのフレームのアニメーションを描画できる。
</p></dd><dt><span class="term"><code class="literal">:icon-static</code>
</span></dt><dd><p>与えられたイメージ配列内の、正確に1フレームの表示をサポートする。この値は、<code class="literal">:icon-multi</code>と相互に排他である。
</p></dd><dt><span class="term"><code class="literal">:persistence</code>
</span></dt><dd><p>サーバーは通知の永続性をサポートする。
</p></dd><dt><span class="term"><code class="literal">:sound</code>
</span></dt><dd><p>サーバーは通知のサウンドをサポートする。
</p></dd></dl></div><p>これらに加えて、ベンダー固有の能力は<code class="literal">:x-gnome-foo-cap</code>のように、<code class="literal">:x-vendor</code>で始まる。
</p></blockquote></div><pre class="synopsis"><a id="idm85225296" class="indexterm"/><span class="category"><span class="bold"><strong>Function</strong></span>:</span> <code class="function">notifications-get-server-information</code> <em class="replaceable"><code>&amp;optional</code></em> <em class="replaceable"><code>bus</code></em></pre><div class="blockquote"><blockquote class="blockquote"><p>通知サーバーの情報を、文字列のリストでリターンする。<em class="replaceable"><code>bus</code></em>はD-Bus接続を表す文字列で、デフォルトは<code class="literal">:session</code>。リターンされるリストは<code class="literal">(<em class="replaceable"><code>name</code></em>
<em class="replaceable"><code>vendor</code></em> <em class="replaceable"><code>version</code></em> <em class="replaceable"><code>spec-version</code></em>)</code>。
</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><em class="replaceable"><code>name</code></em>
</span></dt><dd><p>そのサーバーのプロダクト名。
</p></dd><dt><span class="term"><em class="replaceable"><code>vendor</code></em>
</span></dt><dd><p>ベンダー名。たとえば‘<code class="literal">"KDE"</code>’や‘<code class="literal">"GNOME"</code>’。
</p></dd><dt><span class="term"><em class="replaceable"><code>version</code></em>
</span></dt><dd><p>サーバーのバージョン番号。
</p></dd><dt><span class="term"><em class="replaceable"><code>spec-version</code></em>
</span></dt><dd><p>サーバーが準拠する仕様のバージョン。
</p></dd></dl></div><p><em class="replaceable"><code>spec_version</code></em>が<code class="literal">nil</code>なら、サーバーは‘<code class="literal">"1.0"</code>’以前の仕様をサポートする。
</p></blockquote></div></div></body></html>